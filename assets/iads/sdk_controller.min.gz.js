!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Analytics=e()}}((function(){return function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var d="function"==typeof require&&require;if(!s&&d)return d(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return r(t[o][1][e]||e)}),c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){t.exports=function(e){var t,n=["ironBeastAnalyticsProvider"],r=[],a=["noFill","clusterSelected","initAd"],o={},s={},d=this,l=[];function c(t){return n=t.eventName,0===Object.keys(e).length&&a.indexOf(n)>-1||function(e,t){if(!e||!t)return!1;for(var n in e)if(e.hasOwnProperty(n)&&(!(n in t)||t[n]!==e[n]))return!1;return!0}(e[t.eventName],t);var n}function u(e){d.extend(s||{},e)}return d.extend=function(){for(var e,t,n=arguments.length,i=1,r=arguments[0]||{};i<n;i++)if(null!=(e=arguments[i]))for(t in e)void 0!==e[t]&&(r[t]=e[t]);return r},d.report=function(e,n){e&&(n.eventName=e,c(n=extend(n||{},s))||(t?(function(e,t){window.isWebWrapper&&window.SSA_CORE.SDKController.log("WebWrapper | Event fired with data | "+JSON.stringify({name:e,params:t}))}(e,n),function(e){for(var t=r.length,n=0;n<t;n++)e(r[n])}((function(e){e.fireDataEvent(n)}))):l.push({eName:e,data:n,eType:"event"})))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),n=[];for(var t=e.length,i=0;i<t;i++)n.push(e[i])}},setProvidersConfig:function(e){o=e},init:function(e){t||(e&&u(e),function(){r=[];for(var e=n.length,t=0;t<e;t++){var i=n[t];if("function"==typeof window[i]){var a=new window[i];a.init(o),r.push(a)}}}(),t=!0,function(){for(var e in l){var t=l[e]||{};d.report(t.eName,t.data)}l=[]}())},updateBaseData:u,createAnalytic:function(e){return new i(d,e||{})}}};var i=e("./analyticsHelper.js");window.ironBeastAnalyticsProvider=e("./providers/ironBeastAnalyticsProvider.js"),window.QAAnalyticsProvider=e("./providers/QAAnalyticsProvider.js"),window.KuduAnalyticsProvider=e("./providers/KuduAnalyticsProvider.js")},{"./analyticsHelper.js":2,"./providers/KuduAnalyticsProvider.js":3,"./providers/QAAnalyticsProvider.js":4,"./providers/ironBeastAnalyticsProvider.js":5}],2:[function(e,t,n){t.exports=function(e,t){var n=e||{},i=(t=t||{}).baseData||{},r={},a=n.extend,o={};function s(e){return e&&e.name&&e.id}return o.report=function(e,t){if(!s(e))return!1;(t=t||{}).eventId=e.id,t=a({},i,t),n.report(e.name,t)},o.report=function(e,t){if(!s(e))return!1;(t=t||{}).eventId=e.id,t=a({},i,t),n.report(e.name,t)},o.trackTimingStart=function(e,t){if(!s(e))return!1;var n=e.name;return t=t||Date.now(),r[n]=t,!0},o.trackTimingStop=function(e,t){if(!s(e))return!1;var o,d,l=e.name;if(t||(t={}),t.eventId=e.id,t&&t.timeStamp?(d=t.timeStamp,delete t.timeStamp):d=Date.now(),t&&t.eNameStart&&t.eNameStart.name?(o=r[t.eNameStart.name],delete t.eNameStart):r[l]&&(o=r[l],r[l]=null),o){var c=d-o;if(c<0)return!1;var u=a({},i);return(t=a(u,t||{})).timingValue=c,n.report(l,t),!0}},o.updateBaseData=function(e){for(var t in e)i[t]=e[t];return!0},o.resetBaseData=function(e){if(e=e.map((e=>e.toLowerCase())),Array.isArray(e)&&e)for(var t in i)-1===e.indexOf(t.toLowerCase())&&delete i[t]},o.unsetParamFromBaseData=function(e){i.hasOwnProperty(e)&&delete i[e]},o.incrementSessionNumber=function(){return i.sessionDepth?i.sessionDepth++:i.sessionDepth=1,!0},o}},{}],3:[function(e,t,n){t.exports=function(){var e,t,n="POST",i="https://ae.iads.unity3d.com/logs",r="supersonic.adunitanalytics.ad_unit_events",a=["generalmessage","emptyowreason","landingid","callfailreason","rvnomoreoffersreason"];function o(e,t){switch(e){case"landingid":t=parseInt(t);break;case"generalmessage":case"emptyowreason":t=function(e){return void 0===e?"undefined":null===e?"null":e.toString()}(t)}return t}function s(n){var i=new XMLHttpRequest;i.open("POST",e,!0),i.onerror=function(){n&&n.retry>=0&&n.retry<2&&(n.retry++,t(n))},i.send(JSON.stringify(n))}function d(e){var t;try{t=btoa(JSON.stringify(e))}catch(n){e.data.applicationUserId="badName",e.data.userId="badName",e.data.eventName="errorEvent",t=btoa(JSON.stringify(e))}var n=i+"?data="+t,r=new XMLHttpRequest;r.open("GET",n,!0),r.send()}return{init:function(r){r&&r.method===n?(n,e="https://postlog.supersonic.com/logs",t=s):("GET",e=i,t=d),r&&r.endpoint&&""!==r.endpoint&&(i=r.endpoint)},fireDataEvent:function(e){e&&(e=function(e){if(!e)return e;for(var t=Object.keys(e),n=t.length;n--;){var i=t[n],r=i.toLowerCase(),s=e[i];-1!==a.indexOf(r)&&(s=o(r,s)),e[r]=s,i!==r&&delete e[i]}return e}(e),t({table:r,data:e}))}}}},{}],4:[function(e,t,n){t.exports=function(){var e,t={};function n(e,t){var i=[];for(var r in e)if(e.hasOwnProperty(r)){var a=t?t+"["+r+"]":r,o=e[r];i.push("object"==typeof o?n(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}return{init:function(){e="http://qa.analytics.qa"},fireDataEvent:function(i){if(i){t.data=i;var r=n(t);delete t.data,function(e){if(!e)return;(new Image).src=e}(e+"?"+r)}}}}},{}],5:[function(e,t,n){t.exports=function(){var e,t={table:"supersonic.adunitanalytics.ad_unit_events"};return{init:function(t){e=t.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},fireDataEvent:function(n){if(n){var i;t.data=n;try{i=btoa(JSON.stringify(t))}catch(e){t.data.applicationUserId="badName",t.data.userId="badName",t.data.eventName="errorEvent",i=btoa(JSON.stringify(t))}delete t.data,function(e){if(!e)return;(new Image).src=e}(e+"?data="+i)}}}}},{}]},{},[1])(1)})),function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var d="function"==typeof require&&require;if(!s&&d)return d(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return r(t[o][1][e]||e)}),c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=i(e("./BaseAnalytic")),a=i(e("./transmitters/QaReportTransmitter")),o=i(e("./transmitters/KuduReportTransmitter")),s=i(e("./transmitters/WebAutTransmitter"));n.default=class{createBaseAnalytics(e){this.validateOptions(e);const t=this.buildTransmitters(e.transmitters);return new r.default({transmitters:t,disabledEvents:e.disabledEvents})}validateOptions(e){if(!e||!e.transmitters||0===Object.keys(e.transmitters).length)throw new Error("Invalid config")}buildTransmitters(e){if(!e)return[];const t=[],{qa:n,kudu:i}=e;return n&&t.push(new a.default),i&&t.push(new o.default({endpoint:i.endpoint})),e.webAut&&t.push(new s.default(e.webAut.logFn)),t}}},{"./BaseAnalytic":2,"./transmitters/KuduReportTransmitter":5,"./transmitters/QaReportTransmitter":6,"./transmitters/WebAutTransmitter":7}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_DISABLED_EVENTS=void 0;const i=e("./ExtendedAnalytic");n.default=class{constructor(e){this.baseData={},this.engine=new r(e)}createAnalytic(e){return new i.ExtendedAnalytic(this.report.bind(this),e)}updateBaseData(e){this.baseData=Object.assign(Object.assign({},this.baseData),e)}start(){this.engine.start(this.baseData)}report(e){this.engine.report(e,this.baseData)}};class r{constructor(e){var t;this.started=!1,this.pendingReports=[],this.transmitters=e.transmitters,this.disableEvents=null!==(t=e.disabledEvents)&&void 0!==t?t:n.DEFAULT_DISABLED_EVENTS}start(e){if(!this.started){this.started=!0;for(const t of this.pendingReports)this.report(t,e);this.pendingReports=[]}}report(e,t){if(!this.started)return void this.pendingReports.push(e);const n=Object.assign(Object.assign({},t),e);if(!this.shouldIgnoreReport(n))for(const e of this.transmitters)e.transmit(n)}shouldIgnoreReport(e){const t=this.disableEvents[e.eventName];if(!t)return!1;for(const[n,i]of Object.entries(t))if(e[n]!==i)return!1;return!0}}n.DEFAULT_DISABLED_EVENTS={noFill:{},clusterSelected:{},initAd:{}}},{"./ExtendedAnalytic":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAnalytic=void 0;n.ExtendedAnalytic=class{constructor(e,t){this.reportFn=e,this.timeTrackingMap=new Map,this.baseData=t.baseData}report(e,t){this.isInvalidEvent(e)||this.reportFn(Object.assign(Object.assign(Object.assign({},this.baseData),t),{eventId:e.id,eventName:e.name}))}isInvalidEvent(e){return!e||!e.name||isNaN(e.id)}updateBaseData(e){this.baseData=Object.assign(Object.assign({},this.baseData),e)}resetBaseData(e){const t=new Set(e.map((e=>e.toLowerCase())));for(const e of Object.keys(this.baseData))t.has(e.toLowerCase())||delete this.baseData[e]}trackTimingStart(e){this.timeTrackingMap.set(e.name,Date.now())}trackTimingStop(e,t){var n,i;const r=this.timeTrackingMap.get(null!==(i=null===(n=t.eNameStart)||void 0===n?void 0:n.name)&&void 0!==i?i:e.name);if(t.eNameStart||this.timeTrackingMap.delete(e.name),delete t.eNameStart,void 0===r)return;const a=Date.now()-r;this.report(e,Object.assign(Object.assign({},t),{timingValue:a}))}unsetParamFromBaseData(){}incrementSessionNumber(){}}},{}],4:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.analyticFactory=void 0;const r=i(e("./AnalyticFactory"));n.analyticFactory=new r.default},{"./AnalyticFactory":1}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.KUDU_TABLE_NAME=n.KUDU_BASE_URL=void 0,n.KUDU_BASE_URL="https://ae.iads.unity3d.com/logs",n.KUDU_TABLE_NAME="supersonic.adunitanalytics.ad_unit_events";const i=new Set(["generalmessage","emptyowreason","landingid"]);n.default=class{constructor(e){var t;this.endpoint=null!==(t=e.endpoint)&&void 0!==t?t:n.KUDU_BASE_URL}transmit(e){const t=this.format(e),i=`${this.endpoint}?data=${btoa(JSON.stringify({table:n.KUDU_TABLE_NAME,data:t}))}`;fetch(i,{mode:"no-cors"})}format(e){const t={};for(const[n,i]of Object.entries(e))t[n.toLowerCase()]=this.getValue(n.toLowerCase(),i);return t}getValue(e,t){return i.has(e)?"landingid"===e?parseInt(t):void 0===t?"undefined":null===t?"null":t.toString():t}}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=class{transmit(e){const t=this.encode(e);fetch(`http://qa-analytics.unity3d.com?${t}`).catch((()=>{}))}encode(e,t){return Object.entries(e).map((([e,n])=>{const i=t?`${t}[${e}]`:e;return"object"==typeof n&&n?this.encode(n,i):`${encodeURIComponent(i)}=${encodeURIComponent(n)}`})).join("&")}}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=class{constructor(e){this.logFn=e}transmit(e){this.logFn(`WebWrapper | Event fired with data | ${JSON.stringify({name:e.eventName,params:e})}`)}}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AdPlayerAdmFactory=void 0;n.AdPlayerAdmFactory=class{constructor(e){this.admParams=e}create(){const{adViewId:e,demandSourceName:t,adMarkup:n,userData:i}=this.admParams,{cid:r,crid:a}=n.seatbid.bid[0],{sdkAbName:o,appKey:s,bundleId:d,deviceData:l}=i,{osv:c,sdkv:u,apilvl:p,deviceId:f,os:g}=l;return{id:this.createId(),frames:this.prepareFrames(n),productType:"NativeAd",landingId:n.seatbid.ext.landingId,adViewId:e,cid:r,crid:a,demandSourceName:t,osv:c,os:g,sdkv:u,apilvl:p,sdkAbName:o,appKey:s,bundleId:d,deviceId:f}}createId(){const{cid:e,crid:t}=this.admParams.adMarkup.seatbid.bid[0];return`${e}_${t}`}prepareFrames(e){const{media:t}=e.seatbid.bid[0].ext.assets,n=this.getImageMedia(t);return n?[{type:"fullScreenImage",assets:{portrait:n.config.url,landscape:n.config.url},shouldSendClickEvent:!1}]:[]}getImageMedia(e){return null==e?void 0:e.find((e=>"img"===e.type))}}},{}],9:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.AdPlayerLoader=void 0;const r=e("./types/NativeAdTypes"),a=e("./utils");class o{static load(e){return i(this,void 0,void 0,(function*(){const t=(0,a.createUniqueId)(r.NATIVE_AD_PREFIX),{nativeAd:n,adMarkup:i}=e,{demandSourceName:o}=n.loadMessage.params;n.adPlayerListener.start(n,`AdPlayerMessage.${t}`,i);const s=yield this.prepareAdPlayer(n,t,o);return s.success?t:(n.analytic.report("loadAssetFailed",{callfailreason:"Ad-Player",generalmessage:s.reason}),void n.adPlayerListener.stop())}))}static prepareAdPlayer(e,t,n){return i(this,void 0,void 0,(function*(){const i={assetType:"adunitAsset",demandSourceName:e.id,productType:"NativeAd",retryAttempts:2,retryInterval:1};try{e.controllerFacade.cache.setRetryListener(e.id,(t=>{o.sendRetryCacheAdPlayerEvent(e.analytic,t)})),yield e.controllerFacade.adPlayer.fetchAdPlayerFiles(i);const r=e.controllerFacade.adPlayer.getAdPlayerUrl({adViewId:t,topic:`AdPlayerMessage.${t}`,fromCache:!0,productConfig:{demandSourceName:n,productType:"NativeAd"}});return yield e.controllerFacade.adPlayer.loadAdView(r,t)}catch(e){return{success:!1,reason:`${e}`}}}))}static sendRetryCacheAdPlayerEvent(e,t){const n=t.success?"adUnitRetrySuccess":"adUnitRetryFail",i=`${t.file}[${t.currentRetryAttempt} of ${t.totalRetryAttempts}]`;e.report(n,{generalmessage:i})}}n.AdPlayerLoader=o},{"./types/NativeAdTypes":23,"./utils":24}],10:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=i(e("./ControllerFacade")),a=i(e("./NativeAdApi"));n.default=class{createNativeAdApi(e){const{controller:t,core:n}=e,i=new r.default({controller:t,core:n});return new a.default(i)}}},{"./ControllerFacade":11,"./NativeAdApi":19}],11:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const r=e("./common/types/Events"),a=e("./types/NativeAdTypes");n.default=class{constructor(e){this.controller=e.controller,this.core=e.core,this.analytics=new o(e),this.adPlayer=new s(e),this.cache=new d(e),this.supplyConfigurations=e.controller.SupplyConfigurations}callSDKFunction(e,t,n,i){this.controller.callSDKFunction(e,t,n,i)}onReceivedLoadReport(e){return i(this,void 0,void 0,(function*(){const t=`NativeCallback.${a.NATIVE_AD_PREFIX}.loadReport.${e}`;return new Promise((e=>{const n=this.core.PubSub.subscribe(t,((t,i)=>{if(this.core.PubSub.unsubscribe(n),!i)return void this.log('NativeAd | invalid message, missing callback method for "loadReport"');e([i,t])}))}))}))}getUserData(){return{deviceData:Object.assign({deviceId:this.controller.getDeviceId()},this.controller.getFormattedDeviceData()),appKey:this.controller.getSDKDataByKey("applicationKey"),bundleId:this.controller.getSDKDataByKey("bundleId"),sdkAbName:this.controller.getSDKDataByKey("sdkAbName")}}getDeviceOs(){return this.controller.getDeviceOs()}sendActionClick(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>{this.controller.callSDKFunction("openUrl",e,"actionClickSuccess","actionClickFail");const n=()=>{this.core.PubSub.unsubscribe(i),this.core.PubSub.unsubscribe(r)},i=this.core.PubSub.subscribe("NativeCallback.actionClickSuccess",(()=>{n(),t({success:!0})})),r=this.core.PubSub.subscribe("NativeCallback.actionClickFail",(e=>{var i;n();t({success:!1,reason:null!==(i=e.errMsg)&&void 0!==i?i:"Unknown reason"})}))}))}))}log(e,t,n){this.controller.log(e,t,n)}sendPixels(...e){for(const t of e){const e=new Image;e.onload=()=>this.log(`loaded pixel, ${t}`),e.onerror=()=>this.log(`loaded pixel, ${t}`),e.src=t}}getNetworkConfigValueByKey(e){return this.supplyConfigurations.getNetworkConfigValueByKey(e)}};class o{constructor(e){this.controller=e.controller,this.core=e.core}createAnalytic(e){const t=this.core.Analytics.createAnalytic({baseData:e});return{report(e,n){const i="object"==typeof e?e:{name:e,id:r.controllerEvents[e]};t.report(i,n)},updateBaseData(e){t.updateBaseData(e)}}}initAnalytics(e){this.controller.initAnalytics({productType:e})}}class s{constructor(e){this.controller=e.controller,this.core=e.core}loadAdView(e,t){const{PubSub:n}=this.core,i=`${t}.loadAdView.success`,r=`${t}.loadAdView.failure`;return new Promise((a=>{const o=n.subscribe(`NativeCallback.${i}`,(()=>{this.unsub(o,s),a({success:!0})})),s=n.subscribe(`NativeCallback.${r}`,(e=>{this.unsub(o,s);const{errMsg:t}=e;a({success:!1,reason:t})})),d={functionName:"loadWithUrl",functionParams:{adViewId:t,urlForWebView:e}};this.controller.callSDKFunction("adViewAPI",d,i,r)}))}fetchAdPlayerFiles(e){return i(this,void 0,void 0,(function*(){yield this.controller.getAdPlayerAssets().prepareAdPlayerAssetsWrapper(e)}))}unsub(...e){for(const t of e)this.core.PubSub.unsubscribe(t)}getAdPlayerUrl(e){const{adViewId:t,topic:n,productConfig:i,fromCache:r}=e;return`${this.controller.adPlayerUrl.getAdPlayerUrl(r,this.controller.getDeviceOs(),i,{shouldBuildAdUnitUrlForExternal:!0})}&adViewId=${t}&controllerMsgTopic=${n}`}subscribeToMessages(e,t){const n=this.core.PubSub.subscribe(`NativeCallback.${e}`,(e=>i(this,void 0,void 0,(function*(){const n=e,i=Object.assign(Object.assign({},n.arguments),{adViewId:n.adViewId,method:n.method,callback:e=>{const t={id:n.id,adViewId:n.adViewId,data:e};this.controller.callSDKFunction("adViewAPI",{functionName:"sendMessage",functionParams:{params:JSON.stringify(t)}})}});yield t(i)}))));return()=>this.core.PubSub.unsubscribe(n)}removeAdView(e){return new Promise((t=>{const{PubSub:n}=this.core,i=`${e}.removeAdView.success`,r=`${e}.removeAdView.failure`,a={functionName:"removeAdView",functionParams:{adViewId:e}};this.controller.callSDKFunction("adViewAPI",a,i,r);const o=n.subscribe(`NativeCallback.${i}`,(()=>{this.unsub(o,s),t({success:!0})})),s=n.subscribe(`NativeCallback.${r}`,(e=>{this.unsub(o,s);t({success:!1,reason:e.errMsg})}))}))}}class d{constructor(e){this.controller=e.controller,this.core=e.core}setRetryListener(e,t){const n=()=>{this.core.PubSub.unsubscribe(r),this.core.PubSub.unsubscribe(a)};function i(t){return t.demandSourceName===e&&!!t.file&&!!t.currentRetryAttempt&&!!t.totalRetryAttempts}const r=this.core.PubSub.subscribe("Cache.assetRetrySuccess",(e=>{const r=e;i(r)&&(n(),t(Object.assign(Object.assign({},r),{success:!0})))})),a=this.core.PubSub.subscribe("Cache.assetRetryFailed",(e=>{const r=e;i(r)&&(n(),t(Object.assign(Object.assign({},r),{success:!1})))}));return n}}},{"./common/types/Events":21,"./types/NativeAdTypes":23}],12:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const r=e("../AdPlayerAdmFactory");n.default=class{setClickCommand(e){this.clickCommand=e}start(e,t,n){this.unsubscribe=e.controllerFacade.adPlayer.subscribeToMessages(t,(t=>i(this,void 0,void 0,(function*(){switch(t.method){case"GetConfig":this.onGetConfig(e,n,t);break;case"AdClicked":yield this.onClick(e);break;case"Analytics":this.onAnalytics(e,t);break;case"log":this.onLog(e,t)}}))))}stop(){var e;null===(e=this.unsubscribe)||void 0===e||e.call(this),this.unsubscribe=void 0}onGetConfig(e,t,n){const i=new r.AdPlayerAdmFactory({demandSourceName:e.loadMessage.params.demandSourceName,adViewId:n.adViewId,adMarkup:t,userData:e.controllerFacade.getUserData()}).create();n.callback(i)}onClick(e){return i(this,void 0,void 0,(function*(){if(!this.clickCommand)return void e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it did not receive click command"});const{command:t,sdkCallback:n}=this.clickCommand;yield e.mediaViewClick(t,n)}))}onAnalytics(e,t){switch(t.action){case"setCustomData":e.analytic.updateBaseData(t.eventParam.data);break;case"fireEvent":e.analytic.report(t.eventParam.eName,t.eventParam.data)}}onLog(e,t){const{origin:n,msg:i,debugLevel:r}=t;e.controllerFacade.log(decodeURI(i),r,n)}}},{"../AdPlayerAdmFactory":8}],13:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=a(e("./AdPlayerListener")),s=e("./State/CreatedState");n.default=class{constructor(e){this.adPlayerListener=new o.default,this.id=e.id,this.loadMessage=e.loadMessage,this.controllerFacade=e.controllerFacade,this.listener=e.listener,this.analytic=this.controllerFacade.analytics.createAnalytic({productType:"NativeAd",demandSourceId:this.id,demandSourceName:this.loadMessage.params.demandSourceName,isBiddingInstance:this.loadMessage.params.inAppBidding}),this.state=new s.CreatedState}load(e){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | load"),yield this.state.load(this,e)}))}register(e){this.controllerFacade.log("NativeAd | register"),this.state.register(this,e)}visibilityChanged(e,t){this.controllerFacade.log("NativeAd | visibilityChanged"),this.state.visibilityChanged(this,e,t)}click(e,t){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | click"),yield this.state.click(this,e,t)}))}mediaViewClick(e,t){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | media view click"),yield this.state.mediaViewClick(this,e,t)}))}privacyClick(){this.controllerFacade.log("NativeAd | privacy click"),this.state.privacyClick(this)}destroy(){this.controllerFacade.log("NativeAd | destroy"),this.analytic.report("adDestroyed",{}),this.killMediaView()}killMediaView(){if(this.adPlayerListener.stop(),this.adViewId){this.controllerFacade.adPlayer.removeAdView(this.adViewId).then((e=>{e.success||this.analytic.report("mediaViewDestroyFailed",{generalmessage:e.reason})})),this.adViewId=void 0}}setState(e){this.state=e}handleIllegalState(e){const{eventName:t,msg:n,response:i}=e;if(this.analytic.report(null!=t?t:"illegalState",{generalmessage:n}),i){const{sdkCallback:e,isCallback:t}=i,a=r(i,["sdkCallback","isCallback"]);this.controllerFacade.callSDKFunction(e,Object.assign(Object.assign({},a),{params:{success:!1,reason:n}}))}}createAssetBitmap(e){function t(e){return e?"1":"0"}return`${t(e.title)}${t(e.advertiser)}${t(e.body)}${t(e.cta)}${t(e.icon)}${t(e.media)}`}}},{"./AdPlayerListener":12,"./State/CreatedState":14}],14:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.CreatedState=void 0;const r=e("../../AdPlayerLoader"),a=e("./FailedState"),o=e("./LoadedState");n.CreatedState=class{load(e,t){return i(this,void 0,void 0,(function*(){try{e.analytic.report("loadAd",{});const n=this.parseAdm(e.loadMessage.params.adm);this.validateAdm(n),e.analytic.updateBaseData({dspname:n.seatbid.ext.dspName});const i=yield this.loadAssets(e,n);e.listener.onAssetsLoaded(t,e.loadMessage.msgId,i);const[r,a]=yield e.controllerFacade.onReceivedLoadReport(e.id);this.handleLoadReport(e,r,a,n)}catch(n){const i=`failed to load native-ad. ${n}`;e.controllerFacade.log(`NativeAd | load failed, ${i}`,1),e.analytic.report("loadAdFailed",{generalmessage:i}),e.listener.onLoadFailure(t,e.loadMessage.msgId,i),e.setState(new a.FailedState)}}))}handleLoadReport(e,t,n,i){const{msgId:r,params:s}=n;if(Object.values(s).some((e=>null==e?void 0:e.success))){e.controllerFacade.log(`NativeAd | load success, report: ${JSON.stringify(s)}`);const n=this.createAssetBitmap(e,s);return e.analytic.report("loadAdSuccess",{generalmessage:n}),e.listener.onLoadSuccess(t,r),void e.setState(new o.LoadedState(i))}e.controllerFacade.log(`NativeAd | load failed, non-success report: ${JSON.stringify(s)}`,1),e.analytic.report("loadAdFailed",{generalmessage:"failed to load native ad, empty report"}),e.listener.onLoadFailure(t,r,"cannot load empty ad"),e.setState(new a.FailedState)}createAssetBitmap(e,t){var n,i,r,a,o,s,d,l,c,u,p,f;const g={title:null!==(i=null===(n=t.title)||void 0===n?void 0:n.success)&&void 0!==i&&i,body:null!==(a=null===(r=t.body)||void 0===r?void 0:r.success)&&void 0!==a&&a,advertiser:null!==(s=null===(o=t.advertiser)||void 0===o?void 0:o.success)&&void 0!==s&&s,cta:null!==(l=null===(d=t.cta)||void 0===d?void 0:d.success)&&void 0!==l&&l,icon:null!==(u=null===(c=t.icon)||void 0===c?void 0:c.success)&&void 0!==u&&u,media:null!==(f=null===(p=t.media)||void 0===p?void 0:p.success)&&void 0!==f&&f};return e.createAssetBitmap(g)}parseAdm(e){try{const t=e.replace(/\+/g,"%20"),n=decodeURIComponent(t);return JSON.parse(n)}catch(e){throw new Error(`failed to parse adm. ${e}`)}}validateAdm(e){var t,n,i;const r=e.seatbid,{id:a}=null!==(n=null===(t=null==r?void 0:r.ext)||void 0===t?void 0:t.auction)&&void 0!==n?n:{},o=null===(i=null==r?void 0:r.bid)||void 0===i?void 0:i[0],{cid:s,crid:d,ext:l}=null!=o?o:{},{assets:c,clickTags:u,callbacks:p}=null!=l?l:{},{clickURL:f,pixelURL:g}=null!=u?u:{},{impressions:v}=null!=p?p:{},m={cid:s,crid:d,assets:c,clickURL:f,pixelURL:g,impressions:v,id:a},h=[];for(const[e,t]of Object.entries(m))t||h.push(e);const b={impressions:v,pixelURL:g};for(const[e,t]of Object.entries(b))t&&0===t.length&&h.push(e);if(c&&0===Object.keys(c).length&&h.push("assets"),h.length>0)throw new Error(`invalid adm, missing: ${h.join(", ")}`)}loadAssets(e,t){return i(this,void 0,void 0,(function*(){const{assets:n}=t.seatbid.bid[0].ext,i=yield this.loadAdView(e,t);return e.adViewId=null==i?void 0:i.adViewId,{title:n.title,advertiser:n.advertiser,body:n.body,cta:n.cta,media:i,icon:n.icon}}))}loadAdView(e,t){return i(this,void 0,void 0,(function*(){const{media:n}=t.seatbid.bid[0].ext.assets,i=this.getImageMedia(n);if(!i)return;const a=yield r.AdPlayerLoader.load({nativeAd:e,adMarkup:t});return a?{adViewId:a,w:i.config.w,h:i.config.h}:void 0}))}getImageMedia(e){return null==e?void 0:e.find((e=>"img"===e.type))}register(e){e.handleIllegalState({msg:"Requested to register nativeAd, before finish loading"})}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, before finish loading",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, before finish loading",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), before finish loading",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, before finish loading"})}}},{"../../AdPlayerLoader":9,"./FailedState":15,"./LoadedState":16}],15:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.FailedState=void 0;n.FailedState=class{load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a failed ad"})}))}register(e){e.handleIllegalState({msg:"Requested to register nativeAd, but it failed to load"})}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, but it failed to load",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it failed to load",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it failed to load",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but it failed to load ad"})}}},{}],16:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.LoadedState=void 0;const r=e("./RegisteredState");n.LoadedState=class{constructor(e){this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a loaded ad"})}))}register(e,t){const{assetViews:n,adViewClickCommand:i}=t.params,a=e.createAssetBitmap(n);e.analytic.report("adRegistered",{generalmessage:a}),n.media?e.adPlayerListener.setClickCommand(i):e.killMediaView(),e.setState(new r.RegisteredState(this.adm))}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, but it is not registered",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it is not registered",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it is not registered",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but ad is not registered"})}}},{"./RegisteredState":17}],17:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RegisteredState=void 0;const a=r(e("./ShownState"));n.RegisteredState=class{constructor(e){this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a registered ad"})}))}register(e){e.handleIllegalState({msg:"trying to register a registered ad"})}visibilityChanged(e,t,n){const{msgId:i,params:r}=t;if(this.isNotImpression(r,e)){const t={success:!1,reason:"visibility flags are not truthy"};return void e.controllerFacade.callSDKFunction(n,{msgId:i,params:t})}const o=this.adm.seatbid.bid[0].ext.callbacks.impressions.map((e=>e.url));e.controllerFacade.sendPixels(...o),e.analytic.report("adVisible",{}),e.controllerFacade.callSDKFunction(n,{msgId:i,params:{success:!0}}),e.setState(new a.default(this.adm))}isNotImpression(e,t){switch(t.controllerFacade.getDeviceOs()){case"ios":return this.isNotIOSImpression(e);case"android":return this.isNotAndroidImpression(e)}}isNotIOSImpression(e){return e.isHidden||!e.isKeyWindow}isNotAndroidImpression(e){return!e.isShown||!e.isWindowVisible&&!e.isVisible}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it is not shown",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it is not shown",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but ad is not shown"})}}},{"./ShownState":18}],18:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const a=r(e("../../common/Debouncer")),o="[data]";n.default=class{constructor(e){this.debouncer=new a.default,this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a shown ad"})}))}register(e){e.handleIllegalState({msg:"trying to register a shown ad"})}visibilityChanged(e,t,n){e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!1,reason:"trying to show an already shown ad"}})}click(e,t,n){return i(this,void 0,void 0,(function*(){this.shouldDebounce(e,t.params.viewName)?e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!1,reason:"debounce click"}}):(yield this.handleClick(e,t.params.viewName),e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!0}}))}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){const i="adPlayerView";this.shouldDebounce(e,i)||(yield this.handleClick(e,i),e.controllerFacade.callSDKFunction(n,{adId:e.id,command:t,params:{success:!0}}))}))}shouldDebounce(e,t){return this.debouncer.isDebouncing()?(e.analytic.report("debounceClick",{generalmessage:t}),!0):(this.debouncer.start(800),!1)}handleClick(e,t){return i(this,void 0,void 0,(function*(){e.analytic.report("adClicked",{generalmessage:t});const{pixelURL:n,clickURL:i}=this.adm.seatbid.bid[0].ext.clickTags;e.controllerFacade.sendPixels(...n);const r=yield e.controllerFacade.sendActionClick({url:i,method:"external_browser"});r.success||e.analytic.report("openUrlError",{generalmessage:r.reason})}))}privacyClick(e){e.analytic.report("privacyLinkClicked",{});const t=this.createPrivacyLink(e);e.controllerFacade.sendActionClick({url:t,method:"external_browser"})}getFeaturesFromNetworkConfig(e){return e.controllerFacade.getNetworkConfigValueByKey("features")}getPrivacyLinkFromConfig(e){const t=this.getFeaturesFromNetworkConfig(e);return"string"==typeof(null==t?void 0:t.privacyLinkUrl)?t.privacyLinkUrl:"https://ironsource.mobi/privacy-policy/privacypolicy.html"}createPrivacyLink(e){var t,n,i,r,a;const s=this.adm.seatbid.bid[0],d=this.getPrivacyLinkFromConfig(e),l={bannerid:s.crid,campaignid:s.cid,creativeid:null!==(t=s.creativeId)&&void 0!==t?t:0,bundleid:null!==(i=null===(n=e.controllerFacade.getUserData())||void 0===n?void 0:n.bundleId)&&void 0!==i?i:"",developer:null!==(r=this.adm.seatbid.ext.developer)&&void 0!==r?r:"",dspname:this.adm.seatbid.ext.dspName,iseurope:null!==(a=this.adm.seatbid.ext.isEurope)&&void 0!==a&&a},c=`${d}?data=${o}`,u=btoa(JSON.stringify(l));return c.replace(o,u)}}},{"../../common/Debouncer":20}],19:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=a(e("./NativeAd/NativeAd"));n.default=class{constructor(e){this.ads=new Map,this.controllerFacade=e,this.controllerFacade.analytics.initAnalytics("NativeAd"),this.analytic=e.analytics.createAnalytic({productType:"NativeAd"}),this.analytic.report("initAd",{})}load(e,t){return i(this,void 0,void 0,(function*(){const n=new o.default({id:e.adId,loadMessage:e,listener:this.createListener(),controllerFacade:this.controllerFacade});this.ads.set(e.adId,n),yield n.load(t)}))}createListener(){const e=this.controllerFacade;return{onAssetsLoaded(t,n,i){const r={msgId:n,params:Object.assign({success:!0},i)};e.callSDKFunction(t,r)},onLoadFailure(t,n,i){const r={msgId:n,params:{success:!1,reason:i}};e.callSDKFunction(t,r)},onLoadSuccess(t,n){const i={msgId:n,params:{success:!0}};e.callSDKFunction(t,i)}}}register(e){const t=this.ads.get(e.adId);t?t.register(e):this.handleIllegalState({msg:"Requested to register nativeAd, but it is not loaded"})}visibilityChanged(e,t){const n=this.ads.get(e.adId);n?n.visibilityChanged(e,t):this.handleIllegalState({msg:"Requested to show a nativeAd, but it is not loaded",response:{isCallback:!0,msgId:e.msgId,sdkCallback:t}})}destroy(e){const t=this.ads.get(e.adId);if(t)this.ads.delete(e.adId),t.destroy();else{const e="Requested to destroy a nativeAd, but it is not loaded";this.handleIllegalState({msg:e})}}click(e,t){return i(this,void 0,void 0,(function*(){const n=this.ads.get(e.adId);if(n)yield n.click(e,t);else{const n="Requested to click on nativeAd, but it is not loaded";this.handleIllegalState({msg:n,response:{isCallback:!0,msgId:e.msgId,sdkCallback:t}})}}))}privacyClick(e){const t=this.ads.get(e.adId);if(t)t.privacyClick();else{const e="Requested to click on privacy button, but it is not loaded";this.handleIllegalState({msg:e})}}handleIllegalState(e){const{eventName:t,msg:n,response:i}=e;if(this.analytic.report(null!=t?t:"illegalState",{generalmessage:n}),i){const{sdkCallback:e,isCallback:t}=i,a=r(i,["sdkCallback","isCallback"]);this.controllerFacade.callSDKFunction(e,Object.assign(Object.assign({},a),{params:{success:!1,reason:n}}))}}}},{"./NativeAd/NativeAd":13}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=class{constructor(){this.debouncing=!1}start(e){this.debouncing=!0,setTimeout((()=>{this.debouncing=!1}),e)}isDebouncing(){return this.debouncing}}},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.controllerEvents=void 0,n.controllerEvents={initAd:1,showAdFail:5,adVisible:8,loadAd:21,loadAdFailed:22,loadAdSuccess:23,adClicked:33,loadAssetFailed:35,illegalState:36,adRegistered:37,adDestroyed:38,mediaViewDestroyFailed:39,openUrlError:114,debounceClick:122,adUnitRetrySuccess:170,adUnitRetryFail:171,privacyLinkClicked:236}},{}],22:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.apiFactory=void 0;const r=i(e("./ApiFactory"));n.apiFactory=new r.default},{"./ApiFactory":10}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NATIVE_AD_PREFIX=void 0,n.NATIVE_AD_PREFIX="nativeAd"},{}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createUniqueId=void 0,n.createUniqueId=function(e=""){return`${e}.${Date.now()}.${Math.random()}`}},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.__addDisposableResource=x,n.__assign=void 0,n.__asyncDelegator=A,n.__asyncGenerator=y,n.__asyncValues=C,n.__await=S,n.__awaiter=c,n.__classPrivateFieldGet=F,n.__classPrivateFieldIn=T,n.__classPrivateFieldSet=O,n.__createBinding=void 0,n.__decorate=s,n.__disposeResources=L,n.__esDecorate=function(e,t,n,i,r,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,d=i.kind,l="getter"===d?"get":"setter"===d?"set":"value",c=!t&&e?i.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,i.name):{}),p=!1,f=n.length-1;f>=0;f--){var g={};for(var v in i)g[v]="access"===v?{}:i[v];for(var v in i.access)g.access[v]=i.access[v];g.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var m=(0,n[f])("accessor"===d?{get:u.get,set:u.set}:u[l],g);if("accessor"===d){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=o(m.get))&&(u.get=s),(s=o(m.set))&&(u.set=s),(s=o(m.init))&&r.unshift(s)}else(s=o(m))&&("field"===d?r.unshift(s):u[l]=s)}c&&Object.defineProperty(c,i.name,u);p=!0},n.__exportStar=f,n.__extends=r,n.__generator=u,n.__importDefault=P,n.__importStar=D,n.__makeTemplateObject=I,n.__metadata=l,n.__param=d,n.__propKey=function(e){return"symbol"==typeof e?e:"".concat(e)},n.__read=v,n.__rest=o,n.__runInitializers=function(e,t,n){for(var i=arguments.length>2,r=0;r<t.length;r++)n=i?t[r].call(e,n):t[r].call(e);return i?n:void 0},n.__setFunctionName=function(e,t,n){"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):"");return Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},n.__spread=m,n.__spreadArray=b,n.__spreadArrays=h,n.__values=g,n.default=void 0;var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return n.__assign=a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function s(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function d(e,t){return function(n,i){t(n,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function s(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}d((i=i.apply(e,t||[])).next())}))}function u(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(d){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,d])}}}n.__assign=a;var p=Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function f(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||p(t,e,n)}function g(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function h(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,r++)i[r]=a[o];return i}function b(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){a.push([e,t,n,i])>1||s(e,t)}))})}function s(e,t){try{(n=r[e](t)).value instanceof S?Promise.resolve(n.value.v).then(d,l):c(a[0][2],n)}catch(e){c(a[0][3],e)}var n}function d(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function A(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:S(e[i](t)),done:!1}:r?r(t):t}:r}}function C(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=g(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}n.__createBinding=p;var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function D(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&p(t,e,n);return w(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function F(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function O(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n}function T(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function x(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:n})}else n&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function L(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var i=e.stack.pop();try{var r=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(r).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}var U={__extends:r,__assign:a,__rest:o,__decorate:s,__param:d,__metadata:l,__awaiter:c,__generator:u,__createBinding:p,__exportStar:f,__values:g,__read:v,__spread:m,__spreadArrays:h,__spreadArray:b,__await:S,__asyncGenerator:y,__asyncDelegator:A,__asyncValues:C,__makeTemplateObject:I,__importStar:D,__importDefault:P,__classPrivateFieldGet:F,__classPrivateFieldSet:O,__classPrivateFieldIn:T,__addDisposableResource:x,__disposeResources:L};n.default=U},{}],26:[function(e,t,n){t.exports=function(e){var t={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,gpv:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,xCodeVersion:0,xCodeBuildVersion:0,xCodeSdkName:0,xCodeSdkBuild:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0,mediationType:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(t.deviceApiLevel=0)},getCommonRequiredData:function(){return t}}}},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});let i=new(e("../modules/StoreConfig"));t.exports=class{constructor(e,t,n,i,r){this.core=e,this.controller=t,this.constants=n,this.dsConfig=i,this.isBidding=r,this.productType=this.getProductType(i.productType)}parse(e,t){var n=e.seatbid.ext;return this.extendControllerConfigSettings(n),this.extendExtraParamsSdkSettings(n,t),this.extendDSConfigSettings(n),this.extendNetworkConfigSettings(e),this.extendMicroJobLandingIDSettings(n),this.overrideCacheSettings(e),this.extendStoreSettings(e),this.extendABMapExtSettings(n),this.extendEpTraits(n),n}extendExtraParamsSdkSettings(e,t){t&&"true"===t.ext_is_mute&&(e.shouldStartMuted=!0)}extendControllerConfigSettings(e){var t=this.controller.getConfig().controllerConfig||{};e.shouldStartMuted=this.controller.AdUtils.isCampaignShouldStartMuted(t,this.productType);var n=this.controller.AdUtils.delayUntilCloseVisible(t,this.productType),i=this.controller.AdUtils.delayUntilTimerVisible(t,this.productType),r=this.controller.AdUtils.endScreenSettings(t,this.productType),a=t.sfts;this.core.Utils.isDefined(n)&&(e.DEC=n),this.core.Utils.isDefined(i)&&(e.DECT=i),this.core.Utils.isDefined(r)&&this.core.Utils.extend(e,{"2EC":r}),this.core.Utils.isDefined(a)&&(e.sfts=a)}getProductType(e){if("RewardedVideo"!==e)return e;var t=this.controller.getConfig().mobileSDKSettings.SDKVersion;return this.core.VersionUtils.isHigher(t,"8.0.0")?this.constants.Rewarded:e}extendDSConfigSettings(e){this.core.Utils.extend(!0,e,this.dsConfig.overrideFeedSettings)}extendNetworkConfigSettings(e){var t,n;const i=null!==(n=null===(t=e.seatbid.bid[0])||void 0===t?void 0:t.ext.adSource)&&void 0!==n?n:e.seatbid.ext.adSource;e.seatbid.ext=this.core.Utils.extend(!0,e.seatbid.ext,this.controller.SupplyConfigurations.getFeaturesConfigByAdSource(i))}extendMicroJobLandingIDSettings(e){e.sdkToggles&&delete(e=this.core.Utils.extend(!0,e,e.sdkToggles)).sdkToggles}_shouldOverrideCacheSettingsToPrecache(){return this.productType===this.constants.BN?this.controller.isBannerMultipleInstances(this.productType):this.isBidding}overrideCacheSettings(e){if(this.controller.Utils.isWebWrapper())return;let t=e.seatbid.ext;this._shouldOverrideCacheSettingsToPrecache()&&(t.numOfBannersToInitSuccess=1,t.numOfBannersToCache=1)}extendStoreSettings(e){var t,n;const{ext:r,bid:a}=e.seatbid,o=null===(n=null===(t=a[0])||void 0===t?void 0:t.ext.store)||void 0===n?void 0:n.id;this.core.Utils.extend(r,i.getSettingsToOverride(o,r))}extendABMapExtSettings(e){var t;const n=null!==(t=this.controller.getConfig().mobileSDKSettings.ext)&&void 0!==t?t:{};this.core.Utils.extend(!0,e,n)}extendEpTraits(e){var t,n,i=this.controller.getConfig().controllerConfig||{},r=null===(t=null==i?void 0:i.epConfig)||void 0===t?void 0:t.traits,a=null===(n=null==i?void 0:i.epConfig)||void 0===n?void 0:n.ett;a&&Array.isArray(a)&&a.length>0&&(e.ett=a.toString()),this.core.Utils.extend(!0,e,r)}}},{"../modules/StoreConfig":208}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.exports=function(e,t,n){const{portrait:i,landscape:r}=t.appInfo.orientation,a={android:function(e,t){return e.ext.forceOrientation.toLowerCase()},ios:function(t,i){return!function(t){var n,i;const r=null!==(i=null===(n=t.settings.sdkToggles)||void 0===n?void 0:n.ignoreAppOrientationInForceCampaigns)&&void 0!==i&&i;return e.log(`shouldIgnoreAppOrientationInForcedCampaign: ${Boolean(r)}`,e.LogLevels.verbose),r}(t)&&n.getOrientation()&&n.isAppOrientation(t.ext.forceOrientation.toLowerCase())?(e.log(`forced campaign | application is locked on the same orientation - sending  default: ${i}`,e.LogLevels.verbose),i):t.ext.forceOrientation.toLowerCase()}};function o(e){return e&&e.controllerConfig&&["499b4845","406ff65d"].some((t=>t===e.controllerConfig.applicationKey))}return{getAdDisplayOrientation:function(s,d){if(!d)return;let l="undefined",c=t.defaultOrientation[d.productType];return o(s)&&d.settings&&(d.settings.orientation=i),!function(e,t){return t.ext&&t.ext.forceOrientation&&(!o(e)||o(e)&&t.ext.forceOrientation.toLowerCase()===r)}(s,d)?c=function(e){return e.settings&&e.settings.orientation}(d)?d.settings.orientation:n.getOrientation():(c=a[s.mobileSDKSettings.deviceOs](d,c),l=c),"string"==typeof c&&c.toLowerCase()===t.appInfo.orientation.none&&(c=t.defaultOrientation[d.productType]),e.log(`adOrientation | forceByCampaign:${l} , forceBySession:${d.settings.orientation} ,forceByNative:${n.getOrientation()} , ChosenOrientation:${c}`,e.LogLevels.info),c?c.toLowerCase():""}}}},{}],29:[function(e,t,n){"use strict";var i=e("../types"),r=e("./MraidCreativeService");const a=e("./OMIDConstants"),o=e("./Constants");t.exports=function(e,t){const n="MRAID",s="VAST",d="EXTERNAL",l="INTERACTIVE_END_CARD",c="INTERNAL",u="AT_MP",p="IEC_MP",f="PLAYABLE",g="IMAGE_INTERSTITIAL",v="STATIC_BANNER",m="HTML_MP",h="VPAID_WRAPPER",b="OTHER",S="imageInterstitial",y={};function A(e){if(e){if(!e.id){T(e,I(e)||"",D(e)||"")}return e.id&&e.id.toString()}}function C(e){var t,n,i;return null!==(n=null===(t=null==e?void 0:e.settings)||void 0===t?void 0:t.adSource)&&void 0!==n?n:null===(i=null==e?void 0:e.ext)||void 0===i?void 0:i.adSource}function I(e){if(!e)return;const t=e.crid||e.bannerId||e.bannerID;return t&&t.toString()}function w(e){if(e&&null!=e.cid)return e.cid.toString()}function D(e){if(!e)return;return(e.creativeId||"0").toString()}function P(e){return e&&e.ext&&e.ext.store&&e.ext.store.id}function F(e){return null==e?void 0:e.adAssetsCacheStatus}function O(e){var t,n;if(!e||!e.ext)return;const i=e.ext;return"MRAID"===i.type?null!==(t=function(e){if(!e||"MRAID"!==e.type)return;if(!e.videoData||!e.videoData.videoSource||!e.videoData.videoSource.mraid)return;const t=new DOMParser,n=e.videoData.videoSource.mraid,i=t.parseFromString(n,"text/html").querySelector('script[data-mrail="tdmp"]');if(!i)return;const r=i.textContent;let a;try{null!=r&&(a=JSON.parse(r))}catch(e){return}return a.hasOwnProperty("ili")?a.ili:void 0}(i))&&void 0!==t?t:void 0:null!==(n=function(e){if(e)return void 0!==e.mpTestId?e.mpTestId:void 0}(i))&&void 0!==n?n:void 0}function T(e,t,n){e.id=`${t}_${n}`}function x(e,t){if(!e)return"";return function(e){return y[e]||y.other}(N(e,t))}y[n]="MR",y[s]="VA",y[d]="EX",y[l]="IEC",y[c]="AT",y[u]="AT_MP",y[p]="IEC_MP",y[f]="PL",y[g]="IM",y[v]="SB",y[m]="HTML_MP",y[h]="VW",y[b]="OT";var N=function(t,r){const a=t&&t.ext;let o="";return a?(o=function(e){return e&&e.type&&e.type===S}(a)?g:e.VastUtils.isVastCampaign(t)?s:L(a)?f:k(a)?n:R(a)?u:function(e){return e&&e.type&&e.type===i.AdType.IECMarketplace}(a)?p:B(a)?h:K(a)?d:j(a)?l:_(a)?c:function(e){return e&&e.type&&e.type===i.AdType.StaticBanner}(a)?v:function(e){return e&&e.type&&e.type===i.AdType.HtmlMp}(a)?m:b,o):o};function L(e){return e&&e.type&&e.type===i.AdType.PlayableAd}function U(e){return(L(e)||B(e))&&e.videoData&&e.videoData.videoSource&&!(!e.videoData.videoSource.mraidUrl&&!e.videoData.videoSource.mraid)}function M(e){return function(e){return e&&e.type&&e.type===i.AdType.CustomEndCard}(e)&&e.layoutData&&!(!e.layoutData.mraidUrl&&!e.layoutData.mraid)}function V(e){return U(e)||M(e)}function E(e){var t;return null!==(t=e.mraidCreativeLoadStrategy)&&void 0!==t?t:r.MraidCreativeLoadStrategy.None}function k(e){return e&&e.type&&e.type===i.AdType.MRAID}function B(e){return e&&e.type&&e.type===i.AdType.VpaidWrapper}function R(e){return e&&e.type&&e.type===i.AdType.AppTrailerMarketplace}function K(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function j(e){return e.type===i.AdType.CustomEndCard}function _(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function W(t){const n={};return n.id=A(t),n.title="",n.credits=t.credits,n.staticContent=e.AdAssets.extractStaticFiles(t),n.lastUpdateTime=t.lastUpdateTime,n.inventoryIndex=t.inventoryIndex,n.isCacheable=t.isCacheable=n.staticContent.length>0,n}function G(e){const{deviceOs:n}=t.getApiData({deviceOs:1});e.standaloneView=n===o.deviceOs.ios,e.translucentView=n===o.deviceOs.android}function H(e,t){const n={};return t&&t.ext&&t.ext.opportunityID&&(n.opportunityId=t.ext.opportunityID),e&&e.requestID&&(n.requestId=e.requestID),n}return{getAdId:A,getOmidUrl:function(e){let n=t.OMIDService.getVersionData().omidVersion;return t.OMIDService.isAdOmidSupported(e,e.productType)&&a.omidVersionRequiresWebviewPerAd[n]?t.OMIDService.getOmidFolderUrl():""},getAdIdsOfAds:function(e){if(!e||!Array.isArray(e))return[];const t=[];for(let n=0;n<e.length;n++)t.push(A(e[n]));return t},generateUniqueAdId:function(e){return`${e.productType}.${e.demandSourceName}.${A(e)}.${Date.now()}`},getAdSource:C,getBannerId:I,getCreativeId:D,getCampaignId:w,getAdType:x,formatParamsToAdId:function(e){if(e){if(!e.id){const t=I(e);t&&T(e,t,o.legacyCreativeId.toString())}return e}},formatAdsForPrecache:function(e){return e.map(((e,t)=>W(e))).filter((e=>e.isCacheable))},isCacheableAd:function(e){return e&&e.hasOwnProperty("isCacheable")},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;let t="";const n=e.ext.clickTags.clickURL;return n&&(t=function(e){let t=e.match(/id\d+/g),n="";t&&(t=t[t.length-1],t=t.match(/\d+/g),n=Array.isArray(t)?t[0]:"");return n}(n)||"",t&&(e.ext.clickTags.storeAppId=t)),t},formatVastAdForPrecache:function(e,t){let n;return n=W(e),n.preProcessing=t,n.isCacheable=e.isCacheable=!0,n},setViewType:function(e,t,n){var i;t&&t.ext&&((i=t.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl))&&G(e),n&&(e.viewType=n)},removeViewTypeFromSetting:function(e){e.viewType&&delete e.viewType},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:H,updateEventWithAdParams:function(t,n,i){if(n){const r=O(n);(i=e.Utils.extend(i,H(t,n))).bannerId=I(n),i.creativeId=D(n),i.campaignId=w(n),i.adSource=i.adSource||C(n),i.campaignType=x(n,t),i.storeId=P(n),i.custom_g=F(n),i.mrailVersion=r?String(r):void 0}return i},isPlayableCampaign:L,isPlayablePrecachedAd:function(e){const t=e.ext;return L(t)&&t.videoData&&t.videoData.videoSource&&!!t.videoData.videoSource.htmlURL},isInteractiveEndCardCampaign:j,isInternalCampaign:_,isAppTrailerMarketPlaceCampaign:R,isMRAIDCampaign:k,isExternalCampaign:K,isCampaignShouldStartMuted:function(e,t){return!(!e||!e[o.sspProductNames[t]]||!0!==e[o.sspProductNames[t]].startVideoOnMute)},delayUntilCloseVisible:function(t,n){if(t&&t[o.sspProductNames[n]]&&e.Utils.isDefined(t[o.sspProductNames[n]].DEC))return t[o.sspProductNames[n]].DEC},endScreenSettings:function(e,t){var n;return null===(n=null==e?void 0:e[o.sspProductNames[t]])||void 0===n?void 0:n["2EC"]},delayUntilTimerVisible:function(t,n){if(t&&t[o.sspProductNames[n]]&&e.Utils.isDefined(t[o.sspProductNames[n]].DECT))return t[o.sspProductNames[n]].DECT},extendAdObjectWithConfig:function(t,n,i,r){n.settings=e.Utils.extend(!0,n.settings,r),n.ext&&n.ext.forceOrientation&&(n.settings.orientation=n.ext.forceOrientation.toLowerCase()),n=e.Utils.extend(!0,n,i,{url:t})},extendSettingsWithStandaloneViewSupport:G,extractEventData:function(e){if(!e||!e.ext)return{};let t={requestId:e.requestID,opportunityId:e.ext.opportunityID,bannerId:I(e),creativeId:D(e),campaignType:x(e,e.ext),rvPlayMethod:e.displayMode,displayStrategy:e.displayStrategy,dynamicDemandSource:e.ext.dynamicDemandSource,auctionId:e.ext.auctionId,adunitVersion:e.adunitVersion,adunitbn:e.adunitbn,isBiddingInstance:e.isInAppBidding,isOneFlow:e.isOneFlow,productType:e.productType,demandSourceName:e.originalDemandSourceName,sessionDepth:e.settings&&e.settings.sessionDepth,strategyId:e.settings&&e.settings.strategyId,landingId:e.settings&&e.settings.landingId,adSource:C(e),storeId:P(e),custom_g:F(e)};return Object.keys(t).reduce((function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e}),{})},mraidWaitForVisible:function(t,n){var i;if(t&&t[o.sspProductNames[n]]&&e.Utils.isDefined(null===(i=t[o.sspProductNames[n]])||void 0===i?void 0:i.mraidReadyOnlyInVisible))return t[o.sspProductNames[n]].mraidReadyOnlyInVisible},getConfirmCloseMsg:function(e){let t=o.confirmCloseMsg;return e.settings.labels&&e.settings.labels.confirmCloseMsg&&e.settings.labels.confirmCloseMsg.during&&(t=e.settings.labels.confirmCloseMsg.during),t},handleExtendingAd:function(n,i){let a;return n?(!function(n,i){i.requestID&&(n.requestID=i.requestID);var a=t.getApiData({scdn:1,protocol:0,defaultProtocol:1}),s=t.InstanceUtils.getUrlToCdn(a.scdn);n=function(n,i){n.settings.omidFolderUrl=t.AdUtils.getOmidUrl(n),void 0===n.productType&&(n.productType=i.productType);void 0===n.demandSourceName&&(n.demandSourceName=i.demandSourceName);void 0!==n.settings.cw&&(n.settings.cw=function(e){var n=t.getDeviceOs();return e.settings.cw&&e.settings.cw.hasOwnProperty(n)?e.settings.cw[n]:e.settings.cw}(n));n.displayOnAdReady=i.displayOnAdReady,n.settings.precache=!1,n.settings.sessionDepth=t.ImpressionsCounterService.getPayloadCounters(i).instanceImpressions+1,n.settings.viewType=i.viewType,n.settings.isGpi=t.isGpi(),n.settings.shouldCacheMraidCreative=function(e){return E(e)===r.MraidCreativeLoadStrategy.Cache}(n),e.AdAssets.isAdAbleToCache(n)&&(n.settings.ableToCache=n.ext.ableToCache,delete n.ext.ableToCache);return n}(n=e.Utils.extend(!0,n,t.getFormattedDeviceData(),function(e){return{settings:{protocol:t.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:t.getSDKDataByKey(o.requiredSDKDataKeys.applicationKey),appOrientation:t.getSDKDataByKey(o.requiredSDKDataKeys.appOrientation),deviceLanguage:t.getSDKDataByKey(o.requiredSDKDataKeys.deviceLanguage),bundleId:t.getSDKDataByKey(o.requiredSDKDataKeys.bundleId),sdkAbName:t.getSDKDataByKey(o.requiredSDKDataKeys.sdkAbName),deviceId:t.getDeviceId(),skOverlaySupported:t.SKOverlayManager.isSKOverlaySupported()}}}(s)),i)}(n,i),a=t.Utils.flattenAd(n),t.ExternalAdProtocols.prepareAd(a)):t.log("line[456]: no current available ad",t.LogLevels.verbose),a||{}},validateADM:function(t,n){let i={isValid:!0,errMsg:""};if(t&&t.errorCode){var r=t.errorMessage?t.errorMessage:n.invalidErrorCode;i.isValid=!1,i.errMsg=r}else t.seatbid&&t.seatbid.bid&&t.seatbid.ext&&e.Utils.isDefined(t.seatbid.ext.labels)||(i.isValid=!1,i.errMsg=n.invalidAdm);return i},getAdsInternalInfoEventData:function(e){let t,n=e.adsInternalInfo;if(!n)return{success:!1,error:{custom_a:"no adsInternalInfo in params"}};try{let e=JSON.parse(decodeURIComponent(n));if(!e.success||!e.data)return{success:!1,error:{custom_a:"adsInternalInfo json parse failed"}};t=JSON.parse(decodeURIComponent(e.data))}catch(e){return{success:!1,error:e}}let r=0,a=0,o=0,s=0,d=0;for(let e=0;e<t.length;e++){switch(t[e].adStatus){case i.AdsInternalInfoAdStatus.LoadRequest:r++;break;case i.AdsInternalInfoAdStatus.LoadSuccess:a++;break;case i.AdsInternalInfoAdStatus.ShowSuccess:o++;break;case i.AdsInternalInfoAdStatus.ShowFailed:s++;break;case i.AdsInternalInfoAdStatus.Destroyed:d++}}return{success:!0,data:{custom_a:r,custom_b:a,custom_c:o,custom_e:s,custom_f:d}}},_isCustomHTMLCampaign:U,isMraidInteractiveEndCard:M,setMraidCreativeLoadStrategy:function(e){if(!V(e.ext)||function(e){if(V(e))return!!e.videoData.videoSource.mraid;if(M(e))return!!e.layoutData.mraid;return!1}(e.ext))return void(e.mraidCreativeLoadStrategy=r.MraidCreativeLoadStrategy.None);if(B(e.ext))return void(e.mraidCreativeLoadStrategy=r.MraidCreativeLoadStrategy.Fetch);const n=t.shouldCacheMraidCreativeNetworkConfig();e.mraidCreativeLoadStrategy=n?r.MraidCreativeLoadStrategy.Cache:r.MraidCreativeLoadStrategy.Fetch},isCampaignContainsMraidCreative:V,getMraidCreativeLoadStrategy:E}}},{"../types":229,"./Constants":40,"./MraidCreativeService":63,"./OMIDConstants":72}],30:[function(e,t,n){t.exports=function(e,t,n){return{decideOnAdvertisingId:function(i,r){t.isIOS()&&(e.VersionUtils.isLower(i.deviceOSVersion,"10")||function(e){return e["deviceIds[IFA]"]&&e["deviceIds[IFA]"]!==n.advertisingId.invalidAdvertisingId}(i))&&(void 0===r.sid||r.sid||(i["deviceIds[IDFV]"]=null))}}}},{}],31:[function(e,t,n){t.exports=function(t,n){var i="AndroidLifeCycleEventHandlers | ",r=e("./NativeLifeCycleEventsConstants.js"),a={};function o(e){var n={};e&&(n.eventParams=e),t.PubSub.publish(r.serviceCallback+"."+r.AndroidEvents.onDestroy,[n])}function s(e){}function d(e){}function l(e){}function c(e,t){var r;return r="_isEventSupported: "+e+" supportedEvents: "+t,n.log(i+r),e&&t.indexOf(e)>-1}return{publishEvent:function(e,t){a[r.AndroidEvents.onDestroy]=o,a[r.AndroidEvents.onStop]=s,a[r.AndroidEvents.onStart]=d,a[r.AndroidEvents.onResume]=l,c(e,Object.keys(a))&&a[e](t)}}}},{"./NativeLifeCycleEventsConstants.js":68}],32:[function(e,t,n){t.exports={analyticsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],33:[function(e,t,n){t.exports=function(t){var n,i=e("./AndroidNomediaFileConstants.js"),r=i.noMediaFileUrl;return{init:function(e){n=e},updateNomediaFileToCache:function(){var e=t.getConfig(),a=t.Cache.getRootCacheStructure(),o=function(e){return e.mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+r}(e);a&&-1!==t.Cache.getFileIndexInCache(a.cache,o)?t.log(i.logMessage.tag+i.logMessage.fileInCache):(t.log(i.logMessage.tag+i.logMessage.saveFileToCache),t.saveFileToCache("./",o).then((function(){n.report(i.analyticsCategories.nomediaFileDownloadSuccess)}),(function(e){e!==i.errorMessage.fileAlreadyExist&&n.report(i.analyticsCategories.nomediaFileDownloadFail,{generalMessage:e})})))}}}},{"./AndroidNomediaFileConstants.js":32}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={messageFromAdPlayer:{apsAttribution:"SDKController.apsAttribution"},messageToNative:{apsAttribution:{name:"androidSandboxApi",success:"apsAttribution.success",failure:"apsAttribution.failure"}}};n.default=i},{}],35:[function(e,t,n){"use strict";var i,r=(i=e("./AndroidSandboxConstants"))&&i.__esModule?i:{default:i};const a=e("../../modules/DemandSource/EventCategories")();t.exports=class{constructor(e){this.controller=e.controller,this.core=e.core,this.analytics=e.analytics,this.shouldReceiveMessage=e.shouldReceiveMessage}init(){"ios"!==this.controller.getDeviceOs()&&this.initAttributionListeners()}initAttributionListeners(){this.core.PubSub.subscribe(r.default.messageFromAdPlayer.apsAttribution,(e=>this.onAttribution(e)));const{failure:e,success:t}=r.default.messageToNative.apsAttribution;this.core.PubSub.subscribe("NativeCallback."+t,(e=>this.onAttributionSuccess(e))),this.core.PubSub.subscribe("NativeCallback."+e,(e=>this.onAttributionFailure(e)))}onAttribution(e){const t=e;if(!this.shouldReceiveMessage(t))return;const{type:n,coordinates:i,url:o,demandSourceName:s,productType:d}=t,{name:l,success:c,failure:u}=r.default.messageToNative.apsAttribution;this.analytics.report(a.apsAttribution,{custom_a:n});const p={type:"attribution",demandSourceName:s,productType:d,params:{type:n,coordinates:i,url:o}};this.controller.callSDKFunction(l,p,c,u)}onAttributionFailure(e){const t=e;this.shouldReceiveMessage(t)&&this.analytics.report(a.apsAttributionFailed,{generalmessage:t.params.reason,custom_a:t.params.type})}onAttributionSuccess(e){const t=e;this.shouldReceiveMessage(t)&&this.analytics.report(a.apsAttributionSuccess,{custom_a:t.params.type})}}},{"../../modules/DemandSource/EventCategories":162,"./AndroidSandboxConstants":34}],36:[function(e,t,n){t.exports={NativeAPI:{getAUIDFailed:"getAUIDFailed",getAUIDSuccess:"getAUIDSuccess",setAUIDFailed:"setAUIDFailed",setAUIDSuccess:"setAUIDSuccess"}}},{}],37:[function(e,t,n){t.exports=function(t,n,i){var r,a,o="AppUserIdService | ",s=!1,d=e("../modules/SDKController/EventCategories")(),l=e("./AppUserIdConstants");function c(e){var r=new jQuery.Deferred;(function(e){return e&&!t.Utils.isEmptyObject(e)&&"{}"!==e})(e)?r.resolve(e):function(e,r){var a,s,d,c=[],u=4e3,p=l.NativeAPI.setAUIDSuccess,g=l.NativeAPI.setAUIDFailed;if(!e||!r)return;c.push(t.PubSub.subscribe(i.CB+"."+p,(function(e){if(clearTimeout(d),!(a=n.isIOS()?e&&e.key&&e.key===f()&&e.value&&decodeURIComponent(e.value):e&&e[f()]&&decodeURIComponent(e[f()]))||t.Utils.isEmptyObject(a)||"{}"===a)return r.reject("Invalid set AUID response."),void t.PubSub.clearHandlers(c);n.log(o+"_setAUIDKeyInNative succeeded, response: "+a,n.LogLevels.info),r.resolve(a),t.PubSub.clearHandlers(c)}))),c.push(t.PubSub.subscribe(i.CB+"."+g,(function(e){clearTimeout(d),s=e&&!n.checkRequiredCallbackParams(["errMsg"],e,g).didSucceed?n.checkRequiredCallbackParams(["errMsg"],e,g).errMsg:e&&e.errMsg,n.log(o+"_setAUIDKeyInNative failed, errorMsg: "+s,n.LogLevels.info),r.reject(g+": "+s),t.PubSub.clearHandlers(c)}))),d=setTimeout((function(){n.log(o+"_setAUIDFromNative failed, errorMsg: timeout",n.LogLevels.info),r.reject(g+": timeout"),t.PubSub.clearHandlers(c)}),u),n.callSDKFunction("setUserData",{key:f(),value:e},p,g)}(t.Utils.generateIdentifier(1),r);return r.promise()}function u(e,i){r=e,t.Analytics.updateBaseData({auid:r}),i||n.getTokenService().updateToken({auid:r})}function p(e){a.report(d.auidFail,{callfailreason:e})}function f(){var e=n.SupplyConfigurations.getNetworkConfigValueByKey("auid_key");return e||"auid"}return{init:function(e){var r,d,g,v,m,h,b,S,y;s||(a=e,(r=n.SupplyConfigurations.getValueByKey("auid"))?function(e){u(e,!0)}(r):(m=[],h=4e3,b=new jQuery.Deferred,S=l.NativeAPI.getAUIDSuccess,y=l.NativeAPI.getAUIDFailed,m.push(t.PubSub.subscribe(i.CB+"."+S,(function(e){if(clearTimeout(v),!(d=e&&e[f()]&&decodeURIComponent(e[f()])))return b.reject("Invalid get AUID response"),void t.PubSub.clearHandlers(m);n.log(o+"_getAUIDFromNative succeeded, response: "+d,n.LogLevels.info),b.resolve(d),t.PubSub.clearHandlers(m)}))),m.push(t.PubSub.subscribe(i.CB+"."+y,(function(e){clearTimeout(v),g=e&&!n.checkRequiredCallbackParams(["errMsg"],e,y).didSucceed?n.checkRequiredCallbackParams(["errMsg"],e,y).errMsg:e&&e.errMsg,n.log(o+"_getAUIDFromNative failed, errorMsg: "+g,n.LogLevels.info),b.reject(y+": "+g),t.PubSub.clearHandlers(m)}))),v=setTimeout((function(){n.log(o+"_getAUIDFromNative failed, errorMsg: timeout",n.LogLevels.info),b.reject(y+": timeout"),t.PubSub.clearHandlers(m)}),h),n.callSDKFunction("getUserData",{key:f()},S,y),b.promise()).then(c).then(u).fail(p),s=!0)},getAUID:function(){return r}}}},{"../modules/SDKController/EventCategories":193,"./AppUserIdConstants":36}],38:[function(e,t,n){t.exports=function(e){var t={},n=!1;function i(e,n){var i=t[e],r=[];return i&&i[n]?r=i[n]:i[n]=r,r}return{init:function(i){n||(i,t[e.RV]={},t[e.IS]={},t[e.BN]={},n=!0)},addToBlacklistedCampaigns:function(e,t,n){if(e&&t&&n){var r=i(e,t);r&&-1===r.indexOf(n)&&r.push(n)}},getBlacklistedCampaigns:function(e,t){var n=[];return e&&t&&(n=i(e,t)),n},isEmpty:function(e,t){var n=i(e,t);return!n||0===n.length}}}},{}],39:[function(e,t,n){t.exports=function(e,t,n){var i,r,a="FilterCampaigns | ",o={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},s=1500,d=e.Utils,l={};function c(i){var r,o,d,l=new jQuery.Deferred,c="checkInstalledAppsSuccess",u="checkInstalledAppsFailed",p={appIds:i,requestId:Date.now().toString()},f=function(){e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(o)};return r=e.PubSub.subscribe(n.CB+"."+c,(function(e){e.requestId===p.requestId&&(clearTimeout(d),f(),t.log(a+"successfully check apps installed "+JSON.stringify(e.result)),l.resolve(e.result))})),o=e.PubSub.subscribe(n.CB+"."+u,(function(e){clearTimeout(d),f(),t.log(a+"failed to check apps installed"+JSON.stringify(e)),l.reject()})),d=setTimeout((function(){f(),l.reject("SDK check apps installed timeout request")}),s),t.callSDKFunction("checkInstalledApps",p,c,u),l.promise()}function u(n){var a={deviceId:"ios"===(i=t.getApiData(o)).deviceOs?i["deviceIds[IFA]"]:i["deviceIds[AID]"],os:i.deviceOs,campaignIds:{}},s=r.urlPaths&&r.urlPaths.campaignsStatus;s?(e.Utils.each(n,(function(e,t){var n,i;a.campaignIds[t.campaignId]=(t.isInstalled?(n=50,i=100):(n=0,i=50),Math.floor(Math.random()*(i-n))+n)})),jQuery.ajax({url:s,data:a,type:"GET",dataType:"jsonp",success:function(e){t.log("Success update campaigns status to server",t.LogLevels.verbose)},error:function(e,n){t.log("Success update campaigns status to server: response:"+e+".status: "+n,t.LogLevels.verbose)}})):t.log("No url in settings to update server on campaigns status",t.LogLevels.verbose)}function p(e,n){var i=!0;return e||(t.log("filter apps installed flag is false",t.LogLevels.verbose),i=!1),n&&0!==n.length||(t.log("get 0 campaigns to filter",t.LogLevels.verbose),i=!1),t.isLegacy({ios:"5.14",android:"5.16"})&&(t.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",t.LogLevels.verbose),i=!1),i}function f(n,i,r){var a=new jQuery.Deferred;return e.Utils.isEmptyObject(i)?a.resolve():function(n){return t.isAppsInstalledInfoRestricted()?e.Utils.returnResolvedPromise(l):c(n)}(r).then(g.bind(null,n,i,a)).then(u).fail((function(e){t.log("failed filter campaigns by app installed. "+e,t.LogLevels.verbose),a.resolve()})),a.promise()}function g(n,i,r,o){e.Utils.each(o,(function(e,t){var n=i[e];n&&(t.bannerIds=n)}));var s=function(n,i){var r=[];return e.Utils.each(i,(function(e,i){if(i.isInstalled){for(var a=[],o=0;o<n.length;o++){var s=t.AdUtils.getAdId(n[o]);i.bannerIds&&-1===i.bannerIds.indexOf(s)?a.push(n[o]):r.push(n[o])}n.length=0;for(var d=0;d<a.length;d++)n.push(a[d])}})),t.log(a+"after ads filtering"),{newCampaigns:n,installedCampaigns:r}}(n,o);return n=s.newCampaigns,r.resolve(s.installedCampaigns),o}return{filterByAppInstalled:function(e,n,i){if(i=i||[],!p((r=n).filterAppsInstalled,e))return d.returnResolvedPromise();for(var a={},o=e.length,s=[],l=0;l<o;l++){var c=e[l],u=t.AdUtils.getAdId(c),g=c&&c.ext,v=g&&g.appData;g&&v&&v.appId&&(0===i.length||-1===i.indexOf(g.type))&&(a[v.appId]||(a[v.appId]=[]),a[v.appId].push(u),-1===s.indexOf(v.appId)&&s.push(v.appId))}return f(e,a,s)},filterByAppInstalledOW:function(e,n){if(r=n,!p(!0,e))return d.returnResolvedPromise();for(var i={},a=e.length,o=[],s=0;s<a;s++){var l=e[s],c=t.AdUtils.getAdId(l),u=l.appData;u&&u.filterIfInstalled&&(u.appId&&(i[u.appId]||(i[u.appId]=[]),i[u.appId].push(c),-1===o.indexOf(u.appId)&&o.push(u.appId)))}return f(e,i,o)},checkIfAppInstallOnDevice:c}}},{}],40:[function(e,t,n){var i=e("../constants/featureCompatibilityMap");t.exports={CB:"NativeCallback",WebControls:"WebControls",RV:"RewardedVideo",Rewarded:"Rewarded",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",timeunit:6e4,closeAndBackDisabledTimer:1e4,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage",onAdVisibleFailed:"onAdVisible failed",screenVisibleTimeout:"Screen visible timeout",userClosedBeforeAdVisible:"userClosedBeforeAdVisible"},noFill:"We did not receive any campaigns in inventory"},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed",displayWebviewSuccess:"onDisplayWebviewSuccess",displayWebviewFailed:"onDisplayWebviewFailed:"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{Rewarded:"rewarded",RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{normal:0},baseDataKeys:["deviceId","controllerVersion","sdkVersion","deviceOs","deviceOsVersion","devicesizecategory","deviceOEM","deviceModel","browser","env","applicationId","applicationUserId","deviceApiLevel","usertype","appVersion","auid","platformABGroup","applicationKey","controllerbn","abTest","ett","lat","pluginType","productType","mediationType","SDKpluginType","bundleId","isOneFlow","isBiddingInstance","demandSourceName","demandSourceId","mediationABGroup","ismultipleadobjects","idfi"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone13,1","iPhone13,2","iPhone13,3","iPhone13,4","iPhone14,2","iPhone14,3","iPhone14,4","iPhone14,5"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896},type3:{width:390,height:844},type4:{width:428,height:926}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType","skd"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},xCodeData:{xCodeVersion:"xCodeVersion",xCodeBuildVersion:"xCodeBuildVersion",xCodeSdkName:"xCodeSdkName",xCodeSdkBuild:"xCodeSdkBuild"},abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraAppSDK5","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{RewardedVideo:"application",Interstitial:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{RewardedVideo:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^[789]/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//gw-rv.iads.unity3d.com/gateway/sdk/request",staging:"//staging-gw-rv.iads.unity3d.com/gateway/sdk/request"},IS:{production:"//gw-is.iads.unity3d.com/gateway/sdk/request/",staging:"//staging-gw-is.iads.unity3d.com/gateway/sdk/request/"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},adViewIdString:"adViewId",bannerAdViewId:"Banner.SupersonicAds",DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0,adTypes:{CPVI:"CPVI",customEndCard:"customEndCard",imageInterstitial:"imageInterstitial",MRAID:"MRAID",playableAd:"playableAd"},extraOffers:{minimalAndroidApiLevel:21,fetchTimeout:1e4,minimumAdsForExtraOffersInventory:2},viewableChangeReasons:{storeKitOpen:"storeKitOpen",storeKitClose:"storeKitClose"},storeKit:{minimalSupportedOSVersion:11,loadFailuresToPreventRetry:["Invalid Parameters","Unsupported Orientation"],loadingTimeoutMessage:"StoreKit load timeout"},authorizationStatus:"att",advertisingId:{invalidAdvertisingId:"00000000-0000-0000-0000-000000000000"},advertiserIdParamsToUpdate:["deviceIds[IFA]","deviceIds[IDFV]","isLimitAdTrackingEnabled","att","idfa","idfv","lat"],adPlayerDirectory:"ad-player",cacheAdsDirectory:"ads",numOfBannersToInitSuccess:"numOfBannersToInitSuccess",numOfBannersToCache:"numOfBannersToCache",cacheConfiguration:"cacheConfig",backgroundPatchLogicConfiguration:"backgroundPatchLogicConfiguration",shouldCacheMraidCreative:"shouldCacheMraidCreative",minBannerRefreshTime:9e3,defaultCacheConfig:{adLevelCache:!0,adLevelCacheGroup:156},isBNAutoRemove:"isBNAutoRemove",offScreenViewConfig:{maximalVersionToSupport:12.5},localStorageKeys:{idfi:"unityads-idfi"},androidIT:[83,97,102,101,68,75,87,101,98,65,112,112,73,110,116,101,114,102,97,99,101],iosIT:[115,97,102,101,100,107,82,101,115,67,111,108,108,101,99,116,105,111,110,70,117,110,99],noServerResponseCode:-1,controller:"controller"}},{"../constants/featureCompatibilityMap":134}],41:[function(e,t,n){t.exports=function(e,t,n){function i(e){return!(e?e.productType:null)}function r(e,t){return t=t||{},e&&e.demandSourceName?(t.demandSourceName=e.demandSourceName,t.demandSourceId=e.demandSourceId,t.isInAppBidding=e.isInAppBidding,t):t}return{isLegacy:i,extendCallbackParamsWithDemandConfig:r,extendCallbackParamsWithProductConfig:function(e,t){return t=r(e,t),e&&e.productType&&(t.productType=e.productType),t},extendCallbackParamsWithParentProductConfig:function(n,i){if(i=r(n,i),n&&n.productType){var a=t[n.productType];a&&(i.productType=e.Utils.isFunction(a.getProductType)?a.getProductType():n.productType)}return i},shouldReceiveMessage:function(e,t){return!(!e||!t)&&(!(!e.productType||!e.demandSourceName)&&(t.productType===e.productType&&(i(e)||t.demandSourceName===e.demandSourceName)))},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===n.RV&&(e.productType=n.IS),e}}}},{}],42:[function(e,t,n){t.exports={CB:"NativeCallback",deviceDataNativeFunction:"deviceDataAPI",getDeviceData:"getDeviceData",failCallback:"handleDeviceDataFailed",successCallback:"handleDeviceDataSuccess",sdkNotSupportedErrMsg:"DeviceDataService | module not supported by SDK",notInitiatedErrMsg:"DeviceDataService | module not initiated or not supported by SDK",alreadyInitiatedErrMsg:"DeviceDataService | init | module is already initiated",intervalAlreadySet:"DeviceDataService | _startPullingDataWithInterval | interval already set",notValidInterval:"DeviceDataService | _startPullingDataWithInterval | interval is not valid, must be higher than 15 seconds",minimumIntervalAllow:5}},{}],43:[function(e,t,n){t.exports=function(t,n){var i,r,a=e("./DeviceDataConstants"),o=e("../constants/featureCompatibilityMap"),s=!1,d={},l=!1;function c(){n.callSDKFunction(a.deviceDataNativeFunction,{deviceDataFunction:a.getDeviceData},a.successCallback,a.failCallback)}function u(e){var t=e&&e.errMsg?e.errMsg:"";n.log("DeviceDataService |  getDeviceData fail, params : "+JSON.stringify(e)+"with errorMessage: "+t)}function p(e){n.log("DeviceDataService |  getDeviceData success, params :"+JSON.stringify(e)),e&&(d=e)}function f(){s?(clearInterval(i),i=void 0):n.log(a.notInitiatedErrMsg)}function g(e){if(n.log("DeviceDataService | _startPullingDataWithInterval | interval:"+e),s){var t=function(e){var t=parseInt(e);if(isNaN(t))return-1;return t}(e);t<a.minimumIntervalAllow?n.log(a.notValidInterval):i?n.log(a.intervalAlreadySet):(r=t,i=setInterval(c,1e3*t))}else n.log(a.notInitiatedErrMsg)}return{init:function(e){if(n.isLegacy(o.pullingNativeDeviceData))n.log(a.sdkNotSupportedErrMsg);else if(s)n.log(a.alreadyInitiatedErrMsg);else{var i=n.SupplyConfigurations.getNetworkConfigValueByKey("pullingDeviceDataInterval")||n.getConfig().controllerConfig.pullingDeviceDataInterval||-1;t.PubSub.subscribe(a.CB+"."+a.successCallback,p),t.PubSub.subscribe(a.CB+"."+a.failCallback,u),t.PubSub.subscribe(a.CB+".enterBackground",(function(e){n.log("DeviceDataService | entered BG | should pause interval"),f()})),t.PubSub.subscribe(a.CB+".enterForeground",(function(e){n.log("DeviceDataService | entered FG | should resume interval"),g(r)})),e,c(),s=!0,g(i)}},getDeviceData:function(){return s||n.log(a.notInitiatedErrMsg),d},pullData:c,startPullingDataWithInterval:g,stopPullingData:f,setPullDataOnLoadAd:function(e){e&&!l&&(l=!0)},shouldPullDataOnLoadAd:function(){return l}}}},{"../constants/featureCompatibilityMap":134,"./DeviceDataConstants":42}],44:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.AdUtils,a=null;return{set:function(e){e&&e.productType===i.BN&&a&&a.productType!==i.BN?t.report(n.setAdDisplayAlreadyAdShown,{productType:e.productType,generalMessage:a.productType+" | "+e.productType}):a=e},get:function(){return a||null},reset:function(){a=null},getDisplayedAdType:function(){return a?a.productType:null},getDisplayedAdDemandName:function(){return a?a.demandSourceName:null},getDisplayedAdSettings:function(){return a?a.settings:null},getDisplayedAdStoreId:function(){return a&&a.ext&&a.ext.store&&a.ext.store.id?a.ext.store.id:null},isDisplayed:function(){return null!==a},isAdDisplayed:function(e){return a&&e&&r.getAdId(a)===r.getAdId(e)}}}},{}],45:[function(e,t,n){t.exports=function(e){var t={},n=e||{};return{getABTestConfiguration:function(e,i){var r=t[e]&&t[e].abtest&&t[e].abtest.default,a=t[e]&&t[e].abtest&&t[e].abtest[r]||{},o=t[e]&&t[e].abtest&&t[e].abtest[i]||{};return n.extend(!0,{},a,o)},setConfig:function(e){t=e||{}}}}},{}],46:[function(require,module,exports){function ExtraOffers(constants,fetcherService,environmentConfiguration){var minimumAdsForExtraOffersInventory=constants.extraOffers.minimumAdsForExtraOffersInventory,supportedProductTypes=[constants.RV,constants.IS],supportedAdTypes=[constants.adTypes.CPVI,constants.adTypes.customEndCard,constants.adTypes.imageInterstitial];function _isEnabled(e){return!!(e&&e.extraOffers&&e.extraOffers.enabled)}function _isProductTypeSupported(e){return-1!==supportedProductTypes.indexOf(e)}function _isAdTypeSupported(e){return-1!==supportedAdTypes.indexOf(e)}function _isSupported(e,t,n,i){return!(e===constants.deviceOs.android&&t<constants.extraOffers.minimalAndroidApiLevel)&&(_isEnabled(i)&&_isProductTypeSupported(n.productType)&&_isAdTypeSupported(n.ext.type))}function _fetchExtraOffersInventory(e,t,n,i,r){var a=_buildRequiredDataForExtraOffersRequest(t,n,i,r);e=window.SSA_CORE.Utils.extend(!0,{},e,a);var o=new jQuery.Deferred;return fetcherService.fetchFeed(environmentConfiguration().getConfig().schema+constants.gatewayDestinationMap.BN.production,e,constants.extraOffers.fetchTimeout).done((function(e){if(_isInvalidExtraOffersResponse(e))o.reject(e.errorCode.toString());else if(_isInventoryEligible(e))o.resolve(e);else{var t="Invalid extra offers inventory, length: "+e.seatbid.bid.length;o.reject(t)}})).fail((function(e,t){o.reject(t)})),o.promise()}function _isInvalidExtraOffersResponse(e){return!(!e||!e.hasOwnProperty("errorCode"))}function _buildRequiredDataForExtraOffersRequest(e,t,n,i){return{extraOffers:!0,currProductType:e||"",blacklistedCampaigns:t||"",currReqId:n||"",currOppId:i||""}}function _isInventoryEligible(e){return!!(e&&e.seatbid&&e.seatbid.bid&&e.seatbid.bid.length>=minimumAdsForExtraOffersInventory)}function _test(){var re=/(\(\))$/,args=[].slice.call(arguments),name=args.shift(),is_method=re.test(name),target;return name=name.replace(re,""),target=eval(name),is_method?target.apply(this,args):target}return{isSupported:_isSupported,fetchExtraOffersInventory:_fetchExtraOffersInventory,test:_test}}module.exports=ExtraOffers},{}],47:[function(e,t,n){t.exports=function(e){return{isFeatureSupportedInNativeSDK:function(t){var n=!1;return t&&e&&e.nativeFeatures&&(n=Array.isArray(e.nativeFeatures)&&e.nativeFeatures.indexOf(t)>-1),n}}}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,i="eventResult",r="resultReason",a={hit:1,miss:2};function o(o){function s(e,t){if(!e)return"";if(t)for(var n=t.length,i=0;i<n;i++)e=e.replace("{{"+t[i].key+"}}",encodeURIComponent(t[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}function d(i,r){var a,o=n[i];if("object"==typeof o){o.length>0&&(o=o[0]);var d=function(e,t){var n;return e&&e.url&&(n={url:s(e.url,t),type:e.type}),n}(o,r);d&&(a=d,t.firePixel(a),e.log("Send event: "+JSON.stringify(a),e.LogLevels.info))}}return n=o,{track:function(e){var t;if(e&&n)switch(e.trackingType){case"request":d("requestTracking",null);break;case"responseHit":d("responseTracking",[{key:i,value:a.hit}]);break;case"responseMiss":t=e.data,d("responseTracking",[{key:i,value:a.miss},{key:r,value:t}])}}}}return{init:function(e){return new o(e)}}}},{}],49:[function(e,t,n){t.exports=function(){var e=[];return{addToFilteredListCampaigns:function(t){t&&-1===e.indexOf(t)&&e.push(t)},getFilteredListCampaigns:function(){return e}}}},{}],50:[function(e,t,n){t.exports=function(e){function t(){return document.getElementById("displayedFrame")}return{getDisplayedAdFrame:t,isFrameDisplayed:function(e){var n=t();return e&&n&&e===n},getAdUnitClassObj:function(t){var n="ssaAdUnit",i={class:n+" ",selector:"."+n};return t&&t.productType?(i.class+=t.productType+" ",i.selector+="."+t.productType,t.demandSourceName&&(i.class+=t.demandSourceName+" ",i.selector+="."+t.demandSourceName),i):(e.log("In getAdUnitClass with no ad",e.LogLevels.error),i)},hideFrame:function(){var e=t();e&&e.classList.add("hidden")},displayFrame:function(){var e=t();e&&e.classList.remove("hidden")}}}},{}],51:[function(e,t,n){t.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],52:[function(e,t,n){t.exports=function(t,n,i){var r=e("./GDPRConstants.js"),a=!1,o=i.CB;function s(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(n.getConfig().applicationSettings.consent=e)}return{init:function(){a||(t.PubSub.subscribe(o+r.NativeAPI.updateConsentInfo,(function(e){if(e&&e.gdprConsentStatus)return n.log("updateConsentInfo | controller | params: "+JSON.stringify(e),n.LogLevels.info),void s(e.gdprConsentStatus);n.log("updateConsentInfo | controller | without params or gdprConsentStatus key",n.LogLevels.info)})),a=!0)},setConsent:s,getConsent:function(){return n.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":51}],53:[function(e,t,n){function i(e,t){var n="NativeCallback",i=!1,r=[],a={GET:"GET",POST:"POST"},o={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function s(){var i=["identifier","status"];e.PubSub.subscribe(n+".httpRequestStatusChanged",(function(e){t.checkRequiredCallbackParams(i,e,"httpRequestStatusChanged").didSucceed&&d(e)}))}function d(e){t.log("HTTPService - request status changed",t.LogLevels.verbose);var n=f(e.identifier);if(n)if(e.status===o.requestStarted)l(n);else if(e.status===o.responseReceived){var i={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0};c(n,e.data?decodeURIComponent(e.data):void 0,i)}else u(n,e.errMsg)}function l(n){t.log("onRequestStarted "+n.identifier,t.LogLevels.verbose),e.Utils.isFunction(n.onRequestStarted)&&n.onRequestStarted()}function c(n,i,r){t.log("_onResponseReceived "+n.identifier,t.LogLevels.verbose),p(n),e.Utils.isFunction(n.onResponseReceived)&&n.onResponseReceived(i,r)}function u(n,i){t.log("onRequestError "+i,t.LogLevels.verbose),p(n),e.Utils.isFunction(n.onRequestError)&&n.onRequestError(i)}function p(e){if(e){var t=r.indexOf(e);t>-1&&r.splice(t,1)}}function f(e){var t=r.filter((function(t){return t.identifier===e}));return 1===t.length?t[0]:null}function g(){return+new Date+""+Math.random()}function v(e){return i&&!1!==e.allowNative}function m(t,n){return n=e.Utils.extend(n,{url:t},{identifier:g()}),e.Utils.isDefined(n.background)||(n.background=!1),n}function h(n){t.log("_sendNativeEngineRequest",t.LogLevels.verbose);var i={};e.Utils.each(n,(function(t,n){if(!e.Utils.isFunction(n)){var r={};r[t]=n,i=e.Utils.extend(i,r)}})),t.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function b(e){var n;t.log("_sendWebEngineRequest",t.LogLevels.verbose);var i=e;l(e);var r=function(t,n){var i={headers:t.getAllResponseHeaders(),statusCode:t.status,ranOnNative:!1};c(e,n,i)},a=jQuery.ajax(i);a.done((function(e,t,n){var i=n.responseText;r(n,i)})),a.fail((function(t,i,a){n=a,0===t.status?u(e,n&&""!==n?n:"unknown error"):r(t)}))}function S(e){r.push(e),v(e)?h(e):b(e)}function y(e,t){t||(t={}),t.type=a.GET,S(m(e,t))}function A(){return i}function C(){i=!0,s()}var I={GETRequest:y,getIsNativeEngineExist:A,init:C};return I}t.exports=i},{}],54:[function(e,t,n){var i=e("./containers/ContainerCreationStateHandler");t.exports=function(e,t,n,r){var a="IframeManager | ",o=e.AdUtils;function s(t,n,i,r){o.extendAdObjectWithConfig(n,t,i,r),e.getNotchService().onSetConfig(t)&&(m("Extend ad object isTransparentLayout=true"),t.settings.isTransparentLayout=!0),e.RingerSwitchService.isInitiated()&&(m("Extend ad object ringerMuteOnStart=true"),t.settings.ringerMuteOnStart=!0)}function d(e){return document.querySelector('[data-ad-view-id="'+e.adViewId+'"]')}function l(e,t,i,r){m("createAndLoadAdFrame"),s(e,t,i,r),function(e){e.adViewId=o.generateUniqueAdId(e)}(e),d(e)||function(e,t){var i=e.adViewId;m("loading ad to frame: "+i+" "+e.productType);var r=n.getAdUnitClassObj(e).class;t&&(r+="hidden ");var a=document.createElement("iframe");a.setAttribute("src",e.url),r.trim().split(/\s+/).forEach((function(e){a.classList.add(e)})),a.dataset.adViewId=i,a.dataset.close="true",document.body.append(a)}(e,r.preload)}function c(e){var t=!!d(e);return m("isContainerLoaded: "+t),t}function u(){document.getElementById("ssaLoaderWrap").classList.add("hidden")}function p(e,t,n,i){u(),n(!1),r.set(t),e.classList.remove("hidden"),e.setAttribute("id","displayedFrame"),i()}function f(t,n,i,r){"true"!==t.dataset.loaded?(i(!0),e.log(a+"display with loader, frame "+t.id),n&&n.productType&&(g(n.productType),t.setAttribute("id","displayedFrame"))):p(t,n,i,r)}function g(e,t){document.getElementById("ssaLoaderWrap").classList.remove("hidden")}function v(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}function m(t){e.log(a+t)}return{createAndLoadAdFrame:l,updateAdUnitUrl:function(t,n,i,r){var o;s(t,n,i,r),(o=d(t))?(m("updated iframe url for product "+i.productType),o.src=t.url):r.forceCreation?(m("cannot find iframe to update, creating new one"),l(t,n,i,r)):e.log(a+"cannot find iframe to update url")},displayAdView:function(e,t,n,i){var a=d(e);"true"===a.dataset.loaded?(m("display frame"),window.jQuery.when(i(e,!1)).done((function(){p(a,e,t,n)})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)}))):(m("display frame with loader"),r.set(e),window.jQuery.when(i(e,true)).done((function(){f(a,e,t,n)})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)})))},handleScreenVisible:function(e,t){e&&g(t.productType);var i=n.getDisplayedAdFrame();i&&(m("ad unit open error"),i.classList.add("hidden"),i.removeAttribute("id"))},unloadAdView:function(e){var t=e.adViewId;m("unloading ad from frame | id:"+t+" pt: "+e.productType);var n=document.querySelector('[data-ad-view-id="'+t+'"]');n&&(e.engaged&&n.removeAttribute("id"),n&&n.parentNode&&n.parentNode.removeChild(n))},displayLoader:g,hideLoader:u,hideView:n.hideFrame,displayView:n.displayFrame,isContainerLoaded:c,onAdUnitLoaded:function(t,i,r){var a=d(t);if(a)if("true"!==a.dataset.loaded){a.dataset.loaded="true";var o=n.isFrameDisplayed(a);m("ad loaded: "+e.AdUtils.getAdId(t)+" | "+o?"frame Displayed: true":"frame Displayed: false|"+n.getAdUnitClassObj(t).selector),o&&p(a,t,i,r)}else m("already received the loaded event for frame")},getAdViewByAd:d,sendMessageToDisplayedAdView:function(e){var t=n.getDisplayedAdFrame();t&&v(JSON.stringify(e),"*",t.contentWindow)},sendMessageToAllAdViews:function(e){document.querySelectorAll(".ssaAdUnit").forEach((function(t){v(JSON.stringify(e),"*",t.contentWindow)}))},getDisplayedAdView:n.getDisplayedAdFrame,isViewDisplayed:n.isFrameDisplayed,getContainerID:function(){return"1"},getContainerCreationHandler:function(t){m("_getContainerCreationHandler: ");var n=new i(e.log),r=n.getCreationStates(),a=c(t)?r.createdSuccessfully:r.notCreated;return n.setState(a),n}}}},{"./containers/ContainerCreationStateHandler":111}],55:[function(e,t,n){t.exports=function(e){var t=[];function n(e){return function(t){return t&&t.productType===e}}function i(e){return function(t){return t.demandSourceName===d(e)&&t.productType===e.productType}}function r(e){var n=0,r=t.filter(i(e));return r.length>0&&(n=r[0].counter),n}function a(e){for(var t=0,n=0;n<e.length;n++){t+=e[n].counter}return t}function o(e){return a(t.filter(n(e)))}function s(e){return a(t.filter(n(e)).filter((function(e){return e&&function(e){return!0===e.isBiddingInstance}(e)})))}function d(e){return e.originalDemandSourceName||e.demandSourceName}function l(e){var n,r=t.filter(i(e));return n=r.length>0?r[0]:function(e){var n={demandSourceName:d(e),productType:e.productType,isBiddingInstance:e.isInAppBidding,counter:0};return t.push(n),n}(e),n}return{getTotalImpressionsByProduct:o,getTokenCounters:function(){return{biddingRVImpressions:s(e.RV),biddingISImpressions:s(e.IS),totalRVSessionImpressions:o(e.RV),totalISSessionImpressions:o(e.IS)}},getPayloadCounters:function(t){return{instanceImpressions:r(t),totalRVSessionImpressions:o(e.RV),totalISSessionImpressions:o(e.IS)}},increaseImpressionsCounterByInstanceParams:function(e){var t=l(e);t&&t.counter++}}}},{}],56:[function(e,t,n){"use strict";var i,r,a;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.InlineStoreLaunched="inlineStoreLaunched",e.InlineStoreFailed="inlineStoreFailed",e.InlineStoreActivityLaunched="inlineStoreActivityLaunched",e.InlineStoreActivityFailed="inlineStoreActivityFailed",e.InlineStoreClosed="inlineStoreClosed",e.InlineStoreDestroyed="inlineStoreDestroyed",e.InlineStoreDestroyFailed="inlineStoreDestroyFailed"}(i||(i={})),function(e){e.DestroyInlineStore="DestroyInlineStore",e.OpenInlineStore="OpenInlineStore"}(r||(r={})),function(e){e.DestroyInlineStore="destroyInlineStore",e.OpenInlineStore="openInlineStore"}(a||(a={}));t.exports=class{constructor(t,n,i){this.core=t,this.controller=n,this.analytics=i,this.analyticsCategories=new(e("../modules/DemandSource/EventCategories")),this.handlers=[],this.CB="NativeCallback",this.PLAYER_MESSAGE_PREFIX="SDKController"}init(){const e=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreLaunched}`,this.onInlineStoreLaunched.bind(this)),t=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreFailed}`,this.onInlineStoreFailed.bind(this)),n=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreActivityLaunched}`,this.onInlineStoreActivityLaunched.bind(this)),a=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreActivityFailed}`,this.onInlineStoreActivityFailed.bind(this)),o=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreClosed}`,this.onInlineStoreClosed.bind(this)),s=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreDestroyed}`,this.onInlineStoreDestroyed.bind(this)),d=this.core.PubSub.subscribe(`${this.CB}.${i.InlineStoreDestroyFailed}`,this.onInlineStoreDestroyFailed.bind(this)),l=this.core.PubSub.subscribe(`${this.PLAYER_MESSAGE_PREFIX}.${r.OpenInlineStore}`,this.openInlineStore.bind(this)),c=this.core.PubSub.subscribe(`${this.PLAYER_MESSAGE_PREFIX}.${r.DestroyInlineStore}`,this.destroyInlineStore.bind(this));this.handlers.push(e,t,n,a,o,s,d,l,c)}clearListeners(){this.core.PubSub.clearHandlers(this.handlers)}sendAnalyticsEvent(e,t={}){try{this.analytics.report(e,t)}catch(t){this.controller.log(`Failed to send inline store analytics event: ${e.name}, error: ${t}`)}}onInlineStoreLaunched(){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreLaunched),this.controller.postAdUnitEvent({name:i.InlineStoreLaunched})}onInlineStoreFailed(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreFailed,{generalmessage:e.url,callfailreason:e.errMsg,custom_b:e.strategy}),this.controller.postAdUnitEvent({name:i.InlineStoreFailed,params:e})}onInlineStoreActivityLaunched(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreActivityLaunched,{generalmessage:e.url,custom_b:e.strategy}),this.controller.postAdUnitEvent({name:i.InlineStoreActivityLaunched,params:e})}onInlineStoreActivityFailed(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreActivityFailed,{callfailreason:e.errMsg}),this.controller.postAdUnitEvent({name:i.InlineStoreActivityFailed,params:e})}onInlineStoreClosed(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreClosed,{generalmessage:e.resultCode,custom_b:e.destroyCalled}),this.controller.postAdUnitEvent({name:i.InlineStoreClosed,params:e})}onInlineStoreDestroyed(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreDestroyed,{custom_b:e.strategy})}onInlineStoreDestroyFailed(e){this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreDestroyFailed,{callfailreason:e.errMsg,custom_b:e.strategy})}destroyInlineStore(e){this.controller.callSDKFunction(a.DestroyInlineStore,e,i.InlineStoreDestroyed,i.InlineStoreDestroyFailed)}openInlineStore(e){var t;if(!e.url||void 0===e.strategy||!e.storePackage||!(null===(t=e.intentExtras)||void 0===t?void 0:t.callerId))return void this.sendAnalyticsEvent(this.analyticsCategories.inlineStoreMissingParams,{generalmessage:JSON.stringify(e)});const n=0===e.strategy?i.InlineStoreActivityLaunched:i.InlineStoreLaunched,r=0===e.strategy?i.InlineStoreActivityFailed:i.InlineStoreFailed;this.controller.callSDKFunction(a.OpenInlineStore,e,n,r)}}},{"../modules/DemandSource/EventCategories":162}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e("./Constants");t.exports=function(e,t){return{getUrlToCdn:function(e){var n=t.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==t.getEnv()&&(n=t.api()+"/users/staging/"+window.SuperSonicGlobalConfig.mobileSDKSettings.env),n}}}},{"./Constants":40}],58:[function(e,t,n){function i(e){var t=e,n=[],i=-1;function r(){return n.length}function a(){return n}function o(e){Array.isArray(e)&&(i=0,n=e)}function s(){return n[i]}function d(e){var t,a=u(e);return a>-1&&(t=n.splice(a,1)[0])&&(f()?i=-1:i<a?i=(i+1)%r():i>a&&i--),t}function l(e){var t=u(e);if(t>-1)return n[t]}function c(e,t){var i=u(t);if(i>-1)return n[i]=e,n[i]}function u(e){if(void 0===e)return-1;for(var t=0,i=r(),a=e.toString();t<i&&e;t++)if(n[t].id===a)return t;return-1}function p(){return!f()&&(i+1)%r()!==i}function f(){return 0===r()}function g(){n=[],i=-1}var v={getOffers:a,getCurrentOffer:s,getOfferById:l,setOffers:o,removeOfferById:d,replaceOfferById:c,isNextOfferAvailable:p,isEmpty:f,size:r,reset:g};return v}t.exports=i},{}],59:[function(e,t,n){t.exports=function(e,t){function n(e,t,n){e&&e.removeEventListener(t,n)}return{unbind:n,bind:function(e,t,i){e&&(n(e,t,i),e.addEventListener(t,i))},scrollTop:function(e,n){if(void 0===n)return e.pageYOffset;e===t||9===e.nodeType?e.scrollTo(e.scrollX,n):e.pageYOffset=n},fadeIn:function(e,t){if(e)var n=0,i=setInterval((function(){n<.99?(n+=.11,e.style.opacity=n):(clearInterval(i),e.style.opacity=100)}),t/10)},fadeOut:function(e,t,n){if(e)var i=1,r=setInterval((function(){i>.0101?(i-=.11,e.style.opacity=i):(clearInterval(r),e.style.opacity=0,"function"==typeof n&&n())}),t/10)}}}},{}],60:[function(e,t,n){t.exports=function(e,t){var n,i;function r(e){return i&&e===t.IS}return{setLastDisplayedAdCampaignId:function(e,t,a){i=a&&a.sendLastCampaignId,r(t)&&(n=e)},getLastDisplayedAdCampaignId:function(){return n},shouldAddLastDisplayedAdCampaignIdToPayload:r}}},{}],61:[function(e,t,n){"use strict";var i=e("tslib"),r=e("./NativeLifeCycleEventsConstants");t.exports=class{constructor(e,t){this.nativeGetDataFunction="getUserData",this.successCallback="getUserDataSuccess",this.failCallback="getUserDataFailed",this.controller=e,this.core=t}get(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const i=this.core.PubSub.subscribe(`${r.CB}.${this.successCallback}`,(n=>{this.core.PubSub.unsubscribe(i),t(n[e])})),a=this.core.PubSub.subscribe(`${r.CB}.${this.failCallback}`,(e=>{this.core.PubSub.unsubscribe(a),n(e)}));this.controller.callSDKFunction(this.nativeGetDataFunction,{key:e},this.successCallback,this.failCallback)}))}))}}},{"./NativeLifeCycleEventsConstants":68,tslib:25}],62:[function(e,t,n){function i(e){var t,n,i,r,a,o,s="acknowledgeMessage",d={none:0,error:1,info:2,verbose:3},l={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function c(t,n){var r=e.isDefined(t)?t:"Controller",a=e.isDefined(n)?l[n]:l[i];return i?"SupersonicAds "+r+" ["+a+"] :":""}function u(d,l,u){var p,f;(window.productionDebug&&o&&o({url:"http://iron-debug-controller.com?log="+d,type:"pixel"}),l&&l>i)||(e.isString(d)||(d=JSON.stringify(d)),e.isFunction(n)&&("android"===t||e.isWebWrapper())?n.call(a,c(u,l)+d):"android"!==t&&(p=c(u,l)+d,(f={eventName:"log",prefix:"logmessage"}).parameters={message:p,acknowledgeWith:s,declineWith:"errorTest"},r&&r.postMessage(f)))}return{init:function(e,s,l,c){a=window.console||{},t=e,i=l,r=s,o=c,l?(n=a.log,a.log=function(e){u(e,d.verbose)}):a.log=function(){}},log:u,debugMsg:c,LogLevels:d,DebugLevels:l}}var r;t.exports=function(e){return r||(r=new i(e)),r}},{}],63:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MraidCreativeLoadStrategy=void 0;var i=e("../types");const r=new(e("../modules/DemandSource/EventCategories"));var a;n.MraidCreativeLoadStrategy=a,function(e){e.Cache="cache",e.Fetch="fetch",e.None="none"}(a||(n.MraidCreativeLoadStrategy=a={}));t.exports={MraidCreativeService:class{constructor(e,t,n,i,r){this.core=e,this.controller=t,this.jQuery=n,this.analytics=i,this.loadStrategy=r,this.startTime=0}updateAdWithMraidCreative(e){if(!e||!e.length)return;const t=null==e?void 0:e[0],n=t.ext.type===i.AdType.PlayableAd||t.ext.type===i.AdType.VpaidWrapper;switch(this.loadStrategy){case a.None:case a.Cache:break;case a.Fetch:return this.fetchMraidCreative(t,n)}}fetchMraidCreative(e,t){if(!this.shouldFetchCreative(e))return this.core.Utils.returnResolvedPromise();const n=this.jQuery.Deferred(),i=this.getMraidUrl(t,e.ext),r={allowNative:!1,background:!0,retries:3,onResponseReceived:i=>this.onCreativeFetched(e,n,t,i),onRequestError:e=>this.onCreativeFetchError(n,e)};return this.startTime=Date.now(),this.controller.HTTPService.GETRequest(i,r),n}shouldFetchCreative(e){var t,n,i;return this.loadStrategy===a.Fetch&&(!!(null===(n=null===(t=e.ext.videoData)||void 0===t?void 0:t.videoSource)||void 0===n?void 0:n.mraidUrl)||!!(null===(i=e.ext.layoutData)||void 0===i?void 0:i.mraidUrl))}onCreativeFetched(e,t,n,i){i||(this.analytics.report(r.mraidCreativeFetchFailed,{custom_b:Date.now()-this.startTime,generalmessage:"Empty response"}),t.reject("Unable to fetch mraid creative - missing response")),n?e.ext.videoData.videoSource.mraid=i:e.ext.layoutData.mraid=i,this.analytics.report(r.mraidCreativeFetchSuccess,{custom_b:Date.now()-this.startTime}),t.resolve()}onCreativeFetchError(e,t){this.analytics.report(r.mraidCreativeFetchFailed,{custom_b:Date.now()-this.startTime,generalmessage:t}),e.reject("Unable to fetch mraid creative - fetch error")}getMraidUrl(e,t){return e?t.videoData.videoSource.mraidUrl:t.layoutData.mraidUrl}},MraidCreativeLoadStrategy:a}},{"../modules/DemandSource/EventCategories":162,"../types":229}],64:[function(e,t,n){function i(){var e,t={init:function(e,t,n){return this.receiveMessage((function(n){t.call(e,n)}),n),this},postMessage:function(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(t,n){t&&(e=function(e){"string"==typeof n&&e.origin!==n||"[object Function]"===Object.prototype.toString.call(n)&&!1===n(e.origin)||("function"!=typeof n||n(e.data))&&t(e)}),window.addEventListener?window[t?"addEventListener":"removeEventListener"]("message",e,!1):window[t?"attachEvent":"detachEvent"]("onmessage",e)}};return t}t.exports=i},{}],65:[function(e,t,n){t.exports=function(){const e=new Set;return{getActiveAdFormats:function(){return{ismao:Array.from(e)}},setActiveAdFormat:function(t){if(t&&"string"==typeof t){let n=t.charAt(0).toLowerCase()+t.slice(1);e.add(n)}}}}},{}],66:[function(e,t,n){function i(){var t=e("./Inventory.js"),n={},i=[],r,a;function o(){a=4}function s(){if(I())return Math.max(1,r-1)}function d(){if(0!==Object.keys(n).length)return n[s()]}function l(e){return I()&&w()?e?n[e].size():n[s()].size():0}function c(e){return I()&&w()?e?n[e].getOffers():n[s()].getOffers():[]}function u(){Array.isArray(i)&&i.length>a&&delete n[i.shift()]}function p(e,t){if(Array.isArray(e)&&0!==e.length){var i=void 0!==t?t:C();void 0===n[i]&&(i=C());for(var r=0;r<e.length;r++)e[r].inventoryId=i;return n[i].setOffers(e),i}}function f(e){if(I()&&w())return e?n[e].getCurrentOffer():n[s()].getCurrentOffer()}function g(e,t){if(I()&&w())return t?n[t].removeOfferById(e):n[s()].removeOfferById(e)}function v(e,t){if(I()&&w())return t?n[t].getOfferById(e):n[s()].getOfferById(e)}function m(e,t,i){if(I()&&w())return i?n[i].replaceOfferById(e,t):n[s()].replaceOfferById(e,t)}function h(e){return!(!I()||!w())&&(e?n[e].isNextOfferAvailable():n[s()].isNextOfferAvailable())}function b(e){return!I()||!w()||(e?n[e].isEmpty():n[s()].isEmpty())}function S(){i=[],n={},r=void 0}function y(e){var t=void 0!==e?e:s();t&&n[t]&&delete n[t]}function A(){return n}function C(){return n[r=r||1]=new t(r),i.push(r),r++,u(),r-1}function I(){return 0!==i.length&&void 0!==r}function w(){return void 0!==n[s()]}function D(){return a}function P(){return r}o();var F={getOffers:c,getCurrentOffer:f,getOfferById:v,setOffers:p,removeOfferById:g,replaceOfferById:m,isNextOfferAvailable:h,isEmpty:b,size:l,reset:S,getActiveInventoryId:s,getActiveInventory:d,removeInventory:y,getInventories:A,getAmountOfInventoriesAllowed:D,getAvailableInventoryId:P};return F}t.exports=i},{"./Inventory.js":58}],67:[function(e,t,n){t.exports=function(e,t,n){var i={successCallbackPrefix:"scallback_",failureCallbackPrefix:"fcallback_",ssaSchemePrefix:"supersonicads",acknowledgeMessage:"acknowledgeMessage",CB:"NativeCallback"};function r(r,a,o,s){if(t.Utils.isString(r)&&""!==r&&e){e.DemandUtils&&e.RewardedVideo&&a&&(a=e.DemandUtils.setManualRewardedVideoTypeForNative(a));var d=t.Utils.isDefined(o)&&t.Utils.isString(o)?o:"",l=t.Utils.isDefined(s)&&t.Utils.isString(s)?s:"";!function(e,r,a){e.prefix=i.ssaSchemePrefix,t.Utils.isDefined(e.parameters)||(e.parameters={});e.parameters=t.Utils.extend(e.parameters,{acknowledgeWith:t.Utils.isDefined(r)?r:i.acknowledgeMessage,declineWith:t.Utils.isDefined(a)?a:"errorTest"}),n.postMessage(e)}({eventName:r,parameters:t.Utils.extend({success:d,fail:l},a)})}}function a(){return Date.now()+""+Math.random()}return{callSDKFunction:r,callSDKService:function(e,t,n,i,a){n&&(n.functionName=t),r(e,n,i,a)},callSDKFunctionWithCallback:function(n,o,s,d){if(e.log("NativeAPIAdapter | _callSDKFunctionWithCallback | Native API: "+n),t.Utils.isFunction(s)||t.Utils.isFunction(d)){var l=i.successCallbackPrefix+a(),c=i.failureCallbackPrefix+a(),u=t.PubSub.subscribe(i.CB+"."+l,(function(e){t.PubSub.unsubscribe(u),t.PubSub.unsubscribe(p),s(e)})),p=t.PubSub.subscribe(i.CB+"."+c,(function(i){e.log("NativeAPIAdapter | callSDKFunctionWithCallback | received failure callback for function: "+c),i&&i.errMsg&&e.log("Error calling "+n,e.LogLevels.error),t.PubSub.unsubscribe(p),t.PubSub.unsubscribe(u),d(i)}));r(n,o,l,c)}else e.log("NativeAPIAdapter | failed to call sdk function - no callbacks parameters")},acknowledgeMessage:function(e){n.acknowledgeMessage(e)}}}},{}],68:[function(e,t,n){t.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onResume:"onResume",onPause:"onPause",onStop:"onStop",onDestroy:"onDestroy"}}},{}],69:[function(e,t,n){t.exports=function(t,n,i){var r="LifeCycleEventsService | ",a=e("./NativeLifeCycleEventsConstants.js"),o=[],s=new(e("./AndroidLifeCycleEventHandlers.js"))(t,n);function d(){t.PubSub.subscribe(a.CB+"."+a.NativeAPI.onNativeLifeCycleEvent,(function(e){n.log(r+"received new event: "+JSON.stringify(e)),e&&function(e,t){if(!l(e))return;s.publishEvent(e,t)}(e.lifeCycleEvent,e)}))}function l(e){return e&&o.indexOf(e)>-1}return{init:function(){d()},startNotify:function(e){n.log(r+"startNotify | event: "+e),l(e)||o.push(e)},stopNotify:function(e){n.log(r+"stopNotify | event: "+e),l(e)&&o.splice(o.indexOf(e),1)}}}},{"./AndroidLifeCycleEventHandlers.js":31,"./NativeLifeCycleEventsConstants.js":68}],70:[function(e,t,n){t.exports=function(t){return{create:function(n){var i=n.deviceOs;return i===t.deviceOs.ios&&null===n.safeAreaInsets?new(e("../patches/PatchesIphoneX.js"))(n,t):new(e("./NotchService.js"))(n.safeAreaInsets,t,i)}}}},{"../patches/PatchesIphoneX.js":223,"./NotchService.js":71}],71:[function(e,t,n){t.exports=function(e,t,n){var i=!1;function r(){return n!==t.deviceOs.android&&i}return function(){if(n===t.deviceOs.android)return;var r=t.notchSettings.safeAreaInsetsMin;i=e.top>r||e.bottom>r||e.right>r||e.left>r}(),{hasNotch:r,onEngageEnd:function(){n!==t.deviceOs.android&&r()&&0},onSetConfig:function(e){return n!==t.deviceOs.android&&(r()&&function(e){return e.settings&&e.settings.standaloneView}(e))},className:"NotchService"}}},{}],72:[function(e,t,n){t.exports={omidControllerFunction:"omidAPIController",omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",getOmidDataSuccessKey:"omidGetDataSuccess",getOmidDataFailKey:"omidGetDataFail",startSession:"startSession",finishSession:"finishSession",impressionOccurred:"impressionOccurred",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidAdIdNotFound:" omidParams no contain adViewId. ",omidPromiseIsPending:"promise is still pending",omidStartSessionAlreadyStarted:"omid ad session is already started",omidFinishSessionAlreadyCalled:"finish session already called",omidSessionNotStarted:"session not started",omidProductTypeNotSupported:" omidParams container unsupported product type = ",omidproductTypeNotFound:" omidParams no contain product type. ",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0","1.3.12-Ironsrc":"1.3.12","1.4.0-Ironsrc":"1.4.0","1.4.2-Ironsrc":"1.4.2","1.5.2-Ironsrc":"1.5.2","1.5.7-Ironsrc":"1.5.7",default:"1.0.0"},omidVersionRequiresWebviewPerAd:{"1.2.22-Ironsrc":!1,"1.3.12-Ironsrc":!0,"1.4.0-Ironsrc":!0,"1.4.2-Ironsrc":!0,"1.5.2-Ironsrc":!0,"1.5.7-Ironsrc":!0,default:!1},omidVersionIsControllerDownloadOMSDK:{"1.2.22-Ironsrc":!0,"1.3.12-Ironsrc":!1,"1.4.0-Ironsrc":!1,"1.4.2-Ironsrc":!1,"1.5.2-Ironsrc":!1,"1.5.7-Ironsrc":!1,default:!1}}},{}],73:[function(e,t,n){e("./OMIDConstants");t.exports=function(t,n){var i,r=e("./OmidHelper"),a=e("./OmidAdSession"),o=new r(t,n),s=e("./Constants.js"),d=e("./OMIDConstants"),l=!1,c="",u=s.omidPartnerVersion,p="",f="",g=null,v=null,m=null,h={};function b(){if(!l){if(v&&"pending"===v.state())return v;v=new window.jQuery.Deferred,n.log("OMIDService - activate",n.LogLevels.verbose);var e=t.PubSub.subscribe(s.CB+"."+d.activateSuccessKey,(function(g){c=g&&g.omidVersion?g.omidVersion:"",u=g&&g.omidPartnerVersion?g.omidPartnerVersion:s.omidPartnerVersion,l=!0,t.PubSub.clearHandlers([e,r]),t.PubSub.subscribe("SDKController.OMIDStartSession",(function(e){!o.isSupportingMultipleAdSession()&&e.adViewId&&(e.webViewid=e.adViewId),function(e){o.fireNonFailureEvent("SDKController.onOmidStartSessionRequired",e,c);var i=new window.jQuery.Deferred,r=o.isActivated(C(),l,d.startSession,c);if(!r.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[r.reason]),i.reject(r.reason);var s=o.validateStartSessionParams(e,c);if(!s.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[s.reason]),i.reject(s.reason);var u=o.validateAdViewId(e,d.impressionOccurred,c);if(!u.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[u.reason]),i.reject(u.reason),i;var p=e&&e.adViewId,f=h[p],g="";f&&"pending"===f.getStartPromise().state()?(g=o.getErrorMsgPromiseIsPending(d.startSession,c,e),t.PubSub.publish("SDKController.onOmidServiceFailure",[g]),f.getStartPromise()):f&&f.isSessionStarted()?(g=o.getErrorStartSessionAlreadyStarted(d.startSession,c,e),t.PubSub.publish("SDKController.onOmidServiceFailure",[g]),t.Utils.returnRejectedPromise(g)):function(e,t,i,r){n.log("OMIDService - startSession",n.LogLevels.verbose);var s=new a(t,e);!o.isSupportingMultipleAdSession()&&r.webViewid&&(s.setWebViewId(r.webViewid),r.adViewId=s.webViewId),h[e]=s,s.setStartPromise(i),n.callSDKFunction(d.omidNativeFunction,{omidFunction:d.startSession,omidParams:r},d.startSessionSuccessKey,d.startSessionFailKey),s.getStartPromise()}(p,e.productType,i,e)}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe("SDKController.OMIDImpressionOccurred",(function(e){!function(e){var i=new window.jQuery.Deferred,r=o.isActivated(C(),l,d.impressionOccurred,c);if(!r.result)return i.reject(r.reason),i;var a=y(e,d.impressionOccurred,c);if(!a.adSession)return t.PubSub.publish("SDKController.onOmidServiceFailure",[a.reason]),i.reject(a.reason),i;var s=a.adSession;if(s.getImpressionPromise()&&"pending"===s.getImpressionPromise().state()){var u=o.getErrorMsgPromiseIsPending(d.impressionOccurred,c,e);return t.PubSub.publish("SDKController.onOmidServiceFailure",[u]),s.getImpressionPromise()}s.setImpressionPromise(i),n.callSDKFunction(d.omidNativeFunction,{omidFunction:d.impressionOccurred,omidParams:e},d.impressionOccurredSuccessKey,d.impressionOccurredFailKey),s.getImpressionPromise()}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe("SDKController.OMIDFinishSession",(function(e){S(e=o.setAdViewIdForOldOmidVersions(e,c))})),m=c,b=I(m),f=i.getExternalLibrariesUrl()+d.omidServiceName+"/"+b+"/",p=f+d.omidServiceName+d.omidBundleFileType,n.log(d.omidNativeFunction+" activate success: "+JSON.stringify(g),n.LogLevels.verbose),v.resolve();var m,b})),r=t.PubSub.subscribe(s.CB+"."+d.activateFailKey,(function(i){t.PubSub.clearHandlers([e,r]);var a=i&&i.errMsg?i.errMsg:"";n.log(d.omidNativeFunction+" activate session fail: "+JSON.stringify(i),n.LogLevels.verbose),t.PubSub.publish("SDKController.onOmidServiceFailure",[a]),v.reject()}));return n.callSDKFunction(d.omidNativeFunction,{omidFunction:"activate",omidParams:{}},d.activateSuccessKey,d.activateFailKey),v.promise()}n.log("OMIDService - activate OMID is already initialized",n.LogLevels.verbose)}function S(e){o.fireNonFailureEvent("SDKController.onOmidFinishSessionRequired",e,c),n.log("OMIDService - finishSession",n.LogLevels.verbose);var i=new window.jQuery.Deferred,r=o.isActivated(C(),l,d.finishSession,c);if(!r.result)return i.reject(r.reason),i;var a=y(e,d.finishSession,c);if(!a.adSession)return t.PubSub.publish("SDKController.onOmidServiceFailure",[a.reason]),i.reject(a.reason),i;var s=a.adSession;if(!s.isSessionStarted()){var u=o.getErrorMsgSessionNotStarted(d.finishSession,c,e);return t.PubSub.publish("SDKController.onOmidServiceFailure",[u]),i.reject(u),i}return s.getFinishPromise()&&"pending"===s.getFinishPromise().state()?(n.log("OMIDService.tryFinishSession - "+d.omidFinishSessionAlreadyCalled,n.LogLevels.verbose),s.getFinishPromise()):(s.setFinishPromise(i),n.callSDKFunction(d.omidNativeFunction,{omidFunction:d.finishSession,omidParams:e},d.finishSessionSuccessKey,d.finishSessionFailKey),s.getFinishPromise())}function y(e,t,n){var i=o.validateAdViewId(e,d.impressionOccurred,n);if(!i.result)return{reason:i.reason};var r=e.adViewId,a=h[r];return a?{adSession:a,reason:null}:{reason:"adSession not found for adViewId = "+r}}function A(){return d.omidVersionIsControllerDownloadOMSDK[c]?d.omidVersionIsControllerDownloadOMSDK[c]:d.omidVersionIsControllerDownloadOMSDK[d.omidBundleDefaultVersionKey]}function C(){return!A()||window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function I(e){var t=d.omidVersionMapping[e];return t||(t=d.omidVersionMapping[d.omidBundleDefaultVersionKey],n.log("OMID.Service.Warnnig: version from mapping not found .choose.default - "+t)),t}function w(){return l?p:""}function D(){t.PubSub.subscribe(s.CB+"."+d.startSessionSuccessKey,(function(e){!function(e){if(h[e.adViewId]){var t=h[e.adViewId];t.getStartPromise().resolve(),n.log(d.omidNativeFunction+" Start session success | adViewId = "+t.adViewId,n.LogLevels.verbose),o.fireNonFailureEvent("SDKController.onOmidStartSessionSuccess",t.getDescription(),c)}else n.log("Error: missing adViewId in start session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+d.startSessionFailKey,(function(e){!function(e){if(e.adViewId||(e.adViewId="1"),h[e.adViewId]){var i=e&&e.errMsg?e.errMsg:"";h[e.adViewId].getStartPromise().reject(i),O(),n.log(d.omidNativeFunction+" Start session fail: "+JSON.stringify(e),n.LogLevels.verbose),t.PubSub.publish("SDKController.onOmidServiceFailure",[i])}else n.log("Error: missing adViewId in start session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+d.impressionOccurredSuccessKey,(function(e){!function(e){n.log(d.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]?h[e.adViewId].getImpressionPromise().resolve():n.log("Error: missing adViewId in impression Occurred success session callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+d.impressionOccurredFailKey,(function(e){!function(e){n.log(d.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),n.LogLevels.verbose);var i=e&&e.errMsg?e.errMsg:"";t.PubSub.publish("SDKController.onOmidServiceFailure",[i]),e.adViewId||(e.adViewId="1"),h[e.adViewId]?h[e.adViewId].getImpressionPromise().reject():n.log("Error: missing adViewId in impression Occurred fail session callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+d.finishSessionSuccessKey,(function(e){!function(e){if(n.log(d.omidNativeFunction+" Finish session success: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var t=h[e.adViewId];t.getFinishPromise().resolve(),o.fireNonFailureEvent("SDKController.onOmidFinishSessionSuccess",t.getDescription(),c),delete h[t.adViewId]}else n.log("Error: missing adViewId in finish session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+d.finishSessionFailKey,(function(e){!function(e){if(n.log(d.omidNativeFunction+" Finish session fail: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),h[e.adViewId]){var i=h[e.adViewId];O();var r=e&&e.errMsg?e.errMsg:"";t.PubSub.publish("SDKController.onOmidServiceFailure",[r]),i.getFinishPromise().reject(r),delete h[i.adViewId]}else n.log("Error: missing adViewId in finish session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))}))}function P(){n.log("SDKController.onLoadSuccessOmidBundle"),window.OmidDaemon&&window.OmidDaemon.start({partnerName:d.omidPartnerName,partnerVersion:u})}function F(){n.log("SDKController.onLoadFailureOmidBundle"),t.PubSub.publish("SDKController.onOmidServiceFailure",[d.omidFailedToLoadBundleMessage])}function O(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,t){return function(e){return e&&e.omidEnabled}(e)},isNativeServiceActivated:function(){return l},getVersionData:function(){return{omidVersion:c,omidPartnerVersion:u}},finishSession:function(e){e=o.setAdViewIdForOldOmidVersions(e,c);var t=window.jQuery.Deferred();return h[e.adViewId]?S(e).then((function(){t.resolve(!0)})).fail(t.reject):t.resolve(!1),t.promise()},isAdOmidSupported:function(e,t){return!!function(e){return e&&e.ext&&e.ext.ivt&&e.ext.ivt.omid}(e)&&o.isProductSupported(e.productType||t)},downloadOmidJsBundle:function(){if(!l)return t.Utils.returnResolvedPromise();if(A()&&C())return t.Utils.returnResolvedPromise();if(g&&"rejected"!==g.state())return g;g=new window.jQuery.Deferred;var e=w();return n.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(d.omidServiceName,e,I(c)).then(n.libsManager.manageDownloadLibsFileByFiletype.bind(null,d.omidServiceName)).then((function(){!function(){var e=i.getCacheLibsPath()+d.omidServiceName+d.omidBundleFileType,n=A();if(C()||!u||!n)return t.Utils.returnResolvedPromise();t.Utils.getScript(e,P,F)}(),g.resolve()}),(function(){t.PubSub.publish("SDKController.onOmidServiceFailure",[d.omidFailedToDownloadMessage]),g.reject()})),t.Utils.returnResolvedPromise()},init:function(e){i=e,D(),b()},getOmidBundleUrl:w,getOmidFolderUrl:function(){return l?f:""},getOmidData:function(){if(m=new window.jQuery.Deferred,!l)return n.log("cannot get omid data beacuse omid service not activated"),m.reject(),m;var e=t.PubSub.subscribe(s.CB+"."+d.getOmidDataSuccessKey,(function(n){t.PubSub.clearHandlers([e,i]),m.resolve(n)})),i=t.PubSub.subscribe(s.CB+"."+d.getOmidDataFailKey,(function(r){n.log("_onGetOmidDataFail: "+JSON.stringify(r),n.LogLevels.verbose),t.PubSub.clearHandlers([e,i]),m.reject()}));return n.callSDKFunction(d.omidNativeFunction,{omidFunction:"getOmidData",omidParams:{}},d.getOmidDataSuccessKey,d.getOmidDataFailKey),m.promise()}}}},{"./Constants.js":40,"./OMIDConstants":72,"./OmidAdSession":75,"./OmidHelper":76}],74:[function(e,t,n){t.exports=function(e){var t,n={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},i={};return{init:function(r,a){if((i=e.extend(n,r)).adData&&""!==i.adData){var o=i.src.replace("{{url}}",i.url);for(var s in(t=document.createElement("iframe")).setAttribute("src",o),t.setAttribute("id",i.id),t.setAttribute("class",i.templateClass),t.setAttribute("scrolling",i.scrolling),t.setAttribute("frameborder",i.frameBorder),i.style)i.style.hasOwnProperty(s)&&(t.style[s]=i.style[s]);t.onload=function(){a(t)},document.documentElement.appendChild(t)}},removeIframe:function(e){if(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}}}},{}],75:[function(e,t,n){t.exports=class{constructor(e="",t="1"){this.productType=e,this.adViewId=t,this.startPromise=null,this.finishPromise=null,this.impressionPromise=null,this.webViewId=""}setWebViewId(e){this.webViewId=e}setStartPromise(e){this.startPromise=e}setImpressionPromise(e){this.impressionPromise=e}setFinishPromise(e){this.finishPromise=e}getImpressionPromise(){return this.impressionPromise}getFinishPromise(){return this.finishPromise}isSessionStarted(){return this.startPromise&&"resolved"===this.startPromise.state()}isSessionFinished(){return this.finishPromise&&"resolved"===this.finishPromise.state()}getStartPromise(){return this.startPromise}getDescription(){return{productType:this.productType,adViewId:this.adViewId}}}},{}],76:[function(e,t,n){const i=e("./Constants.js"),r=e("./OMIDConstants"),a=e("../constants/SDKFeatureNames");t.exports=class{constructor(e,t){this.core=e,this.controller=t}validateStartSessionParams(e,t){let n="",i={result:!0};return e.adType||(n=r.omidControllerFunction+" | "+r.omidFailureInStartSession+" | "+r.omidproductTypeNotFound+" | omidVersion= "+t,i={result:!1,reason:n}),this.isProductSupported(e.adType)||(n=r.omidControllerFunction+" | "+r.omidFailureInStartSession+" | "+r.omidProductTypeNotSupported+e.adType+" | omidVersion= "+t,i={result:!1,reason:n}),i}setAdViewIdForOldOmidVersions(e,t){return this.isSupportingMultipleAdSession()||((e=e||{}).adViewId="1"),e}isSupportingMultipleAdSession(){return this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(a.bannersOpenMeasurement)}validateAdViewId(e,t,n){let i={result:!0};if(!e||!e.adViewId){const e=this.getFlowMsg(t);i={result:!1,reason:r.omidControllerFunction+" | "+e+" | "+r.omidAdIdNotFound+" | omidVersion= "+n}}return i}getFlowMsg(e){const t={[r.startSession]:r.omidFailureInStartSession,[r.finishSession]:r.omidFailureInFinishSession,[r.impressionOccurred]:r.omidFailureInImpressionOccurred,default:"unknown flow: "};return t[e]||t.default+e}getErrorStartSessionAlreadyStarted(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidStartSessionAlreadyStarted+" | omidVersion= "+t+" | productType= "+n.productType||""}getErrorMsgPromiseIsPending(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidPromiseIsPending+" | omidVersion= "+t+" | productType= "+n.productType||""}getErrorMsgSessionNotStarted(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidSessionNotStarted+" | omidVersion= "+t+" | productType= "+n.productType||""}isActivated(e,t,n,i){let a={result:!0};if(!e||!t){a={result:!1,reason:r.omidControllerFunction+" | "+this.getFlowMsg(n)+" |  didLoadOMSDKService "+e+" omidServiceActivated "+t+" | omidVersion= "+i}}return a}fireNonFailureEvent(e,t,n){const i="adViewId= "+(r.omidVersionRequiresWebviewPerAd[n]?"1":t.adViewId||"")+" | productType= "+(t.productType||"");this.core.PubSub.publish(e,[i])}isProductSupported(e){return!!e&&(e!==i.BN||this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(a.bannersOpenMeasurement))}}},{"../constants/SDKFeatureNames":133,"./Constants.js":40,"./OMIDConstants":72}],77:[function(e,t,n){t.exports=function(t,n){var i=new(e("../modules/StoreConfig"));return{open:function(e){if(e&&e.type&&"openUrl"===e.type){var r,a=e.callback;e.method=function(e){return e.method?e.method:t.isIOS()?e.appId?n.openUrlMethods.storeKit:n.openUrlMethods.external_browser:i.isGoogleStoreUrl(e.url)||i.isAlternativeAndroidStoreUrl(e.url)?n.openUrlMethods.external_browser:n.openUrlMethods.store}(e),e.app_context=!1!==(t.SupplyConfigurations.getNetworkConfigValueByKey("openUrl")||{}).app_context;var o=function(e){var i={default:{}};return i[n.openUrlMethods.storeKit]={appId:e.appId,viewUniqueId:t.StoreKitService.getViewUniqueId(e)},i[n.openUrlMethods.external_browser]={},i[n.openUrlMethods.store]={},i[n.openUrlMethods.webview]={controls:!0},i[e.method]||i.default}(e);return r=window.SSA_CORE.Utils.extend({url:e.url,method:e.method,package_name:e.package_name,app_context:e.app_context},o),t.openUrl(r,a),!0}return!1}}}},{"../modules/StoreConfig":208}],78:[function(e,t,n){t.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},analyticsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],79:[function(e,t,n){e("./OrientationConstants");t.exports=function(t,n,i){var r,a=e("./OrientationConstants.js"),o=!1,s=i.CB;function d(e){n.log("_setAppOrientation | send orientation: "+e,n.LogLevels.info),n.callSDKFunction(a.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e){o||(t.PubSub.subscribe(s+"."+a.NativeAPI.successCallback,(function(e){r.report(a.analyticsCategories.successCallback),e?n.SupplyConfigurations.getNetworkConfigValueByKey("forceOrientationAfterStoreKitClose")&&(n.callSDKFunction(a.ControllerNativeAPI.oldSetOrientation,{orientation:Math.pow(2,e.preferredInterfaceOrientationForPresentation)}),n.callSDKFunction(a.ControllerNativeAPI.oldSetOrientation,{orientation:e.topMostViewControllerOrientation})):(n.log("getAppOrientationData | Orientation data structure not exist.",n.LogLevels.info),r.report(a.analyticsCategories.failCallback))})),t.PubSub.subscribe(s+"."+a.NativeAPI.failCallback,(function(e){n.log("getAppOrientationData failed, errorMsg:"+e.errMsg,n.LogLevels.info),r.report(a.analyticsCategories.failCallback)})),t.PubSub.subscribe("AppOrientationManager.appOrientationChanged",(function(e){e&&e.appOrientation&&(n.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,n.LogLevels.info),d(e.appOrientation))})),r=e,o=!0)},getAppOrientationData:function(){n.callSDKFunction(a.ControllerNativeAPI.getAppOrientationData,{},a.NativeAPI.successCallback,a.NativeAPI.failCallback)},setOrientation:function(e){n.callSDKFunction(a.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var e=new jQuery.Deferred,r=t.PubSub.subscribe(s+"."+a.NativeAPI.oldApiSuccessCallback,(function(n){if(t.PubSub.unsubscribe(r),"resolved"!==e.state()){clearTimeout(o);var a=n&&n.orientation||i.appInfo.orientation.portrait;e.resolve(a)}})),o=setTimeout((function(){e.resolve(i.appInfo.orientation.portrait)}),2e3);return n.callSDKFunction(a.ControllerNativeAPI.oldGetOrientation,null,a.NativeAPI.oldApiSuccessCallback,a.NativeAPI.oldApiSuccessCallback),e.promise()},setAppOrientation:d}}},{"./OrientationConstants":78,"./OrientationConstants.js":78}],80:[function(e,t,n){t.exports=function(){var t=e("./OrientationConstants.js");function n(e){var n=parseInt(e.replace(/^"|"$/g,"")),i=[],r=n.toString(2);if(r.length>Object.keys(t.iosOrientations).length+1||"0"!==r.substr(r.length-1,1))return[];for(var a in t.iosOrientations)(n|a)===n&&i.push(t.iosOrientations[a]);return i}var i=function(e,t){return t.some((function(t){return e.indexOf(t)>=0}))};return{convertOrientationsArrayToNumber:function(e){var n=0;return e.forEach((function(e){n+=Number(function(e,t){return Object.keys(e).filter((function(n){return e[n]===t}))}(t.iosOrientations,e))})),n},convertNumberToOrientations:n,isContainPortrait:function(e){return i(n(e),[t.iosOrientations[2],t.iosOrientations[4]])},isContainLandscape:function(e){return i(n(e),[t.iosOrientations[8],t.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,t){var i=n(e),r=n(t),a=i.filter((function(e){return r.indexOf(e)>-1}));return a||(a=[]),a}}}},{"./OrientationConstants.js":78}],81:[function(e,t,n){t.exports=function(t,n){var i,r=e("./Constants.js"),a=e("./PermissionsConstants.js"),o=a.nativeFunction,s={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,o=t.PubSub.subscribe(r.CB+"."+a.handleGetPermissionsSuccess,(function(e){n.log(a.handleGetPermissionsSuccess+": "+JSON.stringify(e)),t.PubSub.unsubscribe(o),t.PubSub.unsubscribe(s),i.resolve(e)})),s=t.PubSub.subscribe(r.CB+"."+a.handleGetPermissionsFailure,(function(e){n.log(a.handleGetPermissionsFailure+": "+JSON.stringify(e)),t.PubSub.unsubscribe(s),t.PubSub.unsubscribe(o),i.reject(e)}));return n.callSDKFunction(a.nativeFunction,{functionName:a.NativeAPI.getPermissions,functionParams:(e=n.getConfig().mobileSDKSettings.deviceOs===r.deviceOs.ios?r.deviceOs.ios:r.deviceOs.android,{permissions:a.supportedPermissions[e]})},a.handleGetPermissionsSuccess,a.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(s[e]&&"pending"===s[e].status)return s[e];s[e]=new jQuery.Deferred;var i=t.PubSub.subscribe(r.CB+"."+a.handleIsPermissionGrantedSuccess,(function(e){if(e&&e.permission){var r=e.permission;s[r]?(n.log(a.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),t.PubSub.unsubscribe(i),t.PubSub.unsubscribe(d),s[r].resolve(e)):n.log("Unrecognised permission name "+r,n.LogLevels.error)}})),d=t.PubSub.subscribe(r.CB+"."+a.handleIsPermissionGrantedFailure,(function(e){if(e&&e.permission){n.log(o+a.NativeAPI.isPermissionGranted+JSON.stringify(e),n.LogLevels.verbose);var r=e.permission;s[r]?(t.PubSub.unsubscribe(d),t.PubSub.unsubscribe(i),s[r].reject(e)):n.log("Unrecognised permission name "+r,n.LogLevels.error)}else e&&e.errMsg&&n.log("Error calling isPermissionGranted "+e.errMsg,n.LogLevels.error)}));return n.callSDKFunction(a.nativeFunction,{functionName:a.NativeAPI.isPermissionGranted,functionParams:{permission:e}},a.handleIsPermissionGrantedSuccess,a.handleIsPermissionGrantedFailure),s[e].promise()}}}},{"./Constants.js":40,"./PermissionsConstants.js":82}],82:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],83:[function(e,t,n){function i(e){var t={},n,i,r={init:function(){i=jQuery,n=this},publish:function(n,r){i=i||jQuery;try{(Array.isArray(t[n])?[...t[n]]:[]).forEach((function(e){e.apply(i,r||[])}))}catch(t){if(e.Utils.isDefined(t)){e.log({type:"in PubSub "+n,data:t.message,trace:t.stack});var a={name:t.name,message:t.stack};window.onerror(t.name+": "+t.message,null,null,null,a)}}},subscribe:function(e,n){return t[e]||(t[e]=[]),t[e].push(n),[e,n]},unsubscribe:function(n){if(n){var i=n[0];t[i]&&e.Utils.each(t[i],(function(e){t[i][e]===n[1]&&t[i].splice(e,1)}))}},subscribeOnce:function(e,t){var n=this,i=this.subscribe(e,(function(){t(),n.unsubscribe(i)}))},clearHandlers:function(t){e.Utils.each(t,(function(e,t){n.unsubscribe(t)}))}};return r}t.exports=i},{}],84:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},analyticsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],85:[function(e,t,n){t.exports=function(t,n){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,d=!1,l=1e3,c=!1;function u(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:e})}return{init:function(){d||(t.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,(function(e){e&&(s=e.ringerSwitchSilent,c&&!s?r=setTimeout((function(){u(s)}),i):(r&&clearTimeout(r),u(s)))})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,(function(e){n.log("Ringer | start detecting function performed successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,(function(e){a.report(o.analyticsCategories.startListenerFail),e&&n.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,(function(e){n.log("Ringer stop detecting successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,(function(e){a.report(o.analyticsCategories.stopListenerFail),e&&n.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,(function(e){n.log("Ringer prepare detector successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,(function(e){a.report(o.analyticsCategories.initFail),e&&n.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),n.log("Ringer | calling init native function",n.LogLevels.info),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),a=t.Analytics.createAnalytic({baseData:{}}),d=!0)},startListener:function(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:s}),c=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||l,n.log("Ringer | Set listener config to should delay?"+c+", with delay "+i,n.LogLevels.verbose),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){c=!1,i=l,n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return d}}}},{"./RingerSwitchConstants.js":84}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SingleImpressionStrategy=n.MAOImpressionStrategy=void 0;class i{constructor(e,t,n,i){this.SKAdImpressionService=e,this.analytics=t,this.analyticsCategories=n,this.minBannerRefreshTime=i}handleImpression(e){this.startImpression(e),this.scheduleEndImpression(e,this.minBannerRefreshTime)}startImpression(e){this.SKAdImpressionService.startImpression(e,this.onStartImpressionSuccess.bind(this),this.onStartImpressionFailed.bind(this))}endImpression(e){this.SKAdImpressionService.endImpression(e,this.onEndImpressionSuccess.bind(this),this.onEndImpressionFailed.bind(this))}scheduleEndImpression(e,t){this.bannerEndImpressionTimer&&clearTimeout(this.bannerEndImpressionTimer),this.bannerEndImpressionTimer=setTimeout((()=>{this.endImpression(e)}),t)}onStartImpressionSuccess(){this.analytics.report(this.analyticsCategories.startImpressionSuccess)}onStartImpressionFailed(e){this.analytics.report(this.analyticsCategories.startImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}onEndImpressionSuccess(){this.analytics.report(this.analyticsCategories.endImpressionSuccess,{generalmessage:this.minBannerRefreshTime})}onEndImpressionFailed(e){this.analytics.report(this.analyticsCategories.endImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}}n.SingleImpressionStrategy=i;class r{handleImpression(e){}endImpression(e){}startImpression(e){}}n.MAOImpressionStrategy=r,t.exports={MAOImpressionStrategy:r,SingleImpressionStrategy:i}},{}],87:[function(e,t,n){"use strict";var i=e("../SKAdImpression/BannerImpressionStrategy");t.exports=class{constructor(e,t,n){this.controller=e,this.analytics=t,this.analyticsCategories=n}handleBannerSKANImpression(e){this.createStrategy(e).handleImpression(e)}createStrategy(e){return e.isMultipleAdObjects?new i.MAOImpressionStrategy:new i.SingleImpressionStrategy(this.controller.SKAdImpressionService,this.analytics,this.analyticsCategories,this.controller.getMinBannerRefreshTime())}}},{"../SKAdImpression/BannerImpressionStrategy":86}],88:[function(e,t,n){t.exports=function(t,n,i){var r=e("../storeKit/SKANModel")(),a=e("../storeKit/SKANConstants"),o=e("../../constants/SDKFeatureNames");function s(e){if(!n.isIOS())return!1;var t=parseFloat(n.getConfig().mobileSDKSettings.deviceOSVersion)>=a.SKAdImpression.minimalSupportedIOSVersion,i=n.CompatibilityService.isFeatureSupportedInNativeSDK(o.SKAdImpression),r=function(e){const t="Banner"===e.productType;if(t)return!e.isMultipleAdObjects;return!0}(e);return!!(t&&i&&function(e){return!!(e.ext&&e.ext.SKANData&&e.ext.SKANData.VTA)}(e)&&r)}function d(e,t,i,o){n.callSDKService(a.SKAdImpression.jsInterface,e,{impressionData:r.extractDataForSKAdImpression(t)},i,o)}return{startImpression:function(e,n,r){if(e&&s(e)){var o=e.adViewId||Date.now(),l=a.SKAdImpression.startImpressionSuccess+"."+o,c=a.SKAdImpression.startImpressionFailed+"."+o,u=[];u.push(t.PubSub.subscribe(i.CB+"."+l,(function(){t.PubSub.clearHandlers(u),t.Utils.isFunction(n)&&n()}))),u.push(t.PubSub.subscribe(i.CB+"."+c,(function(e){t.PubSub.clearHandlers(u),t.Utils.isFunction(r)&&r(e)}))),d(a.SKAdImpression.startImpression,e,l,c)}},endImpression:function(e,n,r){if(e&&s(e)){var o=e.adViewId||Date.now(),l=a.SKAdImpression.endImpressionSuccess+"."+o,c=a.SKAdImpression.endImpressionFailed+"."+o,u=[];u.push(t.PubSub.subscribe(i.CB+"."+l,(function(){t.PubSub.clearHandlers(u),t.Utils.isFunction(n)&&n()}))),u.push(t.PubSub.subscribe(i.CB+"."+c,(function(e){t.PubSub.clearHandlers(u),t.Utils.isFunction(r)&&r(e)}))),d(a.SKAdImpression.endImpression,e,l,c)}}}}},{"../../constants/SDKFeatureNames":133,"../storeKit/SKANConstants":126,"../storeKit/SKANModel":127}],89:[function(e,t,n){var i=e("./SKOverlayConstants"),r=i.configKeys;t.exports=function(e,t,n,a,o,s,d,l){if(e&&t){var c=e,u=t,p=n||i.position.bottom,f=o||{},g=!!a,v=s||function(){var e={};return e[i.delayConfigKeys.initialDelay]=0,e[i.delayConfigKeys.subsequentDelay]=0,e}(),m=d||i.flow.presentOnSKClose,h=l||"",b=null,S=null;return{getOverlayId:function(){return c},getAdvertisedAppId:function(){return u},getConfigObjectForSDK:function(){var e={};return e[r.overlayId]=c,e[r.advertisedAppId]=u,e[r.position]=p,e[r.userDismissible]=g,e[r.SKANData]=f,e[r.customProductPage]=h,e},isQualityClickTriggered:function(){return b},setQualityClickTriggered:function(){b=!0},getDismissInitiatedSource:function(){return S},setDismissInitiatedSource:function(e){S=e},getPresentationDelay:function(e){return e?v[i.delayConfigKeys.initialDelay]:v[i.delayConfigKeys.subsequentDelay]},getFlow:function(){return m},getPpid:function(){return h}}}}},{"./SKOverlayConstants":90}],90:[function(e,t,n){var i=e("../../components/Constants");t.exports={minimalSupportedIOSVersion:14,supportedProductTypes:[i.RV,i.IS],configKeys:{overlayId:"overlayId",advertisedAppId:"advertisedAppId",position:"position",userDismissible:"userDismissible",SKANData:"SKANData",customProductPage:"customProductPageIdentifier"},position:{bottom:0,bottomRaised:1},flow:{presentOnSKClose:0,presentOnSKCloseAndQC:1,presentOnAdVisible:2},externalConfigKeys:{enableSKOverlay:"enableSKOverlay",SKOverlayPosition:"SKOverlayPosition",SKOverlayUserDismissible:"SKOverlayUserDismissible",delayInSecToPresentSKOverlay:"delayInSecToPresentSKOverlay",SKOverlayFlow:"SKOverlayFlow"},delayConfigKeys:{initialDelay:"initialDelay",subsequentDelay:"subsequentDelay"},overlayDismissInitiatedType:{user:0,SKOpen:1,adClose:2},messages:{SDK:{incoming:{overlayCreated:"overlayCreated",overlayCreateFailed:"overlayCreateFailed",overlayLoadFailed:"overlayLoadFailed",overlayWillStartPresentation:"overlayWillStartPresentation",overlayDidFinishPresentation:"overlayDidFinishPresentation",overlayWillStartDismissal:"overlayWillStartDismissal",overlayDidFinishDismissal:"overlayDidFinishDismissal",overlayRemoved:"overlayRemoved",overlayDismissFailure:"overlayDismissFailure",overlayRemovalFailure:"overlayRemovalFailure"},outgoing:{jsInterface:"SKOverlayAPI",createOverlay:"createOverlay",presentOverlay:"presentOverlay",dismissOverlay:"dismissOverlay",removeOverlay:"removeOverlay"}},adunit:{outgoing:{overlayCreateCalled:"overlayCreateCalled",overlayCreateSuccess:"overlayCreateSuccess",overlayCreateFailed:"overlayCreateFailed",overlayVisibleCalled:"overlayVisibleCalled",overlayVisibleSuccess:"overlayVisibleSuccess",overlayVisibleFailed:"overlayVisibleFailed",overlayDismissed:"overlayDismissed"}}}}},{"../../components/Constants":40}],91:[function(e,t,n){t.exports=function(t,n,i){var r=null,a=0,o=null,s=null,d=e("./SKOverlayConstants"),l=new(e("../../modules/DemandSource/EventCategories.js"));function c(e){s=window.timerService.startTimer(),r.report(l.overlayWillStartPresentation_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a})}function u(e){r.report(l.overlayDidFinishPresentation_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a,custom_c:s?window.timerService.stopTimer(s):-1,timingvalue:o?window.timerService.stopTimer(o):-1}),s=null,o=null}function p(e){r.report(l.presentOverlayFailed_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a,callfailreason:e.errMsg,timingvalue:o?window.timerService.stopTimer(o):-1}),o=null}function f(e){r.report(l.overlayWillStartDismissal_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a})}function g(e){r.report(l.overlayDidFinishDismissal_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a}),a++}return{init:function(){r=t.Analytics.createAnalytic({baseData:{}}),t.PubSub.subscribe(i.CB+"."+d.messages.SDK.incoming.overlayWillStartPresentation,c),t.PubSub.subscribe(i.CB+"."+d.messages.SDK.incoming.overlayDidFinishPresentation,u),t.PubSub.subscribe(i.CB+"."+d.messages.SDK.incoming.overlayLoadFailed,p),t.PubSub.subscribe(i.CB+"."+d.messages.SDK.incoming.overlayWillStartDismissal,f),t.PubSub.subscribe(i.CB+"."+d.messages.SDK.incoming.overlayDidFinishDismissal,g)},onPresentOverlay:function(){o&&r.report(l.presentOverlayDuringPendingPresent,{timingvalue:window.timerService.stopTimer(o)}),o=window.timerService.startTimer()}}}},{"../../modules/DemandSource/EventCategories.js":162,"./SKOverlayConstants":90}],92:[function(e,t,n){t.exports=function(t,n,i){var r="SKOverlayManager | ",a=e("./SKOverlayConstants").configKeys,o=e("../../components/SKOverlay/SKOverlay"),s=e("./SKOverlayConstants"),d=e("../../components/storeKit/SKANModel")(),l=e("../../constants/SDKFeatureNames"),c=new(e("../../modules/DemandSource/EventCategories.js")),u=!1,p=[],f=null,g=null,v=null,m=null,h=null,b=null,S=!1,y=!1,A=null;function C(){return n.isIOS()&&n.getConfigurationHelper().getDeviceApiLevel()>=s.minimalSupportedIOSVersion&&n.CompatibilityService.isFeatureSupportedInNativeSDK(l.SKOverlay)}function I(e,a,d,l,c,u,f,g){var v=[],m=e,h=new o(m,a,d,l,c,u,f,g);if(h){var y=s.messages.SDK.incoming.overlayCreated+R(),A=s.messages.SDK.incoming.overlayCreateFailed+R();return v.push(t.PubSub.subscribe(i.CB+"."+y,(function(e){n.log(r+"_createOverlay | "+y+"   "+JSON.stringify(e)),function(e){if(!e)return void n.log(r+"Failed to add overlay to overlays array");p.push(e)}(h),L(s.messages.adunit.outgoing.overlayCreateSuccess,e),h.getFlow()===s.flow.presentOnSKCloseAndQC&&function(e){b=t.PubSub.subscribe("SDKController.qcTriggered",(function(){var t=x(e);t&&t.setQualityClickTriggered()}))}(m),h.getFlow()===s.flow.presentOnAdVisible&&N(h,!0),S=!1,t.PubSub.clearHandlers(v)}))),L(s.messages.adunit.outgoing.overlayCreateCalled,h.getConfigObjectForSDK()),U(s.messages.SDK.outgoing.createOverlay,h.getConfigObjectForSDK(),y,A),h}n.log(r+"_createOverlay | Failed to create an overlay - missing overlayId")}function w(e){if(e){var o=[],d=s.messages.SDK.incoming.overlayDidFinishPresentation,l=s.messages.SDK.incoming.overlayLoadFailed;o.push(t.PubSub.subscribe(i.CB+"."+d,(function(a){n.log(r+"_presentOverlay |"+d+"   "+JSON.stringify(a)),n.getCurrentDisplayedAd()&&n.getCurrentDisplayedAdType()!==i.BN&&y?(F(e),t.PubSub.clearHandlers(o),L(s.messages.adunit.outgoing.overlayVisibleSuccess,a)):V(a.overlayId)}))),o.push(t.PubSub.subscribe(i.CB+"."+l,(function(e){n.log(r+"_presentOverlay | "+l+"   "+JSON.stringify(e)),t.PubSub.clearHandlers(o),L(s.messages.adunit.outgoing.overlayVisibleFailed,e)})));var u={advertisedAppId:e.getAdvertisedAppId()};u[a.customProductPage]=e.getPpid(),L(s.messages.adunit.outgoing.overlayVisibleCalled,u),h.report(c.presentOverlay_c,{generalmessage:e.getAdvertisedAppId(),custom_a:e.getOverlayId()});var p={};p[s.configKeys.overlayId]=e.getOverlayId(),n.SKOverlayEventDispatcher.onPresentOverlay(),U(s.messages.SDK.outgoing.presentOverlay,p,d,l)}else n.log(r+"_presentOverlay | Failed to present an overlay")}function D(e){var a=x(e);a||(n.log(r+"_dismissOverlay | Failed to dismiss an overlay with missing overlay"),h.report(c.overlayMissing,{custom_b:1}));var o=s.messages.SDK.incoming.overlayDismissFailure+R(),d=t.PubSub.subscribe(i.CB+"."+o,(function(n){var i={generalmessage:a?a.getAdvertisedAppId():-1,custom_a:e};h.report(c.overlayDismissFailure,i),t.PubSub.unsubscribe(d)}));h.report(c.dismissOverlay_c,{generalmessage:a?a.getAdvertisedAppId():-1,custom_a:e,custom_b:0}),U(s.messages.SDK.outgoing.dismissOverlay,{overlayId:e},null,o)}function P(e){return e?x(e.adViewId):null}function F(e){f=e}function O(){return f}function T(){return!!O()}function x(e){if(!e)return h.report(c.overlayMissing,{custom_b:3}),null;for(var t in Object.keys(p))if(p[t].getOverlayId()===e)return p[t];return h.report(c.overlayMissing,{custom_b:4}),null}function N(e,t){var n=e.getPresentationDelay(t);m=setTimeout((function(){w(e)}),1e3*n)}function L(e,i){n.postAdUnitEvent(t.Utils.extend({name:e},i))}function U(e,t,i,r){var a={};t&&0!==Object.keys(t).length&&(a={functionParams:t}),n.callSDKService(s.messages.SDK.outgoing.jsInterface,e,a,i,r)}function M(){m&&clearTimeout(m),m=void 0}function V(e){D(e),function(e){var a=x(e);a||(n.log(r+"_removeOverlay | Failed to remove an overlay with missing overlay"),h.report(c.overlayMissing,{custom_b:2}));var o=s.messages.SDK.incoming.overlayRemoved+R(),d=s.messages.SDK.incoming.overlayRemovalFailure+R(),l=t.PubSub.subscribe(i.CB+"."+o,(function(e){if(n.log(r+"_removeOverlay | "+o+"   "+JSON.stringify(e)),a){var i=p.indexOf(a);-1!==i&&p.splice(i,1)}t.PubSub.unsubscribe(l),t.PubSub.unsubscribe(u)})),u=t.PubSub.subscribe(i.CB+"."+d,(function(n){var i={callfailreason:n.errMsg,custom_a:e};h.report(c.overlayRemovalFailure,i),t.PubSub.unsubscribe(l),t.PubSub.unsubscribe(u)})),f={};f[s.configKeys.overlayId]=e,U(s.messages.SDK.outgoing.removeOverlay,f,o,d)}(e)}function E(e){return-1!==[i.RV,i.IS].indexOf(e)}function k(e){if(e){var n=e&&e.hasOwnProperty("timeInterval")?e.timeInterval:700,i=e&&e.hasOwnProperty("attempts")?e.attempts:1;i<=0||(A=setTimeout((function(){U(s.messages.SDK.outgoing.dismissOverlay,{},null,null),h.report(c.dismissOverlay_c,{custom_b:1}),k(e=t.Utils.extend(e,{attempts:i-1}))}),n))}}function B(e){var t=n.AdUtils.extractEventData(g);e&&(t.generalmessage=e.advertisedAppId,t.custom_b=e.userDismissible?1:0,t.custom_a=e.overlayId),t.custom_c=s.overlayDismissInitiatedType.adClose,h.report(c.overlayDismissed,t)}function R(){return(new Date).getTime()+Math.random()}return{init:function(){C()&&!u&&(u=!0,h=t.Analytics.createAnalytic({baseData:{}}),n.SKOverlayEventDispatcher.init(),t.PubSub.subscribe("SDKController.AdVisible",(function(e){var t;(e&&E(e.productType)&&(y=!0),!(t=e)||!t.settings||(t=n.Utils.flattenAd(t)).productType&&-1===s.supportedProductTypes.indexOf(t.productType)||!t.clickTags||!t.clickTags.storeAppId||t.hasOwnProperty(s.externalConfigKeys.enableSKOverlay)&&!t[s.externalConfigKeys.enableSKOverlay])||(clearTimeout(A),A=void 0,function(e){if(e&&e.settings&&e.ext){var t=e.ext.clickTags&&e.ext.clickTags.storeAppId,i=e.settings[s.externalConfigKeys.SKOverlayPosition],a=!e.settings.hasOwnProperty(s.externalConfigKeys.SKOverlayUserDismissible)||e.settings[s.externalConfigKeys.SKOverlayUserDismissible],o=e.settings[s.externalConfigKeys.delayInSecToPresentSKOverlay],l=e.settings[s.externalConfigKeys.SKOverlayFlow]||0,c=d.extractDataForSKOverlay(e),u=e.ext.appData&&e.ext.appData.ppid||"";n.log(r+"_createOverlay : "+JSON.stringify(c)),I(e.adViewId,t,i,a,c,o,l,u)}}(e),function(e){g=e}(e))})),t.PubSub.subscribe("SDKController.adClosed",(function(e){e.ad&&E(e.ad.productType)&&(y=!1),u&&k(e.ad.settings.dismissOverlayOnAdClose),p&&0!==p.length&&(M(),b&&(t.PubSub.unsubscribe(b),b=null),V(p[0].getOverlayId()))})),t.PubSub.subscribe(i.CB+"."+s.messages.SDK.incoming.overlayDidFinishDismissal,(function(e){n.log(r+s.messages.SDK.incoming.overlayDidFinishDismissal+"   "+JSON.stringify(e));var t=n.getCurrentDisplayedAd();t?function(e,t){var n=P(e);t.dismissInitiatedSource=n&&n.getDismissInitiatedSource()||s.overlayDismissInitiatedType.user,L(s.messages.adunit.outgoing.overlayDismissed,t),B(t),n&&n.setDismissInitiatedSource(null)}(t,e):B(e),F(null)})),t.PubSub.subscribe(i.CB+"."+s.messages.SDK.incoming.overlayCreateFailed,(function(e){n.log(r+s.messages.SDK.incoming.overlayCreateFailed+"   "+JSON.stringify(e));var t={};if(e&&e.overlayId){var i=x(e.overlayId);t=i&&i.getConfigObjectForSDK()}L(s.messages.adunit.outgoing.overlayCreateFailed,t)})),t.PubSub.subscribe("SDKController.aecskTriggered",(function(e){S=!0})))},isSKOverlaySupported:C,onSKClose:function(){if(C()&&!S){var e=P(g);if(e){if(v)return N(v,!1),void(v=null);e.getFlow()===s.flow.presentOnAdVisible&&N(e,!1),e.getFlow()===s.flow.presentOnSKClose&&N(e,!0),e.getFlow()===s.flow.presentOnSKCloseAndQC&&e.isQualityClickTriggered()&&N(e,!0)}}else S=!1},onSKOpen:function(){C()&&(T()?((v=O()).setDismissInitiatedSource(s.overlayDismissInitiatedType.SKOpen),D(v.getOverlayId())):M())},isSKOverlayVisible:function(){return T()},displaySKOverlay:function(){if(C()){var e=P(g);e&&w(e)}},dismissOverlay:D}}},{"../../components/SKOverlay/SKOverlay":89,"../../components/storeKit/SKANModel":127,"../../constants/SDKFeatureNames":133,"../../modules/DemandSource/EventCategories.js":162,"./SKOverlayConstants":90}],93:[function(e,t,n){t.exports=function(e,t,n){var i=n||{};function r(t){var n=e.getConfig().controllerConfig;return(n&&n.networkConfig||{})[t]}return{getValueByKey:function(t){return(e.getConfig().controllerConfig||{})[t]},getValueByKeyAndProductType:function(n,i){var r=e.getConfig().controllerConfig;return(r&&r[t.sspProductNames[i]]||{})[n]},getNetworkConfigValueByKey:r,getFeaturesConfigByAdSource:function(e){var t=r("features"),n=i.extend(!0,{},t);delete n.MP;var a=e&&t&&t[e]||{};return i.extend(!0,{},n,a)},isNetworkConfigEmpty:function(){var t=e.getConfig().controllerConfig;return!t||!t.networkConfig},getFeaturesConfigByKey:function(e){const t=r("features");return t?t[e]:void 0}}}},{}],94:[function(e,t,n){"use strict";var i=e("../types/network");const r=e("./Constants");t.exports=class{constructor(e){this.controller=e}firePixel(e){if(void 0!==e.url&&""!==e.url){if("pixel"===e.type){const t=new Image;""===e.at||isNaN(parseInt(e.at))?t.src=e.url:(t.src=e.url,t.time=e.at)}}else this.controller.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),this.controller.LogLevels.info)}sendPost(e,t=i.HTTPContent.text){var n;return fetch(null!==(n=e.url)&&void 0!==n?n:"",{method:i.HTTPMethod.POST,headers:{"Content-Type":t},body:JSON.stringify(e.payload)}).then((e=>e&&e.status?{status:e.status}:{status:r.noServerResponseCode})).catch((e=>{throw console.error("Failed to send POST request:",e),e}))}}},{"../types/network":231,"./Constants":40}],95:[function(e,t,n){function i(e,t,n,i){function r(e,t){return e[0]&&t[0]?(e=new Date(e[0]))<(t=new Date(t[0]))?-1:e>t?1:0:0}function a(e,t){return void 0===e&&(e=1),e=parseInt(e),t=parseInt(t),isNaN(e)||isNaN(t)?-1:e===t?0:e>t?1:-1}function o(e){try{return e()}catch(e){return!1}}function s(e){return"object"==typeof e&&e.hasOwnProperty("length")?Array.prototype.slice.call(e):[]}function d(e){if(c())return p(l(),e)}function l(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}function c(){return crypto&&crypto.getRandomValues&&"function"==typeof crypto.getRandomValues&&Array.isArray(crypto.getRandomValues(new Uint8Array(1)))}function u(e,t){if(e.length<=t||t<=0)return"";for(var n=0,i=0;i<e.length;i++){n+=e.charCodeAt(i)}return n%Math.pow(16,t).toString(16)}function p(e,t){if(e.length<=t||t<=0)return e;var n=e.slice(0,-t);return n+u(n,t)}function f(e,...t){function n(e){return e&&"object"==typeof e&&!Array.isArray(e)}if(void 0===e&&(e={}),!t.length)return e;const i=t.shift();if(n(e)&&n(i))for(const t in i)n(i[t])?(n(e[t])||(e[t]={}),f(e[t],i[t])):e[t]=i[t];return f(e,...t)}function g(e,...t){return!0===(e=e||{})?f(...t):(Object.assign(e,...t),Object.keys(e).forEach((t=>{void 0===e[t]&&delete e[t]})),e)}function v(e,t){if(e)for(const n in e)t(n,e[n])}function m(e){var t=e.children[0],i=n.createElement("span");i.style.display="inline-block",t.replaceWith(i),i.appendChild(t);var r=t.parentElement.getBoundingClientRect().width;return t.parentElement.replaceWith(t),r}function h(e,t){var n,i,r=t.maxFontPixels,a=t.maxHeight,o=t.maxWidth,s=t.parentContainer?t.parentContainer.getBoundingClientRect().height:e.parentElement.getBoundingClientRect().height,d=t.parentContainer?t.parentContainer.getBoundingClientRect().width:e.parentElement.getBoundingClientRect().width;s=a||s,d=o||d;do{e.style.fontSize=r,r-=1,t.lineHeight&&(t.parentContainer.style.lineHeight=t.lineHeight+"em"),n=e.parentElement.getBoundingClientRect().height,i=e.parentElement.getBoundingClientRect().width}while(n>s||i>d&&r>3)}function b(t){if(t){var n=JSON.parse(JSON.stringify(t));return i(n,"ext",!1),i(n,"features",!1),i(n,"settings",!0),n}function i(t,n,i){t.hasOwnProperty(n)&&"object"==typeof t[n]&&delete(t=i?e.Utils.extend(!0,t,t[n]):e.Utils.extend(t,t[n]))[n]}}function S(e){for(var t in e)null!==e[t]&&void 0!==e[t]&&""!==e[t]||delete e[t];return e}var y={textfill2:h,calculateTextElementWidth:m,each:v,extend:g,getScript:function(t,i,r){var a=n.createElement("script");a.src=t;var o=n.getElementsByTagName("head")[0],s=!1;a.onload=a.onreadystatechange=function(e){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,i(e),a.onload=a.onreadystatechange=null,o.removeChild(a))},a.onerror=function(t){e.log(["script load error",t]),r&&r()},o.appendChild(a)},getQueryString:function(e,n,i){i=this.isDefined(i)?i:t.location.href,null===n&&(n=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(i);return null===r?n:r[1]},getUrlInfo:function(e){var t=n.createElement("a");return t.href=e,{host:t.hostname,port:t.port,path:t.pathname,protocol:t.protocol}},changeUrlProtocol:function(e,t){var i=n.createElement("a");return i.href=e,i.protocol=t,i.href},serialize:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},isDefined:function(e){return typeof e!==i},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){return this.isString(e)?JSON.parse(e):null},getParams:function(e){var t,n=[],r=e.split("/"),a=r.length;if(-1===e.indexOf("JSON:")){if(a>=2&&a%2==0)for(t=0;t<a;t+=2)n[r[t]]=r.length>=t+1?decodeURIComponent(r[t+1]):null}else{var o=e.split("JSON:");typeof o[1]!==i&&(n=this.parseJSON(o[1]))}return n},decodeValues:function(t){v(t,(function(n){t.hasOwnProperty(n)&&("string"==typeof t[n]&&(t[n]=decodeURIComponent(t[n])),"object"==typeof t[n]&&t[n]&&e.Utils.decodeValues(t[n]))}))},renderTemplate:function(e,t){return t?(v(t,(function(t,n){var i=new RegExp("{{"+t+"}}","g");e=e.replace(i,n)})),e):e},isVisible:function(e){return"none"!==e.style.display&&"hidden"!==e.style.visibility},returnResolvedPromise:function(){var e,t=new jQuery.Deferred;return arguments.length>0&&(e=[].slice.call(arguments)),t.resolve.apply(t.resolve,e),t.promise()},returnRejectedPromise:function(){var e,t=new jQuery.Deferred;return arguments.length>0&&(e=[].slice.call(arguments)),t.reject.apply(t.reject,e),t.promise()},replacePlaceHolder:function(e,t){var n;for(var i in t){n=t[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof n?n():n)}return e},fileArrayIncludes:function(e,t){if(e||0===e.length)return!1;for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},sortDataByDateKey:function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t.sort(r)},isWebWrapper:function(){return t.isWebWrapper},apiVersionCompareTo:a,isNestedObjectExists:o,convertArrayLikeObjectToArray:s,generateIdentifier:d,replaceEndingWithCheckSum:p,flattenAd:b,removeEmptyValuesFromObj:S};return y}window.Utils=i,t.exports=i},{}],96:[function(e,t,n){e("./TrackingService");t.exports=function(t,n){var i=new(e("./TrackingService"))(n),r=e("../components/FillRateTrackingService.js")(n,i),a=e("../components/ObfuscationService.js")(t.Utils),o=e("../modules/DemandSource/EventCategories")(),s=e("./Constants"),d="1.0.9",l="/common/sdk/",c=l+d+"/vastObfuscator",u=l+d+"/vast-vmap",p=c+".4f4eb4fb.min.html",f=c+".html",g=u+".4f4eb4fb.min.js",v=u+".js",m=n.DemandUtils;return{parseVast:function(e,d,l){var c,u,h=new jQuery.Deferred;if("prod"!==n.getEnv()?(c=e.settings.urltocdn+f,u=e.settings.urltocdn+v):(c=e.settings.urltocdn+p,u=e.settings.urltocdn+g),!(e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse))return h.reject({errMsg:"unsupported vast format"});var b=e.ext.vastData.xmlResponse,S={adData:b,style:"height:100%;",adUnitData:e,vastParserUrl:u},y={adData:b,url:c,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(e,n,d){var l,c;if("[object Array]"===Object.prototype.toString.call(e.ext.callbacks)){var u=e.controllerSpace&&e.controllerSpace.viewCount||0;l=e.ext.callbacks[u]}else l=e.ext.callbacks;var p=r.init(l),f=e.vastIframeId,g=t.PubSub.subscribe("SDKController.VastRequest",(function(e){e.vastIframeId&&e.vastIframeId===f&&(p.track({trackingType:"request"}),t.PubSub.unsubscribe(g))})),v=t.PubSub.subscribe("SDKController.VastResponse",(function(e){e.vastIframeId&&e.vastIframeId===f&&(clearTimeout(c),"hit"===e.result?(p.track({trackingType:"responseHit"}),a.removeIframe(f),t.PubSub.unsubscribe(v),n.resolve(e.data)):(p.track({trackingType:"responseMiss",data:e.data}),a.removeIframe(f),t.PubSub.unsubscribe(v),n.reject({errMsg:e.data})))})),h=d&&d>s.vastMinimumResponseTimeout?d:s.vastResponseTimeout;c=setTimeout((function(){t.PubSub.unsubscribe(v),t.PubSub.unsubscribe(g),t.PubSub.unsubscribe(b),clearTimeout(c),n.reject({isTimeLimitReached:!0,errMsg:"timeout"})}),h);var b=t.PubSub.subscribe("SDKController.VastErrorPixel",(function(e){e.vastIframeId&&e.vastIframeId===f&&(i.firePixel(e),a.removeIframe(f),t.PubSub.unsubscribe(b))})),S=t.PubSub.subscribe("SDKController.parseVastInfo",(function(n){if(n.vastIframeId&&n.vastIframeId===f){t.PubSub.unsubscribe(S);var i=m.extendCallbackParamsWithParentProductConfig(e,{action:"fireEvent",eventParam:{eName:o.parseVastInfo,label:{},data:{generalMessage:n.data}}});t.PubSub.publish("SDKController.Analytics",[i])}}))}(e,h,l.vastTimeOut),a.init(y,(function(e){t.Msg.postMessage("$$JSON:"+JSON.stringify(S),c,e.contentWindow)})),h.promise()},removeIframe:function(e){a.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":48,"../components/ObfuscationService.js":74,"../modules/DemandSource/EventCategories":162,"./Constants":40,"./TrackingService":94}],97:[function(e,t,n){var i;!function(e){e[e.LOWER=-1]="LOWER",e[e.EQUAL=0]="EQUAL",e[e.HIGHER=1]="HIGHER"}(i||(i={}));t.exports=class{constructor(){this.VERSION_DIGITS_COUNT=4}isHigher(e,t){return this.compare(e,t)===i.HIGHER}isLower(e,t){return this.compare(e,t)===i.LOWER}isEqual(e,t){return this.compare(e,t)===i.EQUAL}compare(e,t){try{const n=this.prepareVersionForComparison(e),i=this.prepareVersionForComparison(t);return this.compareVersionArrays(n,i)}catch(e){throw"Parse Error - VersionCompare"}}prepareVersionForComparison(e){const t=this.fix5_0_2CorruptedVersionIfNeeded(e.toString()),n=this.createVersionArray(t);return this.getExtendedLengthVersion(n)}fix5_0_2CorruptedVersionIfNeeded(e){return"5.02"===e&&(e="5.0.2"),e}createVersionArray(e){const t=e.split(".").map((e=>parseInt(e)));if(0===t.length)throw`version ${e} is not a valid numeric version`;return t}getExtendedLengthVersion(e){const t=e;for(;t.length<this.VERSION_DIGITS_COUNT;)t.push(0);return t}compareVersionArrays(e,t){for(let n=0;n<this.VERSION_DIGITS_COUNT;n++){if(e[n]>t[n])return i.HIGHER;if(e[n]<t[n])return i.LOWER}return i.EQUAL}}},{}],98:[function(e,t,n){t.exports=function(t){var n,i,r,a=e("../components/Constants.js"),o=null;return{init:function(e,t){o=new jQuery.Deferred,n=function(e){return e.settings&&e.settings.standaloneView}(e),a.viewsStates.normal,i=e.ext&&e.ext.viewUniqueId||"",r={standaloneView:n,viewUniqueId:i,adViewId:t},o.resolve({})},waitForAllViews:function(){return o.promise()},getDisplayWebViewParams:function(e){return r=t.Utils.extend(r,{display:e})}}}},{"../components/Constants.js":40}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=["ext_google_water_mark","ext_google_watermark"];t.exports=class{constructor(e,t){this.params=e,this.controller=t,this.setMediationKey()}getWatermarkConfig(){if(!this.isWatermarkEnabled())return;const e=this.getDecodedDataString();return e?{data:e,presentationStrategy:"repeat"}:void 0}isWatermarkEnabled(){var e;return!!this.watermarkKey&&"string"==typeof(null===(e=this.params)||void 0===e?void 0:e[this.watermarkKey])}getDecodedDataString(){if(this.watermarkKey&&this.params[this.watermarkKey])return decodeURIComponent(this.params[this.watermarkKey])}setMediationKey(){const e=this.findFirstSupportedKey();e?(this.watermarkKey=e,this.controller.log(`A new key for displaying the watermark was set successfully: ${this.watermarkKey}`,3)):this.controller.log("A relevant key for displaying the watermark was not found.",3)}findFirstSupportedKey(){for(const e of i)if(this.params[e])return e}}},{}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i={dapi:{name:"dapi",fileName:"dapi.js",version:"2.0.2"},mraid:{name:"mraid",fileName:"mraid.js",version:"1.2.1"}};t.exports=class{constructor(e,t,n){var r,a;const{uepfc:o=!0,adprot:s}=null!=t?t:{};this._controller=e,this._baseUrl=n,this._shouldDownloadProtocols=o,this._externalProtocols=this._controller.Utils.extend(!0,i,s);const d=null===(a=null===(r=this._controller.getConfig())||void 0===r?void 0:r.mobileSDKSettings)||void 0===a?void 0:a.mraidVersion;d&&(this._externalProtocols.mraid=Object.assign(Object.assign({},this._externalProtocols.mraid),{version:d}))}protocolInfo(e){const t=this._externalProtocols[e];if(!t)throw new Error(`Protocol ${e} is not supported`);return Object.assign(Object.assign({},t),{downloadUrl:`${this._baseUrl}/${t.name}/${t.version}/${t.fileName}`,shouldDownload:this.shouldDownloadProtocols()})}shouldDownloadProtocols(){return this._shouldDownloadProtocols}}},{}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e,t,n){this._controller=e,this._rootPath=t,this._analytics=n}fetchFile(e){const{fileName:t,url:n,version:i,name:r}=e,a=`${r}_${i}`;return new Promise(((e,i)=>{const r={filePath:`${a}/${t}`,url:n,rootPath:this._rootPath};this._controller.Cache.isFileInCache(t,a)?e(r):this._controller.cacheAsset(a,n).then((t=>{e(Object.assign(Object.assign({},t),{rootPath:this._rootPath}))})).fail((e=>{i(e)}))}))}rootPath(){return this._rootPath}}},{}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e,t){this._cacheFolder=t;const n=location.origin+location.pathname.slice(0,location.pathname.lastIndexOf("/"));this._rootPath=n.slice(0,n.lastIndexOf("/")+1)+this._cacheFolder+"/"}getRootAbsolutePath(){return this._rootPath}}},{}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ExternalProtocolFile=void 0;var i=e("../../types");class r{}r.DOWNLOADING="downloading",r.DOWNLOADED="downloaded",r.FAILED="failed",r.NONE="none";class a{}a.FEATURE_DISABLED_BY_FLAG="featureDisabledByFlag",a.FILE_NOT_DOWNLOADED="fileNotDownloaded",a.AD_PLAYER_IN_STREAMING_MODE="adPlayerInStreamingMode",a.RELATIVE_DEFAULT="reativeDefault",a.REMOTE_DEFAULT="remoteDefault",a.RELATIVE_PLAYABLE_AD="relativePlayableAd",a.REMOTE_PLAYABLE_AD="remotePlayableAd",a.RELATIVE_IEC="relativeIEC",a.REMOTE_IEC="remoteIEC";n.ExternalProtocolFile=class{constructor(e){var t;this._fileStatus=r.NONE,this._rootPath="";const{fileRepository:n,protocolInfo:i}=e;this._fileRepository=n,this._fileInfo={fileName:i.fileName,url:i.downloadUrl,filePath:"",version:i.version,name:i.name,shouldFetchFromCache:null===(t=i.shouldDownload)||void 0===t||t}}fileInfo(){return this._fileInfo}download(){return this._fileStatus=r.DOWNLOADING,this._fileRepository.fetchFile(this._fileInfo).then((e=>(this._fileInfo.filePath=e.filePath,this._rootPath=e.rootPath,this._fileStatus=r.DOWNLOADED,Promise.resolve(this)))).catch((e=>(this._fileStatus=r.FAILED,Promise.reject(this))))}url(e){var t;const n=`${this._rootPath}${this._fileInfo.filePath}`,i=null!==(t=this._fileInfo.url)&&void 0!==t?t:"",r=this._isFlowEligibleFromCache(e,this._fileStatus);return{path:r.decision?n:i,reason:r.reason}}_isFlowEligibleFromCache(e,t){if(!this._fileInfo.shouldFetchFromCache)return{decision:!1,reason:a.FEATURE_DISABLED_BY_FLAG};if(t!==r.DOWNLOADED)return{decision:!1,reason:a.FILE_NOT_DOWNLOADED};if(!this._isRelativePath(e.url))return{decision:!1,reason:a.AD_PLAYER_IN_STREAMING_MODE};if(e.type===i.AdType.PlayableAd){let t=this._isRelativePath(e.videoData.videoSource.htmlURL);return{decision:t,reason:t?a.RELATIVE_PLAYABLE_AD:a.REMOTE_PLAYABLE_AD}}if(e.type===i.AdType.CustomEndCard){let t=this._isRelativePath(e.layoutData.html);return{decision:t,reason:t?a.RELATIVE_IEC:a.REMOTE_IEC}}let n=!0===e.precache;return{decision:n,reason:n?a.RELATIVE_DEFAULT:a.REMOTE_DEFAULT}}_isRelativePath(e){return 0===(null==e?void 0:e.indexOf("../"))}}},{"../../types":229}],104:[function(e,t,n){"use strict";var i,r=e("./ExternalProtocolFile");!function(e){e.MRAID="mraid",e.DAPI="dapi"}(i||(i={}));t.exports={ExternalAdProtocols:class{init({controller:e,config:t,baseFileRepository:n}){const a=t.protocolInfo(i.DAPI);this._controller=e,this.dapiFile=new r.ExternalProtocolFile({protocolInfo:a,fileRepository:n});const o=t.protocolInfo(i.MRAID);this.mraidFile=new r.ExternalProtocolFile({protocolInfo:o,fileRepository:n}),t.shouldDownloadProtocols()&&(this.dapiFile.download(),this.mraidFile.download())}prepareAd(e){var t,n,i,r,a,o;const s=null===(t=this.dapiFile)||void 0===t?void 0:t.url(e),d=null===(n=this.mraidFile)||void 0===n?void 0:n.url(e);e.dapiUrl={url:null!==(i=null==s?void 0:s.path)&&void 0!==i?i:"",reason:null!==(r=null==s?void 0:s.reason)&&void 0!==r?r:""},e.mraidUrl={url:null!==(a=null==d?void 0:d.path)&&void 0!==a?a:"",reason:null!==(o=null==d?void 0:d.reason)&&void 0!==o?o:""},e.isWebWrapper=this._controller.Utils.isWebWrapper(),this._controller.log("PrepareAd | sending external protocol urls | dapiUrl:"+JSON.stringify(s)+" , mraidUrl: "+JSON.stringify(d))}getProtocolURL(e){var t,n,r,a;switch(e){case i.DAPI:return null!==(n=null===(t=this.dapiFile)||void 0===t?void 0:t.fileInfo().url)&&void 0!==n?n:"";case i.MRAID:return null!==(a=null===(r=this.mraidFile)||void 0===r?void 0:r.fileInfo().url)&&void 0!==a?a:"";default:return""}}},ExternalAdProtocolType:i}},{"./ExternalProtocolFile":103}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.exports=function(e){let t=[],n=e.controller;function i(e){let n=t.filter((function(t){return t.getContainerID()===e}));return n.length>0?n[0]:void 0}return{add:function(e){e&&t.push(e)},getAdViewById:i,isExist:function(e){return void 0!==i(e)},removeAdViewById:function(e){let n={};return t=t.filter((function(t){return t.getContainerID()!==e||(n=t,!1)})),n},toArray:function(){return t.slice()},size:function(){return t.length},printAll:function(){t.forEach((function(e){n.log("container  "+e.getContainerID())}))}}}},{}],106:[function(e,t,n){t.exports=function(e,t,n,i,r){var a="AdViewsManager | ";function o(t){return e.log(a+"_getAdViewByAd"),s(t).getAdViewByAd(t)}function s(e){if(d("_getManager"),e)return e.isWPAD?n:t;d("_getManager without ad")}function d(t){e.log(a+t)}return{createAndLoadView:function(i,r,o,s){i.isWPAD?function(e,t,i,r){d("_createAndLoadAdWebView"),n.loadAdUnitUrlToView(e,t,i,r)}(i,r,o,s):function(n,i,r,o){e.log(a+"_createAndLoadFrameView"),t.createAndLoadAdFrame(n,i,r,o)}(i,r,o,s)},displayAdView:function(t,n,i,r){e.log(a+"_displayAdView"),s(t).displayAdView(t,n,i,r)},unloadAdView:function(e){d("_unloadAdView"),e?s(e).unloadAdView(e):d("_unloadAdView | no ad")},updateFrameUrl:function(e,t,n,i){d("_updateFrameUrl"),s(e).updateAdUnitUrl(e,t,n,i)},getContainerState:function(){return d("_getContainerState"),i.getState()},displayContainer:function(e){if(d("_displayContainer"),s(e)===t)return i.display(e);var n=o(e).getContainerID();return i.display(e,n)},hideContainer:function(e){d("_hideContainer"),i.hide(e)},setContainerVisibility:function(e){d("_setContainerVisibility"),i.setVisibility(e)},unloadProductFromContainer:function(){d("_unloadProductFromContainer"),i.unloadProduct()},setContainerBGColorTransparent:function(){d("_setContainerBGColorTransparent"),i.setWebviewBGColorTransparent()},handleScreenVisible:function(e,t){d("_handleScreenVisible"),s(t).handleScreenVisible(e,t)},displayLoader:function(e){if(d("_displayLoader"),r.isDisplayed()){var n=r.get();s(n).displayLoader(e,n)}else t.displayLoader(e)},hideLoader:function(){if(d("_hideLoader"),r.isDisplayed()){var e=r.get();s(e).hideLoader(e)}else t.hideLoader()},isContainerLoaded:function(e){return d("_isContainerLoaded"),s(e).isContainerLoaded(e)},getContainerCreationHandler:function(e){return d("_getContainerCreationHandler"),s(e).getContainerCreationHandler(e)},onAdUnitLoaded:function(t,n,i){e.log(a+"_onAdUnitLoaded"),s(t).onAdUnitLoaded(t,n,i)},getAdViewByAd:o,triggerRedraw:function(){d("_triggerRedraw"),i.redraw()},sendMessageToAdView:function(e,t){return d("_sendMessageToAdView"),t?s(t).sendMessageToDisplayedAdView(e,t):(d("_sendMessage | ad undefined"),!1)},sendMessageToAllAdViews:function(e){d("_sendMessageToAllAdViews"),n.sendMessageToAllAdViews(e),t.sendMessageToAllAdViews(e)},getDisplayedAdView:function(e){return d("_getDisplayedAdView"),s(e).getDisplayedAdView(e)},hideView:function(){var e=r.get();s(e).hideView(e)},displayView:function(){var e=r.get();s(e).displayView(e)},isViewDisplayed:function(e,t){s(t).isViewDisplayed(e)}}}},{}],107:[function(e,t,n){t.exports=function(e,t,n){var i=n.style.backgroundColors;return{setSDKWebviewBGColor:function(t,n){t&&(e.log("ContainerManager | setSDKWebviewBGColor | color: "+t),e.callSDKFunction("setWebviewBackgroundColor",window.SSA_CORE.Utils.extend(n||{},{color:t})))},setControllerBGColor:function(t){t&&(e.log("ContainerManager | setControllerBGColor | color: "+t),document.body.style.background=t)},getSDKWebviewBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return i.transparent;case t.RV:default:return i.black}},getControllerBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return i.transparent;case t.RV:default:return i.darkGrey}},backgroundColors:i}}},{}],108:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s,d="BannerExternalAdViewService | ",l=e("./ExternalAdViewConstants.js"),c=e("./WPADUtils")(n),u=[],p=[],f=l.nativeFunction;function g(){var e=r.get();e&&e.productType&&e.productType===i.BN&&r.reset()}function v(e){return!!e&&(void 0!==e.isOffScreenView?!e.isHidden&&e.isKeyWindow:e.isViewVisible)}function m(e){return e&&e.adViewId}function h(e){var t;return t=!!function(e){return!(A()!==l.nativeFunction||m(e)&&!c.isBannerAdViewId(e.adViewId))}(e)||m(e)&&function(e){n.log("BannerExternalAdViewService | isIdentifierExistInIdsCollection | "+e);for(var t=!1,i=0;!t&&i<p.length;i++)p[i].id===e&&(t=!0);return t}(e.adViewId),n.log("BannerExternalAdViewService | "+A()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function b(e){C("sendMessage | "+JSON.stringify(e));var r=t.PubSub.subscribe(i.CB+"."+l.handleSendMessageFailure,(function(e){h(e)&&(e&&e.errMsg&&n.log("Error calling "+l.handleSendMessageFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r))}));if("string"==typeof e){var a=e.indexOf("$$");-1!==a&&(e=function(e,t){var n={},i=e.substr(t+2),r=i.indexOf("="),a=i.substr(0,r);return n.name=e.substr(0,t),n[a]=i.substr(r+1),n}(e,a))}n.callSDKFunction(A(),{functionName:l.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},l.handleSendMessageSuccess,l.handleSendMessageFailure)}var S=function(e,t){b(e)};function y(){p=[],s=!1}function A(){return f}function C(e){n.log(d+e)}return{init:function(e){s=!0,function(e){if(C("_setNativeServiceApi | "+e),!e)return;C("_setNativeServiceApi | "+e),f=e}(e),n.log("rony BannerExternalAdViewService | _init nativeservice : "+f),u.push(t.PubSub.subscribe(i.CB+"."+l.handleContainerIsVisible,(function(e){h(e)?!e.configs&&e.configs.productType&&e.configs.visibilityParams||(n.log("rony BannerExternalAdViewService | handeling isVisible"),n.log("BannerExternalAdViewService | "+l.handleContainerIsVisible),v(e.configs.visibilityParams)&&t.PubSub.publish(e.configs.productType+".isVisible",[e.configs])):n.log("rony BannerExternalAdViewService | not handeling isVisible")}))),u.push(t.PubSub.subscribe(i.CB+"."+l.handleContainerWasRemoved,(function(e){if(h(e)){n.log("BannerExternalAdViewService | "+l.handleContainerWasRemoved,n.LogLevels.error);for(var i=!1,r=0;!i&&r<p.length;r++)p[r].id===e.configs.externalAdViewId&&(i=!0,p.splice(r,1));i||n.log("BannerExternalAdViewService | "+l.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",n.LogLevels.error),g(),t.PubSub.publish(e.configs.productType+".reset",[e.configs])}}))),u.push(t.PubSub.subscribe(i.CB+"."+l.NativeAPI.linkActivation,(function(e){h(e)&&(n.log("BannerExternalAdViewService |  "+l.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&t.Utils.decodeValues(e),t.PubSub.publish(i.CB+".linkActivationOnAd",[e]))}))),u.push(t.PubSub.subscribe(i.CB+"."+l.handleMessage,(function(e){h(e)&&function(e){try{var i=e.adViewId?e.adViewId:void 0,r=function(e,n){return function(i){var r={data:i,id:e};n&&(r=t.Utils.extend(r,{adViewId:n})),S(r,!0)}}(e.id,i);n.isAndroid()||t.Utils.decodeValues(e.arguments),i&&(e.arguments=t.Utils.extend(e.arguments,{adViewId:i})),e.arguments=t.Utils.extend(e.arguments,{callback:r}),t.PubSub.publish("SDKController."+e.method,[e.arguments])}catch(t){n.log("BannerExternalAdViewService | unable to parse message: "+e,n.LogLevels.error)}}(e)})))},destroy:function(){t.PubSub.clearHandlers(u)},loadWithUrl:function(e,r,a,o,s){C("_loadWithUrl | "+e),n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var d=t.PubSub.subscribe(i.CB+"."+l.handleLoadWithUrlFailure,(function(i){h(i)&&(n.isAdDisplayed(r)?C("_loadWithUrl | isAdDisplayed=true"):(i&&i.errMsg&&(n.log("Error calling "+l.handleLoadWithUrlFailure+" with error "+i.errMsg+" url "+e,n.LogLevels.error),g(),t.PubSub.publish("SDKController.AdLoadError",[i])),t.PubSub.unsubscribe(d),s&&s(!1)))})),c=t.PubSub.subscribe(i.CB+"."+l.handleLoadWithUrlSuccess,(function(e){h(e)&&(s&&s(!0),C(l.handleLoadWithUrlSuccess),t.PubSub.unsubscribe(d),t.PubSub.unsubscribe(c))}));n.callSDKFunction(A(),{functionName:l.NativeAPI.loadWithUrl,functionParams:t.Utils.extend({urlForWebView:e},o)},l.handleLoadWithUrlSuccess,l.handleLoadWithUrlFailure)},updateAd:function(e,r,a,o){n.log("BannerExternalAdViewService | _updateAd | "+JSON.stringify(r));var s={name:"updateAd",param:r};n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var d=t.PubSub.subscribe(i.CB+"."+l.handleUpdateAdFailure,(function(e){h(e)&&(e&&e.errMsg&&n.log("Error calling "+l.handleUpdateAdFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(d))}));n.callSDKFunction(A(),{functionName:l.NativeAPI.updateAd,functionParams:{params:JSON.stringify(s)}},l.handleUpdateAdSuccess,l.handleUpdateAdFailure)},sendMessage:b,isContainerVisible:v,isExternalAdViewInitiated:function(){if(n.log("BannerExternalAdViewService | isExternalAdViewInitiated |"),a&&"pending"===a.status)return a;a=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+l.handleIsInitiated,(function(i){h(i)&&(n.log("BannerExternalAdViewService | "+l.handleIsInitiated+" "+JSON.stringify(i)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),a.resolve(i))})),r=t.PubSub.subscribe(i.CB+"."+l.handleIsInitiatedFailure,(function(i){h(i)&&(i&&i.errMsg&&n.log("Error calling "+l.handleIsInitiatedFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),a.reject(i))}));return n.callSDKFunction(A(),{functionName:l.NativeAPI.isExternalAdViewInitiated},l.handleIsInitiated,l.handleIsInitiatedFailure),a.promise()},addExternalAdViewIdAndSetStatus:function(e){C("_addExternalAdViewIdAndSetStatus");for(var t=e.externalAdViewId,i=e.isInReload,r=!1,a=0;a<p.length;a++){var o=p[a];o.id===t&&(r=!0,o.isInReload=i,C("_addExternalAdViewIdAndSetStatus | changed isInReload to "+i))}r?n.log("BannerExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+t+" has been previously added",n.LogLevels.error):(0!==p.length&&(p=[]),p.push({id:t,isInReload:i}))},getViewVisibility:function(){if(C("_getViewVisibility | banner"),o&&"pending"===o.status)return o;o=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+l.handleGetViewVisibilitySuccess,(function(n){h(n)&&(C(l.handleGetViewVisibilitySuccess+" "+JSON.stringify(n)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),o.resolve(n))})),r=t.PubSub.subscribe(i.CB+"."+l.handleGetViewVisibilityFailure,(function(i){h(i)&&(i&&i.errMsg&&n.log("BannerExternalAdViewService | Error calling "+l.handleGetViewVisibilityFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),o.reject(i))}));return n.callSDKFunction(A(),{functionName:l.NativeAPI.getViewVisibility},l.handleGetViewVisibilitySuccess,l.handleGetViewVisibilityFailure),o.promise()},resetExternalAdViewsIdentifiers:y,removeExternalAdView:function(e,t,i){y(),n.callSDKFunctionWithCallback(A(),{functionName:l.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,i)},getIsServiceInitiated:function(){return C("rony _getIsServiceInitiated: "+s),s}}}},{"./ExternalAdViewConstants.js":112,"./WPADUtils":116}],109:[function(e,t,n){t.exports=function(t,n,i,r){var a="BannerExternalContainer | ",o=e("./WPADUtils")(n),s=!1,d=!1,l=!1,c=!1,u=r,p=[];function f(e){d=e}function g(e){b("_setAdIsVisibleInContainer = "+e),s=e}function v(){return s}function m(){b("_resetReportAdVisibilityFlags"),f(!1),g(!1)}function h(){return b("_shouldReportAdVisible | containerID: "+u+" isAdLoadedInContainer: "+d+" | isAdVisibleInContainer "+s),d&&!s}function b(e){n.log(a+e)}return{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:m,shouldReportAdVisibleForBanners:h,checkStatusOfAdView:function(){if(i.getIsServiceInitiated)return i.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,t,n,r){b("_createAdUrlInAdView "+t.productType),m(),c=!0,i.getIsServiceInitiated&&i.loadWithUrl(e,t,n,r,(function(e){l=e,c=!1}))},updateAdInAdView:function(e,t,n,r){b("_updateAdInAdView "+t.productType),m(),i.getIsServiceInitiated&&i.updateAd(e,t,n,r)},sendMessageToExternalAdView:function(e){e&&u&&(e.adViewId||(e.adViewId=u)),i.getIsServiceInitiated&&i.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){i.getIsServiceInitiated&&i.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(){b("_onExternalViewLoaded isAdVisibleInContainer="+v()),f(!0)},isAdInExternalViewLoaded:function(){return b("isAdInExternalViewLoaded "+d),d},onBannerViewLoaded:function(e,t){f(!0),i.getIsServiceInitiated&&i.getViewVisibility().then((function(n){i&&i.isContainerVisible(n)&&(e(),h()&&t())}))},resetExternalAdViewsIdentifiers:function(){i.getIsServiceInitiated&&i.resetExternalAdViewsIdentifiers()},getContainerID:function(){return b("_getContainerID: "+u),u},removeContainer:function(e,t){i.getIsServiceInitiated&&i.removeExternalAdView(u,e,t)},isVisible:v,isContainerLoaded:function(e){return!0===c&&t.PubSub.publish("BannerExternalContainer.duringCreation",[e]),l},init:function(){p.push(t.PubSub.subscribe("SDKController.AdVisible",(function(e){b("inside adVisibleHandler"),function(e){return b("_shouldRecieveMessage containerID: "+u+" adViewId: "+e.adViewId),!(!o.isBannerAd(e)||!o.isBannerAdViewId(u))||e.adViewId===u}(e)&&(b("got SDKController.AdVisible | setting visibility to true"),g(!0))})))},clean:function(){b("_clean"),t.PubSub.clearHandlers(p),i.getIsServiceInitiated&&i.destroy(),i=null}}}},{"./WPADUtils":116}],110:[function(e,t,n){t.exports=function({core:t,controller:n,constants:i,demandSourceId:r,originalDemandSourceName:a,controllerAnalytics:o,analyticsCategories:s}){e("./ExternalAdViewConstants.js");var d="BannerHandlerDelegate | ",l=i.BN,c=[],u="";function p(e){e.productType=l,e.demandSourceName=r,e.originalDemandSourceName=a}function f(e){n.log(d+e)}return{assignAdViewAndStartHandle:function(e){f("_assignAdViewAndStartHandle: "+e),e&&(u=e,c.push(t.PubSub.subscribe("removed."+u,(function(e){p(e),f("handle banner removed with id: "+e.adViewId+"for instance id: "+e.demandSourceId),t.PubSub.publish(i.BN+".removed."+e.demandSourceName,[])}))),c.push(t.PubSub.subscribe("isVisible."+u,(function(e){(p(e),!e.configs&&e.configs.productType&&e.configs.visibilityParams)||(f("handle banner visible with id: "+e.adViewId+"for instance id: "+e.demandSourceId),function(e){if(!e)return!1;if(void 0!==e.isOffScreenView)return!e.isHidden&&e.isKeyWindow;return e.isViewVisible}(e.configs.visibilityParams)&&e.productType===i.BN&&(!1===e.configs.visibilityParams.isViewHierarchyVisible&&o.report(s.bannerLoadedNotVisible),t.PubSub.publish(i.BN+".isVisible."+e.demandSourceName,[])))}))),c.push(t.PubSub.subscribe("destroy."+u,(function(e){p(e),f("handle banner destroy with id: "+e.adViewId+"for instance id: "+e.demandSourceId),e.isBNAutoRemove||t.PubSub.publish(i.BN+".destroy."+e.demandSourceName,[])}))),c.push(t.PubSub.subscribe("destroy."+r,(function(){t.PubSub.publish("destroy."+u,[{adViewId:u}])}))))},stopHandle:function(){f("stopHandle: "+u),t.PubSub.clearHandlers(c)}}}},{"./ExternalAdViewConstants.js":112}],111:[function(e,t,n){t.exports=function(e){var t,n={notCreated:0,duringCreation:1,createdSuccessfully:2,failedToCreate:3},i=n.notCreated,r=new window.jQuery.Deferred,a="failed to create native webview";function o(e){e!==i?(s("setState - new state: "+e),i=e,function(e){if(s("updatePromiseOnStateChange: "+e),"pending"!==r.state())return void s("updatePromiseOnStateChange - not in pending state - ignoring");e===n.createdSuccessfully?r.resolve():e===n.failedToCreate&&r.reject(a)}(e)):s("setState - already in state: "+e)}function s(t){e("ContainerCreationStateHandler | "+t)}return{getState:function(){return i},setState:o,getCreationStates:function(){return n},getCreationResultPromise:function(){return r.promise()},creationStarted:function(e){s("creationStarted"),o(n.duringCreation),t=setTimeout((function(){s("creation ended because of timeout"),o(n.failedToCreate)}),e||3e3)},creationEnded:function(e){s("creationEnded with result: "+e),clearTimeout(t),o(e?n.createdSuccessfully:n.failedToCreate)}}}},{}],112:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility",removeAdView:"removeAdView",linkActivation:"linkActivation"},nativeFunction:"bannerViewAPI",nativeFunctionAdViewAPI:"adViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",performDestroyDisplayBanner:"performDestroyDisplayBanner",destroyBanner:"destroyBanner",cleanUpNonDisplayBanners:"cleanUpNonDisplayBanners",isBNAutoRemove:"isBNAutoRemove",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],113:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s,d="ExternalAdViewService | ",l=e("../../constants/SDKFeatureNames"),c=e("./ExternalAdViewConstants.js"),u=e("./bannerLoadWhileShowHandler"),p=e("./WPADUtils")(n),f=[],g=c.nativeFunction;function v(){var e=r.get();e&&e.productType&&e.productType===i.BN&&r.reset()}function m(e){return!!e&&(void 0!==e.isOffScreenView?!e.isHidden&&e.isKeyWindow:e.isViewVisible)}function h(e){return e&&e.adViewId}var b={handleVisible:function(e){!function(e){var r=e.configs;!r&&r.productType&&r.visibilityParams||(n.log("ExternalAdViewService | "+c.handleContainerIsVisible),m(r.visibilityParams)&&r.productType===i.BN&&t.PubSub.publish(r.productType+".isVisible",[r]))}(e)},handleRemoved:function(e){n.log("ExternalAdViewService | bannerSingleInstancesHandler | "+c.handleContainerWasRemoved,n.LogLevels.error),v(),t.PubSub.publish(e.configs.productType+".reset",[e.configs])},handlePerformDestroy:function(e){n.log("ExternalAdViewService | bannerSingleInstancesHandler | handlePerformDestroy")}};function S(){return n.CompatibilityService.isFeatureSupportedInNativeSDK(l.bannerMultipleInstances)?u(t,n):b}function y(e){if(function(e){return P()===c.nativeFunction&&(!h(e)||p.isBannerAdViewId(e.adViewId))}(e))return!0;var t=h(e)&&F()===e.adViewId;return n.log("ExternalAdViewService | "+P()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function A(e){return{shouldUseOffScreenViewInWebPresenter:C(e),shouldUseOffScreenViewInAdContainer:I(e)}}function C(e){const t=function(e){return e.shouldCreateContainer?function(e){if(e&&null!=e.setBannerOffScreenViewWebP)return e.setBannerOffScreenViewWebP;return!1}(e):function(e){if(e&&null!=e.setFullScreenOffScreenViewWebP)return e.setFullScreenOffScreenViewWebP;return!0}(e)}(e);return null==t||t}function I(e){const t=function(e){if(e&&null!=e.setBannerOffScreenView)return e.setBannerOffScreenView;return}(e);return void 0!==t?t:parseFloat(n.getConfig().mobileSDKSettings.deviceOSVersion)<=i.offScreenViewConfig.maximalVersionToSupport}function w(e){O("sendMessage | "+JSON.stringify(e));var r=t.PubSub.subscribe(i.CB+"."+c.handleSendMessageFailure,(function(e){y(e)&&(e&&e.errMsg&&n.log("Error calling "+c.handleSendMessageFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r))}));if("string"==typeof e){var a=e.indexOf("$$");-1!==a&&(e=function(e,t){var n={},i=e.substr(t+2),r=i.indexOf("="),a=i.substr(0,r);return n.name=e.substr(0,t),n[a]=i.substr(r+1),n}(e,a))}n.callSDKFunction(P(),{functionName:c.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},c.handleSendMessageSuccess,c.handleSendMessageFailure)}var D=function(e,t){w(e)};function P(){return g}function F(){return s}function O(e){n.log(d+e)}return{init:function(e,r){!function(e){if(O("_setNativeServiceApi | "+e),!e)return;g=e}(e),function(e){if(O("_setAdViewId | "+e),!e)return;s=e}(r),f.push(t.PubSub.subscribe(i.CB+"."+c.handleContainerIsVisible,(function(e){y(e)&&S().handleVisible(e)}))),f.push(t.PubSub.subscribe(i.CB+"."+c.handleContainerWasRemoved,(function(e){y(e)&&S().handleRemoved(e)}))),f.push(t.PubSub.subscribe(i.CB+"."+c.destroyBanner,(function(e){y(e)&&S().handlePerformDestroy(e)}))),f.push(t.PubSub.subscribe(i.CB+"."+c.NativeAPI.linkActivation,(function(e){y(e)&&(n.log("ExternalAdViewService |  "+c.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&t.Utils.decodeValues(e),t.PubSub.publish(i.CB+".linkActivationOnAd",[e]))}))),f.push(t.PubSub.subscribe(i.CB+"."+c.handleMessage,(function(e){y(e)&&function(e){try{var i=e.adViewId?e.adViewId:void 0,r=function(e,n){return function(i){var r={data:i,id:e};n&&(r=t.Utils.extend(r,{adViewId:n})),D(r,!0)}}(e.id,i);n.isAndroid()||t.Utils.decodeValues(e.arguments),e.arguments=t.Utils.extend(e.arguments,{callback:r}),i&&(e.arguments=t.Utils.extend(e.arguments,{adViewId:i})),t.PubSub.publish("SDKController."+e.method,[e.arguments])}catch(t){n.log("ExternalAdViewService | unable to parse message: "+e,n.LogLevels.error)}}(e)})))},destroy:function(){t.PubSub.clearHandlers(f)},loadWithUrl:function(e,r,a,o,s){O("_loadWithUrl | "+e),n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var d=t.PubSub.subscribe(i.CB+"."+c.handleLoadWithUrlFailure,(function(i){y(i)&&(n.isAdDisplayed(r)?O("_loadWithUrl | isAdDisplayed=true"):(i&&i.errMsg&&(n.log("Error calling "+c.handleLoadWithUrlFailure+" with error "+i.errMsg+" url "+e,n.LogLevels.error),n.isBannerMultipleInstances(a.productType)||v(),t.PubSub.publish("SDKController.AdLoadError",[i])),t.PubSub.unsubscribe(d),s&&s(!1)))})),l=t.PubSub.subscribe(i.CB+"."+c.handleLoadWithUrlSuccess,(function(e){y(e)&&(s&&s(!0),O(c.handleLoadWithUrlSuccess),t.PubSub.unsubscribe(d),t.PubSub.unsubscribe(l))}));n.callSDKFunction(P(),{functionName:c.NativeAPI.loadWithUrl,functionParams:t.Utils.extend({urlForWebView:e},o,A(o))},c.handleLoadWithUrlSuccess,c.handleLoadWithUrlFailure)},updateAd:function(e,r,a,o){n.log("ExternalAdViewService | _updateAd | "+JSON.stringify(r));var s={name:"updateAd",param:r};n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var d=t.PubSub.subscribe(i.CB+"."+c.handleUpdateAdFailure,(function(e){y(e)&&(e&&e.errMsg&&n.log("Error calling "+c.handleUpdateAdFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(d))}));n.callSDKFunction(P(),{functionName:c.NativeAPI.updateAd,functionParams:{params:JSON.stringify(s)}},c.handleUpdateAdSuccess,c.handleUpdateAdFailure)},sendMessage:w,isContainerVisible:m,isExternalAdViewInitiated:function(){if(n.log("ExternalAdViewService | isExternalAdViewInitiated |"),a&&"pending"===a.status)return a;a=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+c.handleIsInitiated,(function(i){y(i)&&(n.log("ExternalAdViewService | "+c.handleIsInitiated+" "+JSON.stringify(i)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),a.resolve(i))})),r=t.PubSub.subscribe(i.CB+"."+c.handleIsInitiatedFailure,(function(i){y(i)&&(i&&i.errMsg&&n.log("Error calling "+c.handleIsInitiatedFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),a.reject(i))}));return n.callSDKFunction(P(),{functionName:c.NativeAPI.isExternalAdViewInitiated},c.handleIsInitiated,c.handleIsInitiatedFailure),a.promise()},getViewVisibility:function(){if(O("_getViewVisibility | external container"),o&&"pending"===o.status)return o;if(o=new window.jQuery.Deferred,F()){var e=t.PubSub.subscribe(i.CB+"."+c.handleGetViewVisibilitySuccess,(function(n){y(n)&&(O(c.handleGetViewVisibilitySuccess+" "+JSON.stringify(n)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),o.resolve(n))})),r=t.PubSub.subscribe(i.CB+"."+c.handleGetViewVisibilityFailure,(function(i){y(i)&&(i&&i.errMsg&&n.log("ExternalAdViewService | Error calling "+c.handleGetViewVisibilityFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),o.reject(i))}));return n.callSDKFunction(P(),{functionName:c.NativeAPI.getViewVisibility,functionParams:{adViewId:F()}},c.handleGetViewVisibilitySuccess,c.handleGetViewVisibilityFailure),o.promise()}o.reject({errMsg:"adViewId is missing"})},removeExternalAdView:function(e,t,i){n.callSDKFunctionWithCallback(P(),{functionName:c.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,i)},setBannerHandlerDelegate:function(e){e}}}},{"../../constants/SDKFeatureNames":133,"./ExternalAdViewConstants.js":112,"./WPADUtils":116,"./bannerLoadWhileShowHandler":119}],114:[function(e,t,n){var i=e("./ContainerCreationStateHandler"),r=e("./WPADUtils");t.exports=function(e,t,n,a){var o="ExternalContainer | ",s=new r(t),d=new i(t.log),l=!1,c=!1,u=a,p=null,f=[];function g(e){c=e}function v(e){S("_setAdIsVisibleInContainer = "+e),l=e}function m(){return l}function h(){S("_resetReportAdVisibilityFlags"),g(!1),v(!1)}function b(){return S("_getContainerID: "+u),u}function S(e){t.log(o+e)}return f.push(e.PubSub.subscribe("SDKController.AdVisible",(function(e){S("inside adVisibleHandler"),function(e){return S("_shouldReceiveMessage containerID: "+u+" adViewId: "+e.adViewId),!(!s.isBannerAd(e)||!s.isBannerAdViewId(u))||e.adViewId===u}(e)&&(S("got SDKController.AdVisible | setting visibility to true"),v(!0))}))),{setAdIsVisibleInContainer:v,resetReportAdVisibilityFlags:h,createAdUrlInAdView:function(t,i,r,a){S("_createAdUrlInAdView "+i.productType),h(),function(t){t.shouldCreateContainer=function(t){if(!e.Utils.isDefined(t.adSize))return!1;if(!e.Utils.isDefined(t.adSize.width)||!e.Utils.isDefined(t.adSize.height))return!1;return t.adSize.width>0&&t.adSize.height>0}(t)}(a),p&&p.assignAdViewAndStartHandle(b()),function(t){if(t||!t.productType)var n=e.PubSub.subscribe(t.productType+".GetConfig",(function(t){t.adViewId&&t.adViewId===u&&(e.PubSub.unsubscribe(n),d.creationEnded(!0))}))}(i),d.creationStarted(),n.loadWithUrl(t,i,r,a,(function(){S("native reported on webview creation")}))},sendMessageToExternalAdView:function(e){e&&u&&(e.adViewId||(e.adViewId=u)),n.sendMessage(e)},onExternalViewLoaded:function(e,t,i){g(!0),S("_onExternalViewLoaded"),e.displayOnAdReady&&n.getViewVisibility().then((function(e){n&&n.isContainerVisible(e)&&(m()||i())}))},isAdInExternalViewLoaded:function(){return S("isAdInExternalViewLoaded "+c),c},getContainerID:b,removeContainer:function(e,t){n.removeExternalAdView(u,e,t)},isVisible:m,isContainerLoaded:function(){return d.getState()===d.getCreationStates().createdSuccessfully},clean:function(){S("_clean"),e.PubSub.clearHandlers(f),p&&(p.stopHandle(),p=null),n.destroy(),n=null},getContainerCreationHandler:function(){return d},shouldReportAdVisible:function(){return c&&!l},setAdInstanceHandler:function(e){p=e}}}},{"./ContainerCreationStateHandler":111,"./WPADUtils":116}],115:[function(e,t,n){t.exports=function(e,t,n){var i={none:0,device:1,controller:2};function r(r,a,o,s){e.isIOS()&&(document.body.style.height=a.scrollHeight),n.setBackgroundColorByMode("Neutral",o),t.displayView(),e.callSDKFunction("setBackButtonState",{state:i.controller}),r(!1,!1,null),s();var d=document.getElementById("ssaNavigator");d.classList.remove("webNavigation"),d.classList.add("defaultNavigation"),e.isIOS()&&setTimeout((function(){e.callSDKFunction("navigationModeChange",{state:!1})}),70)}return{changeToNavigationMode:function(a,o,s,d,l){document.body.style.height="",n.setBackgroundColorByMode("Navigation","WebControls"),t.hideView(),t.hideLoader(),e.callSDKFunction("setBackButtonState",{state:i.device}),a(!1,null),function(t,n,i,a,o){function s(t){t.stopPropagation(),t.preventDefault(),e.callSDKFunction("removeCloseEventHandler"),e.callSDKFunction("controlSecondaryWebView",{action:"back"})}e.JQWrapper.bind(n,"touchend",(function(n){n.stopPropagation(),n.preventDefault(),e.JQWrapper.unbind(document.getElementById("ssaNavigatorBackButton"),"touchend",s),e.callSDKFunction("removeCloseEventHandler"),e.callSDKFunction("controlSecondaryWebView",{action:"close"}),r(t,i,a,o)})),e.JQWrapper.bind(document.getElementById("ssaNavigatorBackButton"),"touchend",s)}(a,o,s,d,l);var c=document.getElementById("ssaNavigator");c.classList.remove("defaultNavigation"),c.classList.add("webNavigation"),e.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:r}}},{}],116:[function(e,t,n){t.exports=function(t){var n=e("../../constants/SDKFeatureNames"),i=e("../../components/Constants.js"),r=e("../../components/OMIDConstants"),a="bannerAdView";function o(e){return e.productType===i.BN}return{generateAdViewId:function(e){return t.isBannerNoneLWS(e.productType)?a:t.AdUtils.generateUniqueAdId(e)},generateBannerAdViewId:function(){return i.bannerAdViewId},isBannerAdViewId:function(e){return-1!==e.indexOf(i.bannerAdViewId)},shouldDisplayAdOnExternalWebView:function(e,i){if(t.log("_shouldDisplayAdOnExternalWebView"),t.Utils.isWebWrapper())return!1;if(o(e))return!0;if(t.OMIDService.isAdOmidSupported(e)){var a=(s=t.OMIDService.getVersionData().omidVersion)&&r.omidVersionRequiresWebviewPerAd[s];return t.log("_shouldDisplayAdOnExternalWebView - OMID Ad - requires WPAD: "+a),a}var s;return function(e){return e&&!0===e.webviewPerAd}(i)?t.CompatibilityService.isFeatureSupportedInNativeSDK(n.webviewPerAdV1)?!i||0!==i.numOfBannersToInitSuccess||0!==i.numOfBannersToCache||(t.log("_shouldDisplayAdOnExternalWebView - numOfBannersToInitSuccess 0 , numOfBannersToCache 0"),!1):(t.log("_shouldDisplayAdOnExternalWebView - not supported for sdk version"),!1):(t.log("_shouldDisplayAdOnExternalWebView - wpad flag is off"),!1)},isBannerAd:o,getBannerAdViewId:function(){return a}}}},{"../../components/Constants.js":40,"../../components/OMIDConstants":72,"../../constants/SDKFeatureNames":133}],117:[function(e,t,n){t.exports=function(e,t,n,i,r,a){var o="Webview | ",s=!1,d=!1,l=!1,c=null,u={on:!1,productConfig:null};function p(){h("state- open: "+s+", viewable: "+d+"engaged "+l+" , productConfig: "+JSON.stringify(c))}function f(n,i){if(h("received event: "+n+" sendCloseRequest: "+JSON.stringify(u)),"close"===n&&v(i)){var r=t.DemandUtils.extendCallbackParamsWithParentProductConfig(i);e.PubSub.publish("SDKController.onAdWindowsClosed",[r]),t.callSDKFunction("onAdWindowsClosed",r)}}function g(){t.callSDKFunction("setForceClose",n.disable)}function v(e){return u.on&&u.productConfig===e?(u.on=!1,u.productConfig=null,p(),!0):(p(),!1)}function m(e){c=t.DemandUtils.extendCallbackParamsWithParentProductConfig(e,{}),l=!0,p()}function h(e){t.log(o+e)}return{setBackgroundColorByMode:function(e,t){"Navigation"===e?(r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(t)),r.setControllerBGColor(r.getControllerBGColorByProductType(t))):"Neutral"===e&&(r.setControllerBGColor(r.getControllerBGColorByProductType(t)),r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(t)))},display:function(n,o){if(n){if(t.isAndroid()||!s&&!d){var c=a.getAdDisplayOrientation(t.getConfig(),n);t.OrientationService.setOrientation(c)}else h("avoiding setOrientation for new displayed ad");if(s||d)return h("be might here because of next offer, engaged is "+l),void(l=!0);var u,f;f={adViewId:o},(u=n)&&u.productType?t.getNotchService().onSetConfig(u)?(r.setSDKWebviewBGColor(r.backgroundColors.semiTransparent,f),r.setControllerBGColor(r.backgroundColors.semiTransparent)):u.settings.setContainerBGColorBlack?r.setControllerBGColor(r.backgroundColors.black):(r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(u.productType),f),r.setControllerBGColor(r.getControllerBGColorByProductType(u.productType))):r.setControllerBGColor(r.backgroundColors.darkGrey),g(),m(n),t.ViewsManager.init(n,o);var v=t.DemandUtils.extendCallbackParamsWithParentProductConfig(n,t.ViewsManager.getDisplayWebViewParams(!0)),b=function(n){var r={};if(t.isAndroid()){var a=n.settings&&n.settings.immersive;(r=e.Utils.extend(r,{immersive:a})).activityThemeTranslucent=!!n.settings.translucentView,r.removeViewOnDestroy=!0,n.settings.sambsfix&&(h("ctrWVPauseResume=true"),r.ctrWVPauseResume=!0)}return t.isIOS()&&(r=e.Utils.extend(r,{appOrientation:t.AppOrientationManager.getOrientation(),ModalPresentationStyle:i.iOS_UIModalPresentationFullScreen})),r}(n);h("display platformParams: "+JSON.stringify(b)),h("display displayParams: "+JSON.stringify(v));var S=e.Utils.extend(b,v,{});t.callSDKFunction(i.nativeInterfaceMethod.displayWebView,S),s=!0,p()}},hide:function(){s&&function(){var n,r=new window.jQuery.Deferred;t.log("webview | hide | "+JSON.stringify(c),t.LogLevels.verbose);var a=t.DemandUtils.extendCallbackParamsWithParentProductConfig(c,t.ViewsManager.getDisplayWebViewParams(!1));return n=e.PubSub.subscribe(i.CB+"."+i.nativeCallBacks.hideSuccess,(function(){e.PubSub.unsubscribe(n),r.resolve()})),t.callSDKFunction(i.nativeInterfaceMethod.displayWebView,a,i.nativeCallBacks.hideSuccess,i.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),r.promise()}().then((function(){s=!1,u.productConfig=c,u.on=!0,p(),l||f("close",c)}))},setVisibility:function(e){d=e,p()},shouldNotifyClose:v,loadProduct:m,unloadProduct:function(){l=!1,p(),u.on&&f("close",c)},disableForceClose:g,setWebviewBGColorTransparent:function(){r.setControllerBGColor(r.backgroundColors.transparent)},setControllerBGColor:function(e){r.setControllerBGColor(r.getControllerBGColorByProductType(e))},getState:function(){return{engaged:l,opened:s,productConfig:c,viewable:d,standalone:false}},redraw:function(){t.isAndroid()&&t.getConfigurationHelper().getDeviceApiLevel()>=20&&(r.setSDKWebviewBGColor(r.backgroundColors.black),r.setSDKWebviewBGColor(r.backgroundColors.transparent))}}}},{}],118:[function(e,t,n){var i=e("./ExternalContainer"),r=e("./ExternalAdViewService"),a=e("./ExternalAdViewConstants"),o=e("./AdViewsCollections"),s=e("./BannerHandlerDelegate");t.exports=function(t,n,d,l,c,u){var p="WebViewManager | ",f=e("./WPADUtils")(n),g=new o({controller:n});function v(e){if(e)return m("_getAdViewByAd "+e.adViewId),g.getAdViewById(e.adViewId)}function m(e){n.log(p+e)}return{loadAdUnitUrlToView:function(e,o,v,h){if(function(e){t.PubSub.subscribe(e.productType+".reset",(function(e){m("webViewManager | reset"),g.toArray().forEach((function(e){e.getContainerID()===f.getBannerAdViewId()&&(g.removeAdViewById(e.getContainerID()),e.clean())}))}))}(e),n.log(p+"_loadAdUnitUrlToView"),o&&e){var b=function(e){var o=new r(t,n,d,l);e.adViewId=f.generateAdViewId(e),n.isBannerNoneLWS(e.productType)?o.init(a.nativeFunction,e.adViewId):o.init(a.nativeFunctionAdViewAPI,e.adViewId);return new i(t,n,o,e.adViewId)}(e);e=function(e,n){return e=t.Utils.extend(e,{adViewId:n}),e}(e,b.getContainerID()),g.add(b);var S=function(e,n){return e=t.Utils.extend(e,{adViewId:n}),e}(h,b.getContainerID());S=function(e,n){n.adSize&&(e=t.Utils.extend(e,{adSize:n.adSize}));return e}(S,e);var y=function(e,t){return e+"&"+d.adViewIdString+"="+t}(o,b.getContainerID());!function({productType:e,demandSourceId:i,originalDemandSourceName:r,externalContainer:a}){if(m("assignAdInstanceHandlerToExternalContainer | id: "+a.getContainerID()),!a)return;if(n.isBannerMultipleInstances(e)){var o=new s({core:t,controller:n,constants:d,demandSourceId:i,originalDemandSourceName:r,controllerAnalytics:c,analyticsCategories:u});a.setAdInstanceHandler(o)}}({productType:e.productType,demandSourceId:e.demandSourceId,originalDemandSourceName:e.originalDemandSourceName,externalContainer:b}),b.createAdUrlInAdView(y,e,v,S)}else m("_loadAdUnitUrlToView without ad/url")},updateAdUnitUrl:function(e,t,n,i){},displayAdView:function(e,t,n,i){m("_displayAdView"),l.set(e),window.jQuery.when(i(e)).then((function(){m("_displayView after adunitOpenCallback"),t(!1),n()})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)}))},handleScreenVisible:function(e,t){m("_handleScreenVisible");var n=v(t);n.sendMessageToExternalAdView({message:"handleScreenVisible",adViewId:n.getContainerID()})},unloadAdView:function(e){m("_unloadAdView "+e.adViewId);var n=v(e);if(n){n.removeContainer((function(e){if(e&&e.adViewId===n.getContainerID()){m("_unloadAdView | successCallback | removed id"+e.adViewId);var i=g.removeAdViewById(n.getContainerID());t.Utils.isEmptyObject(i)||i.clean()}}),(function(e){if(e&&e.adViewId===n.getContainerID()){t.PubSub.publish("SDKController.removeContainerError",[e]),m("_unloadAdView | failCallback | id"+e.adViewId);var i=g.removeAdViewById(n.getContainerID());t.Utils.isEmptyObject(i)||i.clean()}}))}else m("_unloadAdView | ad is not engaged / no external container")},displayLoader:function(e){m("_displayLoader");var t=v(e);t&&t.sendMessageToExternalAdView({message:"displayLoader",adViewId:t.getContainerID()})},hideLoader:function(e){m("_hideLoader");var t=v(e);t&&t.sendMessageToExternalAdView({message:"hideLoader",adViewId:t.getContainerID()})},hideView:function(e){m("_hideView ad: "+JSON.stringify(e));var t=v(e);t&&t.sendMessageToExternalAdView({message:"hideFrame",adViewId:t.getContainerID()})},displayView:function(e){m("_displayView ad: "+JSON.stringify(e));var t=v(e);t&&t.sendMessageToExternalAdView({message:"displayFrame",adViewId:t.getContainerID()})},isContainerLoaded:function(e){var t=v(e),n=!!t&&t.isContainerLoaded();return m("_isContainerLoaded: "+n),n},onAdUnitLoaded:function(e,t,n){m("_onAdUnitLoaded");var i=v(e);i&&(i.isAdInExternalViewLoaded()?m("already received the loaded event for container"):(i.onExternalViewLoaded(e,t,n),m("ad loaded:"+e.id)))},isAdViewExistForAd:function(e){return m("_isAdViewExistForAd"),!!e&&g.isExist(e.adViewId)},getAdViewByAd:v,sendMessageToDisplayedAdView:function(e,t){m("_sendMessageToDisplayedAdView");var n=v(t);n&&n.sendMessageToExternalAdView(e)},sendMessageToAllAdViews:function(e){m("_sendMessageToAllAdViews"),g.toArray().forEach((function(t){t.sendMessageToExternalAdView(e)}))},getDisplayedAdView:function(e){m("_getDisplayedAdView ad: "+JSON.stringify(e));var t=v(e);return t&&(m("external container visible="+t.isVisible()),t.isVisible())?t:null},isViewDisplayed:function(e){return e.isVisible()},getContainerCreationHandler:function(e){var t=v(e);return t?t.getContainerCreationHandler():null}}}},{"./AdViewsCollections":105,"./BannerHandlerDelegate":110,"./ExternalAdViewConstants":112,"./ExternalAdViewService":113,"./ExternalContainer":114,"./WPADUtils":116}],119:[function(e,t,n){const i=e("./ExternalAdViewConstants.js");t.exports=function(e,t){return{handleVisible:function(n){n.adViewId&&(t.log("ExternalAdViewService | bannerMultipleInstancesHandler| handleVisible: isVisible."+n.adViewId,t.LogLevels.error),e.PubSub.publish("isVisible."+n.adViewId,[n]))},handleRemoved:function(n){n.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | "+i.handleContainerWasRemoved,t.LogLevels.error),e.PubSub.publish("removed."+n.adViewId,[n]))},handlePerformDestroy:function(n){n.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | handlePerformDestroy params.adViewId="+n.adViewId),e.PubSub.publish("destroy."+n.adViewId,[n]))}}}},{"./ExternalAdViewConstants.js":112}],120:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.UADS="uads",e.IADS="iads",e.SHRD="shared"}(i||(i={}));const r={CB:"NativeCallback",nativeFunction:"dsSharedSignalsAPI",nativeAPI:{getSharedSignal:"getSharedSignal",setSharedSignal:"setSharedSignal"},callbacks:{getSharedSignalSuccess:"getSharedSignalSuccess",getSharedSignalFail:"getSharedSignalFail",setSharedSignalSuccess:"setSharedSignalSuccess",setSharedSignalFail:"setSharedSignalFail"},errorLog:"DSSignals | error: "};t.exports={DSSignals:class{constructor(e,t){this.core=e,this.controller=t}createDeferredHandlers(e,t){let n,i;const a=new Promise(((e,t)=>{n=e,i=t})),o=this.core.PubSub.subscribe(r.CB+"."+e,(e=>{this.core.PubSub.clearHandlers([o,s]),n(e)})),s=this.core.PubSub.subscribe(r.CB+"."+t,(e=>{let t=r.errorLog+":";t+=e&&e.errMsg?e.errMsg:"",this.controller.log(t,this.controller.LogLevels.error),this.core.PubSub.clearHandlers([o,s]),i({errMsg:t})}));return{promise:a,successHandler:o,failureHandler:s}}setSharedSignal(e,t,n){const{promise:i}=this.createDeferredHandlers(r.callbacks.setSharedSignalSuccess,r.callbacks.setSharedSignalFail);return this.controller.callSDKFunction(r.nativeFunction,{functionName:r.nativeAPI.setSharedSignal,functionParams:{source:e,key:t,data:n}},r.callbacks.setSharedSignalSuccess,r.callbacks.setSharedSignalFail),i}getSharedSignal(e,t){const{promise:n}=this.createDeferredHandlers(r.callbacks.getSharedSignalSuccess,r.callbacks.getSharedSignalFail);return this.controller.callSDKFunction(r.nativeFunction,{functionName:r.nativeAPI.getSharedSignal,functionParams:{source:e,key:t}},r.callbacks.getSharedSignalSuccess,r.callbacks.getSharedSignalFail),n}},SourceType:i,constants:r}},{}],121:[function(e,t,n){t.exports=function(t,n,i){var r,a,o=e("../OrientationUtils.js")(),s=i.appInfo.orientation.none,d=!1,l={free:i.appInfo.orientation.none,portrait:i.appInfo.orientation.portrait,landscape:i.appInfo.orientation.landscape};function c(e,t,n){d=!1;var i=l[(e||"").toLowerCase()];if(i)return d=!0,i;if(!n)return t;var r=n.viewControllerToPresentFrom||n.topMostViewControllerOrientation,a=o.sharedOrientationBetweenOrientations(r,n.windowOrientation),s=function(e){if(o.isContainPortrait(e)&&o.isContainLandscape(e))return l.free;return o.isContainPortrait(e)?l.portrait:l.landscape}((a&&a.length>0?o.convertOrientationsArrayToNumber(a):r||n.windowOrientation).toString());return s!==t&&(d=!0),s}function u(e,t){return"landscape"===e&&t}function p(e,n){e!==n&&t.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:n}])}return{init:function(t,i){var o=new(e("../../patches/PublisherPatchEasybrain.js"))(n.getConfigurationHelper()).shouldSetAppOrientationPortrait;r=o(n.getConfig())?l.portrait:t,a=i.appOrientation,s=c(r,a,i.orientationRestriction)},getOrientation:function(){return s},isAppOrientation:function(e){return s===e},isChangedExternally:function(){return d},updateAppOrientationByNewRestriction:function(e){e&&p(s,s=c(r,a,e))},forceNativeAppOrientationIfNeeded:function(e){u(s,e)&&p(s,"free")},unForceNativeAppOrientationIfNeeded:function(e){u(s,e)&&p("free",s)}}}},{"../../patches/PublisherPatchEasybrain.js":224,"../OrientationUtils.js":80}],122:[function(e,t,n){function i(e,t,n){var i=n||{},r,a=!1,o=t.Cache,s={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},d=!1,l=!1;function c(e){d=e}function u(e,t,n){return o.cacheAds(i,e,t,n)}function p(e){r=e}function f(n){c(!0),u(n.applicationKey,n.newAdsToEnterCache,n.adAssetsCacheConfig).then((function(){t.log("PM | success",t.LogLevels.verbose),a||(t.log("cache update completed",t.LogLevels.verbose),c(!1),e.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[i]))}),(function(t,r,o){if(!a){c(!1),e.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:i.productType,demandSourceName:i.demandSourceName,deletedOffers:r,deletedAdsData:o,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:t,inventoryId:n.inventoryId}])}}))}function g(n){t.log("PrecacheManager | updateConfig"),i=e.Utils.extend(i,n)}function v(t){var n=t.numOfCampaigns||0,r=t.settings||{};return g({settings:r}),r.numOfBannersToInitSuccess>=0&&n>0&&r.numOfBannersToCache>0?(r.numOfBannersToCache<r.numOfBannersToInitSuccess&&(r.numOfBannersToInitSuccess=r.numOfBannersToCache),n<r.numOfBannersToInitSuccess&&(r.numOfBannersToInitSuccess=n),n<r.numOfBannersToCache&&(r.numOfBannersToCache=n),p(!0),r.maxCachedCampaigns=i.maxCachedCampaigns,o.setSettings(i,r)):(r.numOfBannersToInitSuccess=r.numOfBannersToCache=0,p(!1)),e.Utils.returnResolvedPromise()}function m(e){return e&&e.cacheBase===i.cacheBase}function h(){e.PubSub.subscribe("Cache.cacheUpdated",(function(t){m(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[t]))})),e.PubSub.subscribe("Cache.campaignDeleted",(function(t){m(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.campaignDeletedCallback",[t]))})),e.PubSub.subscribe("Cache.campaignSaved",(function(t){if(m(t)){var n=e.Utils.extend(!0,{},t,i);e.PubSub.publish("PrecacheManager.campaignSavedCallback",[n])}})),e.PubSub.subscribe("Cache.campaignDownloadStarted",(function(t){m(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[t]))})),e.PubSub.subscribe("Cache.preProcessingFailed",(function(t){m(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[t]))}))}function b(){return r}function S(){var e,n,r=new window.jQuery.Deferred,a=b();function d(e){r.resolve(e)}return i.settings.purgeCacheOnInit?(n="purge cache on init (settings)",e=!0):a||(n="purge cache on non-precache",e=!0),e?(t.log("handleCacheClear purge reason: "+n,t.LogLevels.verbose),o.clearCacheByType(i,[]).then(d.bind(null,s.campaignsOnly),(function(){r.reject("Error in clearing cache")}))):d(),r.promise()}function y(n){b()&&(c(!0),o.cacheNext(i,n).always((function(){c(!1)})).fail((function(n,r,a){t.log("line[451]: failed updating cache on cache next with deletedAds: "+r,t.LogLevels.verbose),r&&r.length>0&&e.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:i.productType,demandSourceName:i.demandSourceName,deletedAds:r,deletedAdsData:a,inventoryId:r[0].inventoryId}])})))}function A(){return s}function C(){return o.getNextAvailableAd(i)}function I(e){return o.clearCacheByType(i,e)}function w(t,n){return n=e.Utils.isDefined(n)?n:i.settings.numOfBannersToCache,o.mergeCampaigns(t,n,i.settings.maxCachedCampaigns,i)}function D(e,t){return o.areCampaignsAvailable(e,t,i)}function P(){return o.getCacheSizeByType(i)}function F(){return o.incrementNextCampaign(i)}function O(e){return o.getCurrentAd(i,e)}function T(e){return o.isNextAvailable(i,e)}function x(){return o.cacheNext(i)}function N(e,t){return o.setAdInventoryIndex(i,e,t)}function L(e){return o.isAdInCache(i,e)}function U(e){return o.setSettings(i,e)}function M(){l||(l=!0,h(),o.initCacheBase(i.cacheBase))}function V(e){return o.getAdStatusInQueue(i,e)}function E(e){return o.deleteCachedCampaign(i,e)}function k(e,t){return o.cacheSingleAd(i,e,t)}var B={updateConfig:g,init:M,decidePrecacheStatus:v,isPrecache:b,handleCacheClear:S,mergeCampaigns:w,handleCacheAds:f,updateCache:y,clearCacheByType:I,areCampaignsAvailable:D,getCacheSizeByType:P,setAdInventoryIndex:N,incrementNextCampaign:F,getCurrentAd:O,isAdInCache:L,getAdStatusInQueue:V,setCacheSettings:U,getNextAvailableAd:C,isNextAvailable:T,getCacheClearMessages:A,cachingStatus:o.cachingStatus,deleteCachedCampaign:E,cacheSingleAd:k,getConfig:function(){return i}};return B}t.exports=i},{}],123:[function(e,t,n){t.exports=function(t){var n=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var i=e.SupplyConfigurations.getNetworkConfigValueByKey(n.flags.showStandaloneViewInAdobe);return null!==i&&t.isDefined(i)||(i=!0),e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+i),i}}}},{"./SDKPluginTypeConstants.js":124}],124:[function(e,t,n){t.exports={supportedPluginNames:{adobeAir:"AdobeAir"},flags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],125:[function(e,t,n){t.exports=function(t,n){var i=e("./SDKPluginTypeConstants.js");function r(r){return(a=r).applicationSettings&&a.applicationSettings.SDKPluginType&&a.applicationSettings.SDKPluginType===i.supportedPluginNames.adobeAir?(t.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(e("./AdobeAirPluginHandler.js"))(n)):(t.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var a}return{shouldShowInStandAloneView:function(e){t.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var n=r(e);return n&&"function"==typeof n.shouldShowInStandAloneView?n.shouldShowInStandAloneView(t):(t.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(n?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":123,"./SDKPluginTypeConstants.js":124}],126:[function(e,t,n){t.exports={versions:{SKAN1:1,SKAN2:2,SKAN4:4},applicationSettingsKeys:{skd:"skd",skanv:"skanv",atid:"atid",providers:"providers",skanIds:"skanIds"},controllerConfigKeys:{SKANData:"SKANData",version:"version",sourceAppTrackID:"sourceAppTrackID",adNetworkIDs:"adNetworkIDs"},nativeParamsKeys:{adNetworkId:"adNetworkId",adNetworkCampaignId:"adNetworkCampaignId",id:"id",adNetworkNonce:"adNetworkNonce",adNetworkImpressionTimestamp:"adNetworkImpressionTimestamp",adNetworkAttributionSignature:"adNetworkAttributionSignature",adNetworkPayloadVersion:"adNetworkPayloadVersion",adNetworkSourceAppStoreIdentifier:"adNetworkSourceAppStoreIdentifier",sourceIdentifier:"sourceIdentifier"},SKAdImpression:{minimalSupportedIOSVersion:14.5,jsInterface:"SKAdImpressionAPI",startImpression:"startImpression",startImpressionSuccess:"startImpressionSuccess",startImpressionFailed:"startImpressionFailed",endImpression:"endImpression",endImpressionSuccess:"endImpressionSuccess",endImpressionFailed:"endImpressionFailed"}}},{}],127:[function(e,t,n){t.exports=function(){var t=e("./SKANConstants");function n(e,t,n){var i={};return e&&(i.SKANVersion=e),t&&(i.SKANSourceAppTrackID=t),n&&Array.isArray(n)&&n.length>0&&(i.SKANAdNetworkIDs=n.toString()),i}function i(e){if(!e)return{};var n=parseFloat(e.version);return n?n<t.versions.SKAN2?a(e):n<t.versions.SKAN4?o(e):s(e):r(e)}function r(e){var n={};return n[t.nativeParamsKeys.id]=e.advertisedAppTrackID||e.appId,n}function a(e){var n=r(e);return n[t.nativeParamsKeys.adNetworkId]=e.adNetworkID,n[t.nativeParamsKeys.adNetworkImpressionTimestamp]=e.timestamp,n[t.nativeParamsKeys.adNetworkNonce]=e.nonce&&e.nonce.toLowerCase(),""===n[t.nativeParamsKeys.adNetworkNonce]&&(n[t.nativeParamsKeys.adNetworkNonce]="00000000-0000-0000-0000-000000000001"),n[t.nativeParamsKeys.adNetworkAttributionSignature]=e.signature,e.hasOwnProperty("SKANCampaignID")&&(n[t.nativeParamsKeys.adNetworkCampaignId]=e.SKANCampaignID),n}function o(e){var n=a(e);return n[t.nativeParamsKeys.adNetworkPayloadVersion]=e.version,n[t.nativeParamsKeys.adNetworkSourceAppStoreIdentifier]=e.sourceAppTrackID,n}function s(e){var n=o(e);return n[t.nativeParamsKeys.sourceIdentifier]=e.sourceID,n}function d(e,t){return window.SSA_CORE.Utils.extend({},e.settings&&e.settings.SKANData,e.ext&&e.ext.SKANData,e.ext&&e.ext.SKANData&&e.ext.SKANData[t])}return{extractDataForPayload:function(e,i){var r=function(e){var i=!!e&&e[t.applicationSettingsKeys.skd];if(!i)return{};var r=i[t.applicationSettingsKeys.skanv],a=i[t.applicationSettingsKeys.atid],o=i[t.applicationSettingsKeys.providers],s=[];if(o)for(var d of Object.keys(o))if(o[d]){var l=o[d][t.applicationSettingsKeys.skanIds];l&&Array.isArray(l)&&l.length>0&&(s=s.concat(l))}return n(r,a,s)}(i);return 0===Object.keys(r).length&&(r=function(e){if(!e)return{};var i=e[t.controllerConfigKeys.SKANData];if(!i)return{};var r=i[t.controllerConfigKeys.version],a=i[t.controllerConfigKeys.sourceAppTrackID],o=i[t.controllerConfigKeys.adNetworkIDs];return n(r,a,o)}(e)),r},extractDataForSKAdImpression:function(e){var n=d(e,"VTA");return parseFloat(n.version)<t.versions.SKAN4?o(n):s(n)},buildStoreKitLoadDataForSDK:function(e,t){if(!e)return{};var n={appId:e.appId,viewUniqueId:t,storeKitLoadParams:i(e)};return e.ppid&&(n.storeKitLoadParams.ppid=e.ppid),n},extractDataForSKOverlay:function(e){return e?i(d(e,"StoreKit")):{}}}}},{"./SKANConstants":126}],128:[function(e,t,n){t.exports=function(e,t,n,i){var r=parseInt(e),a=0,o=function(e){return!!r&&(-1!==n.storeKit.loadFailuresToPreventRetry.indexOf(e)?(i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | stop executing retries for reason: "+e),!1):(a>=r&&i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | All retries attempts exhausted"),a<r))};return{shouldPerformRetry:o,performRetry:function(){a++,"function"==typeof t&&(i("StoreKitLoadingRetryExecutor | _performRetry | Performing retry attempt #"+a),t())},getCurrentAttempt:function(){return a},cancelAdditionalRetryAttempts:function(){o=function(){return!1}}}}},{}],129:[function(e,t,n){const i=e("../OrientationConstants.js");t.exports=function(t,n,r){var a=e("../../patches/PatchStoreKitOsVersion"),o=e("./SKANModel")(),s=e("../../constants/SDKFeatureNames"),d=e("./StoreKitLoadingRetryExecutor"),l=e("./storeKitObject").DisplayStatus,c=t.Analytics.createAnalytic({baseData:{}}),u=e("../../modules/SDKController/EventCategories")(),p="NativeCallback",f={};function g(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function v(e,n){var i={message:"cool down time out is over "+e,productType:n.adProductType,demandSourceName:n.adDemandSourceName};t.PubSub.publish("StoreKit.storeKitCoolDown",[i])}function m(){return h()&&(e=n.getConfig().mobileSDKSettings.SDKVersion,i="7.7.0",t.VersionUtils.isEqual(e,i)||t.VersionUtils.isLower(e,i));var e,i}function h(){var e=n.getConfigurationHelper().getDeviceOsVersion(),i="17.3";return t.VersionUtils.isEqual(e,i)||t.VersionUtils.isHigher(e,i)}function b(e,a){var v,w=g(e),D=function(e){var t=3e4;if(!e.productType)return t;return e.storeKitLoadingTimeout||t}(e),P=a||d(e.loadRetryAttempts,(function(){clearTimeout(v),C(w),b(e,P)}),r,n.log);if(I(e)){var F=o.buildStoreKitLoadDataForSDK(e,w);"00000000-0000-0000-0000-000000000001"===F.storeKitLoadParams.adNetworkNonce&&n.postAdUnitEvent({name:"appStoreInsideEmptyNonce"},!1),F=t.Utils.extend(F,h()?{useCustomRootView:!1,shouldUseOriginalStoreKitViewController:!0,freezeGestureConfig:{tap:{},swipe:{direction:8}}}:{useCustomRootView:!0});var O=m();n.AppOrientationManager.forceNativeAppOrientationIfNeeded(O),n.callSDKFunction("preLoadAppPage",F,"preloadAppInstallPageSuccess","preloadAppInstallPageFailure"),n.AppOrientationManager.unForceNativeAppOrientationIfNeeded(O);var T=t.PubSub.subscribe(p+".appStoreInsideLoaded",(function(n){if(n&&"object"==typeof n&&n.viewUniqueId&&n.viewUniqueId===w){clearTimeout(v),t.PubSub.unsubscribe(T),e.callback&&(n.isLoaded||(n.currentLoadRetryAttempt=P.getCurrentAttempt()),e.callback.call(null,n));var i=n.errMsg&&decodeURIComponent(n.errMsg);!n.isLoaded&&P.shouldPerformRetry(i)&&P.performRetry()}})),x=t.PubSub.subscribe(p+".appStoreFailedToDisplayStoreKit",(function(e){n.log("appStoreFailedToDisplayStoreKit error",n.LogLevels.verbose);var i,r=decodeURIComponent(e.error);e.viewUniqueId=g(e),e.viewUniqueId!==w&&n.log("appStoreFailedToDisplayStoreKit params.viewUniqueId= "+e.viewUniqueId+" viewUniqueId= "+w,n.LogLevels.verbose),i=r,t.PubSub.publish("StoreKit.storeKitDisplayFailed",[i]),f[e.viewUniqueId]&&f[e.viewUniqueId].setShowingState(l.NON_VISIBLE,!1)})),N=t.PubSub.subscribe(p+".appStoreInsideDisplayStoreKit",(function(e){if(e.viewUniqueId=g(e),n.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,n.LogLevels.verbose),e.viewUniqueId===w){f[e.viewUniqueId]&&f[e.viewUniqueId].setShowingState(l.SHOW,!1);var i=t.Utils.extend({name:"appStoreInsideVisible",shouldPreloadStoreKitOnStoreKitClose:y()},e);n.postAdUnitEvent(i),S(!1,"storeKitOpen"),n.SKOverlayManager.onSKOpen()}})),L=t.PubSub.subscribe(p+".appStoreInsideClosed",(function(e){e.viewUniqueId===w&&(!1!==e.didStoreKitPresent&&!1!==e.isClosed?(V(e),n.SKOverlayManager.onSKClose()):M(e))})),U=t.PubSub.subscribe("SDKController.ClearAppPage",(function(e){e.viewUniqueId===w&&(n.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?(t.PubSub.unsubscribe(U),R()):n.log("error calling clear App install page with "+JSON.stringify(e),n.LogLevels.error))})),M=function(e){P.cancelAdditionalRetryAttempts(),n.CompatibilityService.isFeatureSupportedInNativeSDK(s.loadStoreKitOncePerAd)&&A()&&C(e.viewUniqueId),n.log("storeKit Failed to Load ",n.LogLevels.verbose),R()},V=function(e){n.SupplyConfigurations.getNetworkConfigValueByKey("forceOrientationAfterStoreKitClose")&&n.callSDKFunction(i.ControllerNativeAPI.getAppOrientationData,{},i.NativeAPI.successCallback,i.NativeAPI.failCallback),f[e.viewUniqueId]&&f[e.viewUniqueId].setShowingState(l.NON_VISIBLE,!1);var r=t.Utils.extend({name:"appStoreInsideClosed",shouldPreloadStoreKitOnStoreKitClose:y()},e);n.postAdUnitEvent(r),S(!0,"storeKitClose"),y()&&(t.PubSub.unsubscribe(N),t.PubSub.unsubscribe(L),C(e.viewUniqueId))},E=t.PubSub.subscribe(p+".dismissStoreSuccess",(function(e){e.viewUniqueId===w&&c.report(u.appStoreDismissSuccess,{generalmessage:e.viewUniqueId})})),k=t.PubSub.subscribe(p+".dismissStoreFail",(function(e){e.viewUniqueId===w&&c.report(u.appStoreDismissFail,{generalmessage:e.viewUniqueId,custom_a:e.errMsg})})),B=t.PubSub.subscribe(p+".appStoreRecognizedUnexpectedBehavior",(function(e){if(e.viewUniqueId===w){var t=e.storeUnexpectedBehavior?e.storeUnexpectedBehavior:"",i=e.storeAppId?e.storeAppId:"";c.report(u.appStoreRecognizedUnexpectedBehavior,{generalmessage:i,custom_a:t}),n.callSDKFunction("dismissAppPage",{viewUniqueId:w},"dismissStoreSuccess","dismissStoreFail")}})),R=function(){t.PubSub.unsubscribe(T),t.PubSub.unsubscribe(L),t.PubSub.unsubscribe(N),t.PubSub.unsubscribe(x),t.PubSub.unsubscribe(B),t.PubSub.unsubscribe(E),t.PubSub.unsubscribe(k)};v=setTimeout((function(){n.log("reach appstoreinside loading timeout",n.LogLevels.verbose),n.postAdUnitEvent({name:"appStoreLoadingTimeout",viewUniqueId:w,currentLoadRetryAttempt:P.getCurrentAttempt(),errMsg:r.storeKit.loadingTimeoutMessage},!0),P.shouldPerformRetry(r.storeKit.loadingTimeoutMessage)?P.performRetry():(R(),C(w))}),D)}}function S(e,n){var i={isViewable:e,changeReason:n};t.PubSub.publish(p+".viewableChange",[i])}function y(){return!n.CompatibilityService.isFeatureSupportedInNativeSDK(s.loadStoreKitOncePerAd)||!A()}function A(){return parseFloat(n.getConfigurationHelper().getDeviceOsVersion())<15.5}function C(e){if(I()){if(!e)return;n.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function I(e){if(!n.isIOS())return!1;try{if(parseInt(n.getConfig().mobileSDKSettings.deviceApiLevel)<r.storeKit.minimalSupportedOSVersion)return!1}catch(e){n.log("StoreKitService | isStoreKitSupported | failed to parse deviceApiLevel as integer")}return!a(t.Utils,n.CompatibilityService).shouldBlock(n.getApiData({deviceOSVersion:1}).deviceOSVersion)&&(!e||!0!==e.standaloneView)}return t.PubSub.subscribe("SDKController.PreloadAppInstallPage",(function(e){n.log("SDKController.PreloadAppInstallPage"),n.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?b(e,null):n.log("error calling preload App install page with "+JSON.stringify(e),n.LogLevels.error)})),t.PubSub.subscribe("SDKController.ClearAppPage",(function(e){e.viewUniqueId=g(e),n.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&C(e.viewUniqueId):n.log("error calling clear App install page with "+JSON.stringify(e),n.LogLevels.error)})),{updateAdWithStoreAppId:function(e,t){if(e&&e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId&&!I(t)&&delete e.ext.clickTags.storeAppId,t&&(void 0===(r=t.extractAppIdForStoreKit)||r)&&I(t)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var i=n.AdUtils.getStoreAppId(e);i&&(e.ext.clickTags.storeAppId=i)}var r;return e},getViewUniqueId:g,isStoreKitVisible:function(){for(var e=Object.keys(f),t=0;t<e.length;t++)if(f[e[t]].getIsShowing())return!0;return!1},canPresentStoreKitObj:function(e){return e&&e.getIsNonVisible()},setStoreKitObjectPresentingProgress:function(e){e&&e.setShowingState(l.IN_PROGRESS,!0)},getStoreObject:function(t,n){return f[t]||(f[t]=new(e("./storeKitObject").StoreKitObject)(t,n,1500,v)),f[t]}}}},{"../../constants/SDKFeatureNames":133,"../../modules/SDKController/EventCategories":193,"../../patches/PatchStoreKitOsVersion":222,"../OrientationConstants.js":78,"./SKANModel":127,"./StoreKitLoadingRetryExecutor":128,"./storeKitObject":130}],130:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.NON_VISIBLE=0]="NON_VISIBLE",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.SHOW=2]="SHOW"}(i||(i={}));t.exports={StoreKitObject:class{constructor(e,t,n,r){this.viewUniqueId=e,this.demandSourceData=t,this.coolDownTimeout=n,this.sendEventCoolDown=r,this.showState=i.NON_VISIBLE}getUniqueId(){return this.getUniqueId()}getIsNonVisible(){return this.showState===i.NON_VISIBLE}getIsShowing(){return this.showState===i.SHOW}setShowingState(e,t){this.showState=e,t&&setTimeout((()=>{this.showState===i.IN_PROGRESS&&(this.showState=i.NON_VISIBLE,this.sendEventCoolDown(this.viewUniqueId,this.demandSourceData))}),this.coolDownTimeout)}},DisplayStatus:i}},{}],131:[function(e,t,n){t.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},tokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0,auid:!0,ici:!0,bur:!0,cbt:!0,ismao:!0,idfi:!0,sdkAbName:!0},android:{gpi:!0,blacklistedCampaigns:!0},ios:{}}}},{}],132:[function(e,t,n){const i=e("../../modules/DemandSource/PayloadBuilderConstants");t.exports=function(t,n,r,a,o){var s=e("./TokenConstants");return t.PubSub.subscribe(r.CB+"."+s.NativeAPI.failCallback,(function(e){n.log("TokenService | updateTokenFail: "+JSON.stringify(e));var t=e.errMsg?e.errMsg:"unknown";a.report(o.updateTokenFail,{generalMessage:t})})),{updateToken:function(e){var i=function(e){if(!e)return{};var i={},r=s.payloadKeys.common;for(var a in r=t.Utils.extend(r,s.payloadKeys[n.getConfig().mobileSDKSettings.deviceOs]))r.hasOwnProperty(a)&&e.hasOwnProperty(a)&&(i[a]=e[a]);return i}(e);n.log("TokenService | _updateNativeToken | data: "+JSON.stringify(i)),0!==Object.keys(i).length&&n.callSDKFunction(s.tokenAPI,{functionName:s.ControllerNativeAPI.updateToken,functionParams:i},null,s.NativeAPI.failCallback)},getToken:function(){var e,r,a=window.jQuery.Deferred();return e=t.PubSub.subscribe(i.CB+"."+i.callbacks.getTokenSuccess,(function(n){var i;i=n,t.PubSub.clearHandlers([e,r]),a.resolve(i)})),r=t.PubSub.subscribe(i.CB+"."+i.callbacks.getTokenFailed,(function(o){let s=i.errorLog+":";var d;s+=o&&o.errMsg?o.errMsg:"",n.log(s,n.LogLevels.error),d=s,t.PubSub.clearHandlers([e,r]),a.reject(d)})),n.callSDKFunction(i.nativeFunction,{functionName:i.nativeAPI.getToken},i.callbacks.getTokenSuccess,i.callbacks.getTokenFailed),a.promise()}}}},{"../../modules/DemandSource/PayloadBuilderConstants":167,"./TokenConstants":131}],133:[function(e,t,n){t.exports={bannerMultipleInstances:"bannerMultipleInstances",storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback",limitAppFiltering:"disableCheckInstalledAppsJSInterface",noPackagesInstallationPolling:"noPackagesInstallationPolling",webviewPerAdV1:"webviewperad-v1",loadStoreKitOncePerAd:"loadStoreKitOncePerAd",SKAdImpression:"SKAdImpression",SKOverlay:"SKOverlay",bannersOpenMeasurement:"bannersOpenMeasurement",initRecovery:"initRecovery"}},{}],134:[function(e,t,n){t.exports={pullingNativeDeviceData:{ios:"5.76",android:"5.81"},mutableAdvertingTrackingData:{ios:"5.79",android:"99"},keepAlive:{ios:"7.8.0",android:"7.8.0"}}},{}],135:[function(e,t,n){var i={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},r={ext:{videoData:{videoSource:{vast:""}}}},a={ext:{vastData:{xmlResponse:""}}},o={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},s={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},d={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},l={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},c={ext:{videoData:{videoSource:{htmlURL:""}}}},u={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},p={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},f={ext:{videoData:{videoSource:{mraidUrl:""}}}},g={ext:{videoData:{videoSource:{videoformat_mp4:""}},layoutData:{mraidUrl:""}}};const v={ext:{videoData:{videoSource:{videoformat_mp4:""}}}};var m={fetch:{playable:{ext:{videoData:{videoSource:{mraidUrl:""}},appData:{appIcon:""}}},interactiveEndCard:v},cache:{playable:{ext:{videoData:{videoSource:{mraidUrl:""}}}},interactiveEndCard:{ext:{videoData:{videoSource:{videoformat_mp4:""}},layoutData:{mraidUrl:""}}}},none:{playable:{},interactiveEndCard:v}};t.exports=function(){var t=new(e("../patches/PatchCacheFileEncoding")),n=function(e,n,i){var r=e.split("/").pop();return n+(r=t.getCachedFileName(r,i))},v=function(e,t){for(var n=[],i=Object.keys(t),r=0;r<i.length;r++)e[i[r]]&&a(t[i[r]],e[i[r]]);function a(e,t){var i,r;if("string"==typeof e)n.push(t);else if(e instanceof Array&&0===e.length)n=n.concat(t);else if(e instanceof Array&&e.length>0&&t instanceof Array&&t.length>0)for(i=0;i<t.length;i++)for(r=0;r<e.length;r++)a(e[r],t[i]);else{var o=Object.keys(e);for(i=0;i<o.length;i++)t[o[i]]&&a(e[o[i]],t[o[i]])}}return n};function h(e){return e.ext&&e.ext.ableToCache}function b(e){return e&&e.type&&"playableAd"===e.type}function S(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function y(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?S(e)?p:s:function(e){return(t=e.ext)&&t.type&&"customEndCard"===t.type&&e.ext.layoutData&&e.ext.layoutData.mraidUrl;var t}(e)?g:d:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?o:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?l:function(e){return b(e.ext)&&e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.html}(e)?c:function(e){return b(e.ext)&&e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.mraidUrl}(e)?f:function(e){return S(e)&&e.ext.appData&&e.ext.appData.appIcon&&!e.ext.appData.appImages}(e)?u:i}return{extractStaticFiles:function(e){return v(e,y(e))},extractVastSource:function(e){var t=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?a:r;return v(e,t)},extractMraidPlayableSource:function(e,t){var n=m[t].playable;return v(e,n)},extractMraidInteractiveEndCardSource:function(e,t){var n=m[t].interactiveEndCard;return v(e,n)},updateAdunitPrecachePath:function(e,t,i){return function(e,t,i,r){for(var a=Object.keys(i),o=0;o<a.length;o++)e[a[o]]&&(e[a[o]]=s(i[a[o]],e[a[o]]));function s(e,i){var a,o;if("string"==typeof e||"string"==typeof i)i=n(i,t,r);else if(e instanceof Array&&0===e.length)for(a=0;a<i.length;a++)i[a]=n(i[a],t,r);else if(e instanceof Array&&e.length>0&&i instanceof Array&&i.length>0)for(a=0;a<i.length;a++)for(o=0;o<e.length;o++)i[a]=s(e[o],i[a]);else{var d=Object.keys(e);for(a=0;a<d.length;a++)i[d[a]]&&(i[d[a]]=s(e[d[a]],i[d[a]]))}return i}return e}(e,t,y(e),i)},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:h,extractExternalAdProtocolFileURL:function(e,t){return t.getProtocolURL(e)}}}},{"../patches/PatchCacheFileEncoding":220}],136:[function(e,t,n){"use strict";var i=e("../../types");const r="adPlayerVersion",a="Failed to cache ad player files",o={html:"index.html",js:"index.js",css:"index.css"};class s{constructor(e,t,n,r,a,o,s,d){var l;this.protocol=i.Protocol.Https;const{ext:c,debug:u,domain:p,scdn:f}=t;this.version=null!==(l=c.adPlayerVersion)&&void 0!==l?l:"0.1.6984",this.assetsFolder=e,this.env=n,this.adPlayerUrl=r,this.cache=a,this.cacheRootFolder=o,this.debug=u,this.domain=p,this.securedCdnBaseUrl=f,this.core=s,this.jQuery=d}setProtocol(e){this.protocol=e}prepareAdPlayerAssetsWrapper(e){return new Promise(((t,n)=>{this.prepareAdPlayerAssets(e).then(t).fail(n)}))}prepareAdPlayerAssets(e){return this.adPlayerUrl.setRemoteUrl(`${this.buildAdPlayerAssetsBaseUrl()}${o.html}`),this.isAdPlayerAssetsPromisePendingOrResolved()?this.adPlayerAssetsPromise.promise():(this.adPlayerAssetsPromise=this.jQuery.Deferred(),this.shouldUpdateAdPlayerFiles().then((t=>t?this.updateAdPlayerFiles(e):(this.adPlayerUrl.setLocalUrl(`${this.getLocalAdPlayerFolder()}${o.html}`),this.adPlayerAssetsPromise.resolve(),this.adPlayerAssetsPromise.promise()))))}isAdplayerReadyToUseFromCache(){return!this.shouldUpdateAdPlayerFiles()}updateAdPlayerFiles(e){return this.clearAdPlayerCache().then((()=>this.precacheAdPlayerAssets(e)))}isAdPlayerAssetsPromisePendingOrResolved(){return!!this.adPlayerAssetsPromise&&-1!==["pending","resolved"].indexOf(this.adPlayerAssetsPromise.state())}getAdPlayerCache(){var e;const t=this.cache.getCacheByType({cacheBase:`${this.assetsFolder}`});return null!==(e=null==t?void 0:t.cache)&&void 0!==e?e:[]}getLocalAdPlayerFolder(){return`../${this.cacheRootFolder}/${this.assetsFolder}/`}clearAdPlayerCache(){return this.cache.clearCacheByType({cacheBase:this.assetsFolder},[])}static isAdPlayerDirContainAllAssets(e){for(const t of Object.values(o))if(-1===e.indexOf(t))return!1;return!0}shouldUpdateAdPlayerFiles(){if(this.env===i.Environment.Develop)return this.core.Utils.returnResolvedPromise(!0);const e=this.getAdPlayerCache();return 0!==e.length&&s.isAdPlayerDirContainAllAssets(e)?this.shouldFetchNewAdPlayerVersion():this.core.Utils.returnResolvedPromise(!0)}buildAdPlayerAssetsBaseUrl(){if(this.env!==i.Environment.Production){const e=this.domain.split(".")[0];return`${this.protocol}//${this.domain}/users/staging/${e}/${this.assetsFolder}/${this.version}/dev/`}return`${this.protocol}//${this.securedCdnBaseUrl}/${this.assetsFolder}/${this.version}/`}precacheAdPlayerAssets(e){const t=this.assetsToCache(this.buildAdPlayerAssetsBaseUrl());return this.cache.cacheFilesByFolder(this.assetsFolder,t,e).then((()=>this.adPlayerUrl.setLocalUrl(`${this.getLocalAdPlayerFolder()}${o.html}`)),(()=>(this.adPlayerAssetsPromise.reject(a),a))).then((()=>this.updateAppDataWithVersion()))}assetsToCache(e){const t=[];for(const n of Object.values(o)){const i=/(\.\.\/)/g,r=n.match(i),a=(null==r?void 0:r.length)||0,o=n.replace(i,"");if(a>0){const n=e.split("/");n.splice(n.length-1-a,a),t.push(n.join("/")+o)}else t.push(e+o)}return t}updateAppDataWithVersion(){return this.cache.getAppData().then((e=>this.setAppDataWithCurrentVersion(e))).always((()=>(this.adPlayerAssetsPromise.resolve(),this.adPlayerAssetsPromise.promise())))}setAppDataWithCurrentVersion(e){const t=e||{};return t[r]=this.version,this.cache.setAppData(t)}shouldFetchNewAdPlayerVersion(){return this.cache.getAppData().then((e=>this.shouldReplaceCachedAdPlayerBuild((null!=e?e:{})[r])),(()=>!0))}shouldReplaceCachedAdPlayerBuild(e){return e!==this.version}}t.exports=s},{"../../types":229}],137:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e){this.remoteUrl=null,this.localUrl=null,this.utils=e}setRemoteUrl(e){this.remoteUrl=e}setLocalUrl(e){this.localUrl=e}getAdPlayerUrl(e,t,n,i){var r;const a=e&&null!==(r=this.localUrl)&&void 0!==r?r:this.remoteUrl,{productType:o,demandSourceName:s}=n,d=i.shouldBuildAdUnitUrlForExternal?{mode:"native",viewType:"external"}:{},l=Object.assign({productType:o,demandSourceName:s,deviceOs:t},d);return`${a}?${this.utils.serialize(l)}`}}},{}],138:[function(e,t,n){t.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},owFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],139:[function(e,t,n){t.exports=function(e,t,n,i){var r=e||{},a=t&&t.debug,o=t&&t.domain,s=t&&t.scdn,d=t&&t.protocol,l=t&&t.adunitConfig,c=n,u=i||{};function p(){return d+"//"+function(){if(a&&parseInt(a)>0&&"www.supersonicads.com"!==o){var e=o.split(".")[0];return o+"/users/staging/"+e}return s}()+"/adunit/dist/adunitAssets.json"}function f(){return window.jQuery.ajax({dataType:"json",url:p(),timeout:u.apiResponseTimeout}).then((function(e,t,n){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=window.jQuery.Deferred();return i.reject(u.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()}),(function(e,t,n){return u.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson}))}function g(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return c===u.environment.develop?f():g(l)?r.Utils.returnResolvedPromise(l):f().then((function(e){return g(e)?r.Utils.returnResolvedPromise(e):r.Utils.returnRejectedPromise(u.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)}))},setProtocol:function(e){d=e}}}},{}],140:[function(e,t,n){function i(t){var n,i,r,a,o,s,d,l,c,u,p,f,g,v,m,h,b,S,y,A,C=e("./AdUnitConst.js");function I(){var e=r+"//",t="/adunit/dist",o=m?"/versions/"+m:"";if(n&&parseInt(n)>0&&"www.supersonicads.com"!==i){var s=i.split(".")[0],d="/stage/";("local"===s||parseInt(s)>1)&&(d="/dev/"),e=e+i+("/users/staging/"+s)+t+o+d}else e=e+a+t+o+"/prod/";return e}function w(){var e=d.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function D(e,t){return d.cacheGlobalAssets(e,t)}function P(){return"../"+l+"/globals/"}function F(){return d.getAppData().then((function(e){return(e=e||{})[C.adunitVersionKey]=m,d.setAppData(e)})).always(s.Utils.returnResolvedPromise)}function O(){return d.clearCacheByType({cacheBase:"globals"},[])}function T(){if(o===t.environment.develop)return s.Utils.returnResolvedPromise(!0);var e=w();return e.length<=0||function(e){for(var t=0;t<e.length;t++){var n=e[t].split("."),i=n[n.length-1];if(C.adunitFilesMapping.hasOwnProperty(i)&&e[t]!==C.adunitFilesMapping[i])return!0}return!1}(e)||SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==m?s.Utils.returnResolvedPromise(!0):d.getAppData().then((function(e){var t=(e=e||{})[C.adunitVersionKey],n=s.VersionUtils.isEqual(m,t||"0");return s.Utils.returnResolvedPromise(n)})).then((function(e){var t=e&&function(){var e=w(),t=C.adunitFilesMapping;for(var n in t)if(-1===e.indexOf(t[n]))return!1;return!0}();return s.Utils.returnResolvedPromise(!t)})).fail((function(){return s.Utils.returnResolvedPromise(!0)}))}function x(e){if(!e)return[];var t=I();return Object.keys(e).map((function(n){var i=e[n],r=/(\.\.\/)/g,a=i.match(r),o=a&&a.length||0;if(i=i.replace(r,""),o>0){var s=t.split("/");return s.splice(s.length-1-o,o),s.join("/")+i}return t+i}))}function N(e){m=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function L(e,t){return D(x(e),t).then((function(){c.setLocalAdunitUrl(P()+c.getRemoteAdunitFileName())}),(function(){return c.setLocalAdunitUrl(c.getRemoteAdunitUrl()),C.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl})).then(F)}function U(e){return A.prefetchGlobalAssetsToBrowser(e,I())}return{init:function(t,f,g,v,m,h,b,S,I){t,n=f.debug,i=f.domain,r=f.protocol,a=f.scdn,d=g,l=v,c=m,u=h,o=b,s=S,I,p=new(e("./AdUnitDataJsonFetcher.js"))(s,f,o,C),A=new(e("./AdUnitUtils.js"))(s,C),y=new(e("./AdUnitGraphicAssetsManager.js"))(s,A,d)},setProtocol:function(e){r=e,p.setProtocol(e)},getStaticGlobalsUrl:I,getGlobalAssetsJSON:function(){return p.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:U,getGlobalsCache:w,isAdunitVersionChanged:function(e){var t=w(),n=!0;return s.Utils.each(t,(function(t,i){return i.indexOf(e)>-1&&(n=!1),n})),n},clearGlobalsCache:O,getLocalGlobalsFolder:P,cacheGlobalAssets:D,assetsToCache:x,updateAdUnitGlobals:function(e,t,n){if(e){if(b&&"rejected"!==b.state())return b.promise();b=window.jQuery.Deferred()}else{if(h&&"rejected"!==h.state())return h.promise();h=window.jQuery.Deferred()}return S&&"rejected"!==S.state()||(S=p.getGlobalAssetsJSON().then((function(e){var t;N(f=e),f=function(e){var t=s.Utils.extend(!0,{},C.adunitFilesMapping,e);return t=function(e,t){var n="../../";return e.libs=function(e,t){for(var n in e)e.hasOwnProperty(n)&&"string"==typeof e[n]&&(e[n]=t+e[n]);return e}(t.libs,n),e}(t,e),t}(f),g=C.adunitFilesMapping,y.setAdunitAssetsPaths(f.graphicAssets,I()),v=f.libs,u.setLibsFilesPaths(v,I()),t=I()+C.adunitFilesMapping.html,c.setRemoteAdunitUrl(t),c.setLocalAdunitUrlFromCache(P(),w())})).then((function(){return e?u.manageDownloadLibsFileByFiletype(C.adunitLibsFileName,t):U({adunitLibsFile:v.adunitLibsFile})})).fail((function(t){e?b.reject(t):h.reject(t)}))),S.then((function(){var t;return t=e?function(e){if(y.shouldUpdateAdunitAssets())return y.precacheAdunitGraphicAssets(e);return s.Utils.returnResolvedPromise()}(n).then(null,(function(){b.reject(C.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)})).then(T.bind(null)).then((function(e){return e?O().then(L.bind(null,g,n)).then((function(){b.resolve()}),(function(e){b.reject(e)})).always((function(){return b.promise()})):(b.resolve(),b.promise())})):U(g).then(y.prefetchAdunitGraphicAssets).then((function(){h.resolve()}),(function(e){h.reject(e)})).always((function(){return h.promise()})),t}))},setAdunitVersion:N,getAdunitGlobalsHTML:function(){return C.adunitFilesMapping.html}}}var r;t.exports=function(e,t){return t?new i(e):(r||(r=new i(e)),r)}},{"./AdUnitConst.js":138,"./AdUnitDataJsonFetcher.js":139,"./AdUnitGraphicAssetsManager.js":141,"./AdUnitUtils.js":142}],141:[function(e,t,n){t.exports=function(e,t,n){var i,r=n||{},a=t||{},o={},s={},d="graphicAssets";function l(){var e=r.getCacheByType({cacheBase:d});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,t){o=e,i=t,s.sprite=o.sprite},shouldUpdateAdunitAssets:function(){if(0===l().length)return!0;for(var e in o)if(!r.isFileInCache(a.extractFileNameFromPath(o[e]),d))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(t=function(){for(var e=l(),t=[],n=function(e){for(var t in o)if(a.extractFileNameFromPath(o[t])===e)return!1;return!0},i=0;i<e.length;i++)n(e[i])&&t.push(e[i]);return t}(),r.deleteCachedListOfAssets(d,t)).then(r.cacheGraphicAssets.bind(null,function(){var e=[];for(var t in o){var n=a.extractFileNameFromPath(o[t]);if(!r.isFileInCache(n,d)){var s=a.formatAssetsUrlForCache(o[t],i);e.push(s)}}return e}(),e));var t},prefetchAdunitGraphicAssets:function(){return a.prefetchGlobalAssetsToBrowser(s,i)}}}},{}],142:[function(e,t,n){t.exports=function(e,t){var n=e,i=t||{};return{formatAssetsUrlForCache:function(e,t){var n=t,i=function(e,t){var n=/(\.\.\/)/g,i=t.match(n),r=i&&i.length||0;if(t=t.replace(n,""),r>0){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+t}return e+t};return"string"==typeof e?i(n,e):e?Object.keys(e).map((function(t){return i(n,e[t])})):[]},prefetchGlobalAssetsToBrowser:function(e,t,r,a){var o,s,d=new window.jQuery.Deferred,l=[],c=0,u=0,p=n.Utils.extend(!0,{},e);p.hasOwnProperty(i.adunitAssetsJsonKeys.html)&&delete p.html;var f=function(e){return l.indexOf(e)>-1};n.Utils.each(p,(function(e,t){"string"==typeof t?f(t)||u++:delete p[e]})),0===u&&d.resolve();var g=function(e){if(function(e){f(e)||l.push(e)}(e),++c===u){if("function"==typeof r&&r(l),o)return;clearTimeout(s),d.resolve()}},v=t;return n.Utils.each(p,(function(e,t){if(!f(t)){var n=v+t;window.jQuery.get(n,{},null,{dataType:"text"}).done((function(){g(t)})).fail((function(e,n,i){"parsererror"===n&&g(t)}))}})),s=setTimeout((function(){c<u&&("function"==typeof a&&a(),d.reject("Failed to preload all global assets ("+c+" out of "+u+" succeeded)")),o=!0}),15e3),d.promise()},extractFileVersionFromUrl:function(e){var t=e.split("/");return t.length>0?t[t.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],143:[function(e,t,n){function i(t){var n=t.Utils||{},i=t.VersionUtils,r={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},a={dapi:{filename:"dapi.js",type:r.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:r.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:r.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:r.omid,cacheKeyName:"omid"}},o="libs",s,d,l,c;function u(e,t,n){return!!a[e]&&(a[e].url=t,a[e].newVersion=n,!0)}function p(e,t,i){return u(e,t,i),n.returnResolvedPromise()}function f(e,t){return u(e,l.formatAssetsUrlForCache(t,c),l.extractFileVersionFromUrl(t))}function g(e){return s.isFileInCache(e,o)?s.deleteCachedAsset(o,e):n.returnResolvedPromise()}function v(e,t){return i.isEqual(e,t)}function m(e,t){var n=a[e],i={};return!!n&&(i[n.cacheKeyName]=t,i)}function h(t,n){d=t,s=n||{},l=new(e("./AdUnitUtils.js"))(s)}function b(e,t){if(c=t,e)for(var n in e)f(n,e[n])}function S(e,t){var i=a[e]||{},r=function(){return g(i.filename).then((function(){return d.log("LibsManager | updateFileInCache | going to download",d.LogLevels.verbose),s.cacheLibsAsset(i.url).then(null,(function(){return n.returnResolvedPromise()}))})).fail((function(){return n.returnResolvedPromise()}))},l=function(e){return d.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),d.LogLevels.verbose),e=window.SSA_CORE.Utils.extend(e,m(i.type,i.newVersion)),d.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(e),d.LogLevels.verbose),s.setAppData(e).fail((function(){return n.returnResolvedPromise()}))};return s.getAppData().then((function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var a=!v(i.newVersion,i.savedVersion);return t||a?r().then(l.bind(null,e)):s.isFileInCache(i.filename,o)?(d.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",d.LogLevels.verbose),n.returnResolvedPromise()):(d.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",d.LogLevels.verbose),s.cacheLibsAsset(i.url))}),r).then((function(){return d.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,d.LogLevels.verbose),n.returnResolvedPromise("success")}),(function(){return d.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,d.LogLevels.verbose),y(i)}))}function y(e){return e.filename===a.adunitLibsFile.filename?n.returnRejectedPromise("Failed to download file "+e.filename):n.returnResolvedPromise()}var A={init:h,setLibsFilesPaths:b,manageDownloadLibsFileByFiletype:S,updateFileVersionByFilePathForThirdPartyLibraries:p};return A}t.exports=i},{"./AdUnitUtils.js":142}],144:[function(e,t,n){function i(e,t){var n,i,r=function(){return n},a=function(e){n=e},o=function(){var e=null;return n&&(e=n.replace(/^.*[\\\/]/,"")),e},s=function(){return i},d=function(e){i=e},l=function(e,t,n,i){var a=e?s():r();return a+=t&&t.productType?"#?productType="+t.productType:"",a+=t&&t.demandSourceName?"&demandSourceName="+t.demandSourceName:"",a+=n&&n.shouldBuildAdUnitUrlForExternal?"&"+c(i):""};function c(e){var n={mode:"native",viewType:"external"};return e&&(n.deviceOs=e),t.serialize(n)}var u=function(e,n){t.each(n,(function(t,n){if("string"==typeof n&&n.match(/.*\.html/))return d(e+n.replace(/^.*[\\\/]/,"")),!1}))},p={getAdunitUrl:l,getRemoteAdunitUrl:r,setRemoteAdunitUrl:a,getRemoteAdunitFileName:o,getLocalAdunitUrl:s,setLocalAdunitUrl:d,setLocalAdunitUrlFromCache:u};return p}t.exports=i},{}],145:[function(e,t,n){t.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0},amountOfInventories:1}},{}],146:[function(e,t,n){t.exports=function(e,t,n,i,r){return{NativeAPI:t.NativeAPI,ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,ProductName:n.BN,Features:{allowMultiInitCalls:!0,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0,forcePreload:r,width:i?i.width:0,height:i?i.height:0,label:i?i.label:null}}},{}],147:[function(e,t,n){t.exports=function(t,n){var i=e("../components/Constants");return{create:function(r){var a=e("./ProductAdapter"),o=e("./AdapterSharedConfig"),s=e("./Banner/BannerConfiguration")(t,o,i,r,n.isBannerMultipleInstances(i.BN));return new a(t,n,s,i)}}}},{"../components/Constants":40,"./AdapterSharedConfig":145,"./Banner/BannerConfiguration":146,"./ProductAdapter":183}],148:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{constructor(e,t){this.config=e,this.tokenService=t,this.currentLoadFailures=0,this.eventIndex=0,this.isExecuted=!1}handleLoadFailure(e,t){this.currentLoadFailures++,this.eventIndex++,this.currentLoadFailures>=this.config.loadFailuresThreshold&&!this.isExecuted&&(this.isExecuted=!0,null==t||t.report({name:"cbt",id:3e3},{callfailreason:e}),this.tokenService.updateToken({cbt:!0}))}handleLoadSuccess(){this.config.consecutive&&(this.currentLoadFailures=0)}isEnable(){return!0}toString(){return JSON.stringify(this.config)}}class r{handleLoadFailure(e){}handleLoadSuccess(){}isEnable(){return!1}toString(){return"0"}}t.exports=function(e,t,n){var a,o,s,d;let l=e.bidLimit,c=null===(a=e.networkConfig)||void 0===a?void 0:a.bidLimit,u=null===(o=e.epConfig)||void 0===o?void 0:o.bidLimit;const p=null!==(d=null!==(s=null!=u?u:c)&&void 0!==s?s:l)&&void 0!==d?d:{};return 0===Object.keys(p).length?new r:new i(p,t)}},{}],149:[function(e,t,n){function i(t,n){var i="NativeCallback",r="globals",a="graphicAssets",o="ad-player",s=!1,d=e("./Cache/CacheConstants"),l={},c={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},"ad-player":{cache:[],cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},u={Interstitial:{numOfBannersToCache:1}},p,f=function(e){return 0!==c[e.cacheBase].cache.length?(c[e.cacheBase].currentAd+1)%c[e.cacheBase].cache.length:0},g=function(e){e=e||{},t.Utils.each(c,(function(n,i){var r=n;c[r].cache&&0!==c[r].cache.length&&t.Utils.isDefined(e)&&e.hasOwnProperty(r)&&c[r].cache.sort((function(t,n){return e[r].indexOf(t.id)<e[r].indexOf(n.id)?-1:1}))}))},v=function(e){var n,i=e.length;for(n=0;n<i;n++)t.Utils.isDefined(e[n])&&e[n]&&t.PubSub.unsubscribe(e[n])},m=function(e){n.log("cache: "+JSON.stringify(c[e].cache)+" currentAd: "+c[e].currentAd,n.LogLevels.info),n.log("queue: "+JSON.stringify(c[e].cacheQueue),n.LogLevels.info)},h=function(e,t){var n,i=null,r=c[e.cacheBase].cacheQueue.length;for(n=0;n<r;n++)if(c[e.cacheBase].cacheQueue[n].cachingStatus===t){i=c[e.cacheBase].cacheQueue[n];break}return i},b=function(e,t){return e.cacheBase+"/"+t},S=function(e,t){var i=c[e.cacheBase].evaluatedCache.map((function(e){return n.AdUtils.getAdId(e)}));if(i.length>0){var r=i.indexOf(t.toString());r>=0&&(n.log("Removing ad from evaluatedCache! "+t,n.LogLevels.verbose),c[e.cacheBase].evaluatedCache.splice(r,1))}},y=function(e,t){var i=n.AdUtils.getAdId(t);if(t&&i){var r,a=c[e.cacheBase].cacheQueue.length;for(r=0;r<a;r++)c[e.cacheBase].cacheQueue[r].id==i&&(c[e.cacheBase].cacheQueue[r]=t)}},A=function(e,n){var i=-1;t.Utils.each(c[n.cacheBase].cache,(function(n,r){return!(t.Utils.isDefined(r.inventoryIndex)&&r.inventoryIndex>e.inventoryIndex||!t.Utils.isDefined(r.inventoryIndex))||(i=n,!1)})),-1===i?c[n.cacheBase].cache.push(e):c[n.cacheBase].cache.splice(i,0,e);var r={};r.cacheBase=n.cacheBase,r.id=e.id,r.inventoryId=e.inventoryId,r.demandSourceName=e.demandSourceName,t.PubSub.publish("Cache.campaignSaved",[r])},C=function(e){t.Utils.each(c[e.cacheBase].cacheQueue,(function(t,i){if(i.cachingStatus===p.cachingStatus.none&&0===c[e.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(i)})).length&&0===c[e.cacheBase].evaluatedCache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(i)})).length)return c[e.cacheBase].evaluatedCache.push(i),!1}))},I=function(e,t){var i=c[e.cacheBase].cache.map((function(e){return n.AdUtils.getAdId(e)}));if(i.length>0){var r=i.indexOf(t.toString());r>=0&&(n.log("Removing ad from cache array! "+t,n.LogLevels.verbose),c[e.cacheBase].cache.splice(r,1))}},w=function(e,t){return n.getGlobalAppData().then((function(i){i.cachePriorityArray=i.cachePriorityArray||{};var r=i.cachePriorityArray[e.cacheBase];if(r){var a=r.indexOf(t.toString());a>=0&&(n.log("Removing ad from cache array! "+t,n.LogLevels.verbose),r.splice(a,1),i.cachePriorityArray=r)}return n.setGlobalAppData(i)}))};function D(e,r){c[e.cacheBase].evaluatedCache.length;var a,o,s,d,f=c[e.cacheBase].cacheQueue.length,g=(u[e.cacheBase].numOfBannersToCache,null),m=null,I=null,w=null,D=null,P=[],F=[],O=[],T=0,N={};for(s=jQuery.Deferred(),o=0;o<f;o++)c[e.cacheBase].cacheQueue[o].cachingStatus!==p.cachingStatus.pending&&c[e.cacheBase].cacheQueue[o].cachingStatus!==p.cachingStatus.queued||0;var L=function(){c[e.cacheBase].evaluatedCache.length>0?(n.log("line[182]: evaluatedCache is: "+JSON.stringify(c[e.cacheBase].evaluatedCache),n.LogLevels.verbose),(a=h(e,p.cachingStatus.none))?(a.cachingStatus=p.cachingStatus.pending,S(e,n.AdUtils.getAdId(a)),a.numOfAssetsCached=0,l[e.cacheBase][a.id]=[],O.push(n.AdUtils.getAdId(a)),a.preProcessing().then((function(n){if(!t.Utils.isDefined(n))return t.Utils.returnResolvedPromise();a=Y(n),y(e,a)}),(function(){var i={};i.cacheBase=e.cacheBase,i.id=n.AdUtils.getAdId(a),i.inventoryId=a.inventoryId,i.demandSourceName=a.demandSourceName,t.PubSub.publish("Cache.preProcessingFailed",[i]),P.push(i.id),s.reject(c[e.cacheBase].cache,P)})).then((function(){var i={};i.cacheBase=e.cacheBase,i.id=a.id,i.demandSourceName=a.demandSourceName,t.PubSub.publish("Cache.campaignDownloadStarted",[i]),N={},0===a.assets.length?V(e,n.AdUtils.getAdId(a)):(n.log("campaign "+a.id+" download started",n.LogLevels.info),n.cacheAdUnitAssets(b(e,a.id),a))}))):(v([g,m,D,I,w]),0===P.length?s.resolve(c[e.cacheBase].cache):s.reject(c[e.cacheBase].cache,P,F))):(h(e,p.cachingStatus.pending)&&n.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",n.LogLevels.verbose),v([g,m,D,I,w]),0===P.length?s.resolve(c[e.cacheBase].cache):s.reject(c[e.cacheBase].cache,P,F))},M=function(e){v([I,w]),e&&(L())},V=function(e,a,o,s){var u,f,g=s&&s.hasOwnProperty("file")?s.file:null,v=!(!s||!s.hasOwnProperty("status"))&&s.status,m=[];if((u=E(e,a))&&ne(v,N,g,u.assets,r)){if(r.cacheBase=e.cacheBase,N[g]={isSuccessfullyCached:v},!ie(o,g,N,u.assets,T,r))return void T++;T=0}if(l[e.cacheBase][a].push(s),u&&u.id&&l[e.cacheBase][u.id].length===u.assets.length)if(n.log("campaign "+u.id+" download finished!",n.LogLevels.info),d=k(l[e.cacheBase][u.id],(function(e){return e.status})),f=B(l[e.cacheBase][u.id],u,(function(e){return e.status})),0===u.assets.length&&(d=!0),delete l[e.cacheBase][u.id],d){if(u.cachingStatus=p.cachingStatus.queued,c[e.cacheBase].evaluatedCache.length>=0){U(e,u.id,!1),u.numOfAssetsCached=u.assets.length,A(u,e),m=c[e.cacheBase].cache.map((function(e){return n.AdUtils.getAdId(e)})),e.inventoryId=u.inventoryId,e.demandSourceName=u.demandSourceName;var h=t.Utils.extend(!0,{},e,{inventoryId:u.inventoryId,demandSourceName:u.demandSourceName});t.PubSub.publish("Cache.cacheUpdated",[h])}else n.log("Cache full, could not enter new ad",n.LogLevels.error);m.length>0?(n.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+m,n.LogLevels.verbose),n.setCachePriorityArrayKey(e,m).always((function(){L()}))):L()}else U(e,a,!1),C(e),I=t.PubSub.subscribe(i+".deleteFolderFailed",(function(e){n.log("in delete failure from cache next",n.LogLevels.verbose),n.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(n.log("deleting folder failed: "+JSON.stringify(e),n.LogLevels.error),t.Utils.isDefined(e.errCode)&&1==e.errCode?M(!0):M(!1))})),w=t.PubSub.subscribe(i+".deleteFolderSuccess",(function(e){n.log("in delete success from cache next",n.LogLevels.verbose),n.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(n.log("deleting folder success: "+JSON.stringify(e),n.LogLevels.info),M(!0))})),P.push(u.id),f&&F.push({id:u.id,failedAssetsUrlsArray:f.failedAssetsUrlsArray}),n.deleteFolder(o)};return g=t.PubSub.subscribe(i+".assetCached",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"assetCached",a).didSucceed){var o,s=x(i.path),d=decodeURIComponent(i.path),c={file:i.file,status:!0};-1!==O.indexOf(s.id)?t.Utils.isDefined(l[s.type][s.id])&&s.type===e.cacheBase?(n.log("asset cached success: "+s.id+"/"+i.file,n.LogLevels.verbose),o={cacheBase:s.type},E(o,s.id).numOfAssetsCached++,V(o,s.id,d,c)):n.log("Exiting asset cached. folder:"+s.id+" responses array:"+JSON.stringify(l),n.LogLevels.error):n.log("ad is not recognised in this scope: "+s.id+" adForCaching:"+O,n.LogLevels.info)}})),m=t.PubSub.subscribe(i+".assetCachedFailed",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"assetCachedFailed",a).didSucceed){var o,s=x(i.path),d=decodeURIComponent(i.path),c={file:i.file,status:!1};-1!==O.indexOf(s.id)&&(t.Utils.isDefined(l[s.type][s.id])&&s.type===e.cacheBase?(n.log("asset cached failed: "+s.id+"/"+i.file+" with error: "+i.errMsg,n.LogLevels.error),o={cacheBase:s.type},V(o,s.id,d,c)):n.log("Exiting asset cached failed. folder:"+s.id+" responses array:"+JSON.stringify(l),n.LogLevels.error))}})),D=t.PubSub.subscribe(i+".preCacheFileFail",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"preCacheFileFail",a).didSucceed){var o,s=x(i.path),d=decodeURIComponent(i.path),c={file:i.file,status:!1};-1!==O.indexOf(s.id)&&(t.Utils.isDefined(l[s.type][s.id])&&s.type===e.cacheBase?(n.log("pre cache file fail: "+i.file+" with error: "+i.errMsg,n.LogLevels.error),o={cacheBase:s.type},V(o,s.id,d,c)):n.log("Exiting preCache file fail. folder:"+s.id+" responses array:"+JSON.stringify(l),n.LogLevels.error))}})),L(),s.promise()}var P=function(e,t){return e&&e.files&&Array.isArray(e.files)&&"ads"===t},F=function(e){var t;try{t=parseInt(e)}catch(e){t=0}return t},O=function(e,i,r){var a,o;for(a in i)if(i.hasOwnProperty(a)){if("userUniqueId"===a||"applicationUserId"===a||"applicationKey"===a)continue;if("files"===a){e.cache=i[a];continue}if(P(i[a],r)){e.cache.push({id:a,numOfAssetsCached:t.Utils.isDefined(i[a].files)?i[a].files.length:0,lastUpdateTime:t.Utils.isDefined(i[a].lastUpdateTime)?F(i[a].lastUpdateTime):0,assets:t.Utils.isDefined(i[a].files)?i[a].files:[]});continue}if("lastUpdateTime"===a)return;n.isRootFolder(a)?o=e:(p.initCacheBase(a),o=e[a]),O(o,i[a],a)}},T=function(e){t.Utils.isDefined(e)&&e&&e!={}?O(c,e):c={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},x=function(e){var n=decodeURIComponent(e).split("/");return{type:n[0],id:t.Utils.isDefined(n[1])?n[1]:null}},N=function(e){var t=e.split("#");return t.length>1?t[t.length-1]:(t=e.split("/"))[t.length-1]},L=function(e,t){var n=-1;if(!e)return n;var i,r=N(t),a=e.length;for(i=0;i<a;i++)if(N(e[i])===r){n=i;break}return n},U=function(e,t,n){var i,r=c[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<c[e.cacheBase].cacheQueue.length;i++)r[i].id!=t?a.push(r[i]):(o&&!n&&a.push(r[i]),o=!0);c[e.cacheBase].cacheQueue=a},M=function(e,a){var s,d,l,u,f=0,g=c[e.cacheBase].cache.length,m=[],h=[],b=jQuery.Deferred(),S=function(e,n){-1!==m.indexOf(decodeURIComponent(e.path))&&(e.success=n,h.push(e),h.length>=m.length&&(v([l,u]),k(h,(function(e){return t.Utils.isDefined(e.success)&&e.success}))?b.resolve():b.reject()))};if(u=t.PubSub.subscribe(i+".deleteFolderFailed",(function(i){n.checkRequiredCallbackParams(["path"],i,"deleteFolderFailed").didSucceed&&-1!==i.path.indexOf(e.cacheBase)&&(n.log("deleting folder failed: "+JSON.stringify(i),n.LogLevels.error),t.Utils.isDefined(i.errCode)&&1==i.errCode?S(i,!0):S(i,!1))})),l=t.PubSub.subscribe(i+".deleteFolderSuccess",(function(i){if(n.checkRequiredCallbackParams(["path"],i,"deleteFolderSuccess").didSucceed&&-1!==i.path.indexOf(e.cacheBase)){n.log("deleting folder success: "+JSON.stringify(i),n.LogLevels.info),S(i,!0);var r=x(i.path);if(null!==r.id){var a={};a.cacheBase=r.type,a.id=r.id,a.inventoryId=r.inventoryId,t.PubSub.publish("Cache.campaignDeleted",[a])}}})),-1!==[r,o].indexOf(e.cacheBase))c[e.cacheBase].cache=[],c[e.cacheBase].cacheQueue=[],m.push(e.cacheBase);else{for(f=0;f<g;f++)t.Utils.isDefined(c[e.cacheBase].cache[0].id)||n.log("something went wrong. len="+g+" cache size= "+c[e.cacheBase].cache.length+" first element="+JSON.stringify(c[e.cacheBase].cache[0]),1),s=c[e.cacheBase].cache[0].id.toString(),t.Utils.isDefined(s)&&-1===a.indexOf(s)&&(d=e.cacheBase+"/"+s,-1===m.indexOf(d)&&m.push(d)),c[e.cacheBase].cache.shift();for(g=c[e.cacheBase].cacheQueue.length,f=0;f<g;f++)s=c[e.cacheBase].cacheQueue[0].id,t.Utils.isDefined(s)&&c[e.cacheBase].cacheQueue[0].cachingStatus!==p.cachingStatus.none&&(d=e.cacheBase+"/"+s,-1===m.indexOf(d)&&m.push(d)),c[e.cacheBase].cacheQueue.shift()}if(0===m.length)v([l,u]),b.resolve();else for(n.log("Removing irrelevant campaigns: "+JSON.stringify(m)),f=0;f<m.length;f++)n.deleteFolder(m[f]);return b.promise()},V=function(e,t){var n,i=null,r=c[e.cacheBase].cache,a=c[e.cacheBase].cache.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},E=function(e,t){var n,i=null,r=c[e.cacheBase].cacheQueue,a=c[e.cacheBase].cacheQueue.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},k=function(e,t){var n,i=e.length,r=!0;for(n=0;n<i;n++)r=r&&t(e[n]);return r};function B(e,t,n){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,t){if(!e||!e.assets)return null;var n=e.assets,i=t.split("?");t=i[0];for(var r=0;r<n.length;r++){if(t&&-1!==n[r].indexOf(t))return n[r].split("?")[0]}return null};for(i=0;i<r;i++)if(!n(e[i])){var s=o(t,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var R=function(){t.PubSub.subscribe(i+".printCache",(function(e){t.Utils.isDefined(e.type)&&m(e.type)}))},K=function(e,i,r){var a=0,o=!1;return t.Utils.each(c[r.cacheBase].cache,(function(t,r){if(e.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(r)})).length>0&&++a>=i)return o=!0,!1})),o},j=function(e,t,i,r){var a,o=e.slice(0,t),s=[];for(c[r.cacheBase].evaluatedCache=[],a=0;a<o.length;a++)0===c[r.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(o[a])&&_(e,o[a])})).length&&c[r.cacheBase].evaluatedCache.push(o[a]);for(a=0;a<o.length;a++)0===c[r.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(o[a])&&!_(e,o[a])})).length&&s.push(o[a]);for(a=t;a<e.length;a++)c[r.cacheBase].cache.filter((function(t){return n.AdUtils.getAdId(t)===n.AdUtils.getAdId(e[a])&&_(t,e[a])})).length>0&&s.push(e[a]);var d,l=e.length;for(a=0;a<c[r.cacheBase].cache.length;a++)0===e.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(c[r.cacheBase].cache[a])})).length&&(c[r.cacheBase].cache[a].inventoryIndex=++l,s.push(((d=c[r.cacheBase].cache[a]).adId=d.id,d.staticContent=d.assets,d)));return c[r.cacheBase].mergedAds=s.slice(0,i),c[r.cacheBase].mergedAds},_=function(e,t){if(!e||!t)return n.log("line[750]: entering isCachedAdStillUpdated with no ad",n.LogLevels.verbose),!1;var i=X(e.assets),r=X(t.staticContent);return n.log("cachedAdNumOfUniqueAssets: "+i+", newAdNumOfUniqueAssets:"+r,n.LogLevels.verbose),i===r&&(W(t)||e.lastUpdateTime==t.lastUpdateTime)},W=function(e){return e&&"0"!==e.creativeId},G=function(e,t){return c[t]&&c[t].cache.indexOf(e)>-1};function H(e){if(!e)return null;var t=c[d.adsAssetsCacheDir]&&c[d.adsAssetsCacheDir].cache;if(!t)return null;for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.id===e)return i}return null}function q(e){return e&&e.assets?e.assets.length:0}function J(){var e=c[d.adsAssetsCacheDir]&&c[d.adsAssetsCacheDir].cache;if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n].id);return t}function Q(e){var t=H(n.AdUtils.getAdId(e));return!!(t&&e.adAssets&&q(t)>=e.adAssets.length)}function $(e,i){if(e&&i&&Array.isArray(i)&&0!==i.length){var r=n.AdUtils.getAdId(e);c[d.adsAssetsCacheDir]||(c[d.adsAssetsCacheDir]={}),c[d.adsAssetsCacheDir].cache||(c[d.adsAssetsCacheDir].cache=[]);for(var a=c[d.adsAssetsCacheDir].cache,o=[],s=0;s<a.length;s++){var l=a[s];l.id===r&&(o=l.assets,a.splice(s,1))}var u={id:r,assets:o.concat(i.filter((e=>o.indexOf(e)<0))),lastUpdateTime:e.lastUpdateTime?e.lastUpdateTime:0,inventoryIndex:t.Utils.isDefined(e.inventoryIndex)?e.inventoryIndex:-1};a.push(u)}}var z=function(e,t,n){var i=V(e,t);i&&(i.inventoryIndex=n)},X=function(e){var i,r=[];return e?(t.Utils.each(e,(function(e,t){i=N(t),-1===L(r,i)&&r.push(i)})),r.length):(n.log("cannot extract unique assets count",n.LogLevels.error),-1)},Y=function(e){var i={id:n.AdUtils.getAdId(e),demandSourceName:e.demandSourceName,assets:e.staticContent||[],lastUpdateTime:t.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:p.cachingStatus.none,preProcessing:e.preProcessing||t.Utils.returnResolvedPromise};return t.Utils.isDefined(e.credits)&&(i.credits=e.credits),t.Utils.isDefined(e.inventoryIndex)&&(i.inventoryIndex=e.inventoryIndex),i},Z=function(e,t){var n={};n.failedCachedFile=e,n.listOfFilesUrls=t;var i=e.split("?");e=i[0];for(var r=0;r<t.length;r++)if(-1!==t[r].indexOf(e))return t[r];return!1},ee=function(e,t,n,i,r,a,o){return{cacheBase:e,productType:t,demandSourceName:n,file:i,currentRetryAttempt:r,totalRetryAttempts:a,assetType:o}},te=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},ne=function(e,t,n,i,r){return n&&i&&i.length>0&&(!e||t[n])&&te(r)},ie=function(e,i,r,a,o,s){var d,l=!0,c=Z(i,a),u=s.retryAttempts,p=s.retryInterval,f={cacheBase:e,failedCachedFile:i,listOfFilesUrls:a};if(c)return r[i].isSuccessfullyCached?o>0&&r[i].isSuccessfullyCached&&(d=ee(e,s.productType,s.demandSourceName,c,o,u,s.assetType),t.PubSub.publish("Cache.assetRetrySuccess",[d])):o<u?(l=!1,setTimeout((function(){n.cacheAsset(e,c)}),1e3*p)):(d=ee(e,s.productType,s.demandSourceName,c,o,u,s.assetType),t.PubSub.publish("Cache.assetRetryFailed",[d])),l;t.PubSub.publish("Cache.executeRetryFileUrlEmpty",[f])},re={init:function(e,t){return p=this,s||(T(e),R(),s=!0),g(t),s},initCacheBase:function(e){c[e]||(c[e]={cache:[],currentAd:0,cacheQueue:[]}),l[e]||(l[e]={})},setAdInventoryIndex:z,cacheNext:function(e,t){return n.log("line[707]: recalling cache next",n.LogLevels.verbose),C(e),D(e,t)},incrementNextCampaign:function(e){c[e.cacheBase].currentAd=f(e)},isNextAvailable:function(e,t){return p.getCurrentAd(e,t)},setSettings:function(e,t){u[e.cacheBase]=t},getCacheSizeByType:function(e){var t=c[e.cacheBase];return t&&t.hasOwnProperty("cache")?t.cache.length:0},cacheGlobalAssets:function(e,t){return p.cacheFilesByFolder("globals",e,t)},cacheGraphicAssets:function(e,t){return p.cacheFilesByFolder("graphicAssets",e,t)},cacheFilesByFolder:function(e,s,d){var l,u,p,f,g,m=s.length,h=[],b=0,S={};if(!c.hasOwnProperty(e))return t.Utils.returnResolvedPromise();u=jQuery.Deferred();var y=c[e].cache,A=c[e].cacheQueue,C=function(t,n){if(ne(n,S,t,s,d)){if(S[t]={isSuccessfullyCached:n},d.cacheBase=e,!ie(e,t,S,s,b,d))return void b++;b=0}h.push({file:t,status:n}),I(t),h.length>=m&&(v([p,f,g]),k(h,(function(e){return e.status}))?(y=s.map((function(e){return e.replace(/^.*[\\\/]/,"")})),u.resolve(y)):u.reject())},I=function(e){var t=A.indexOf(e);t>-1&&A.splice(t,1)};for(p=t.PubSub.subscribe(i+".assetCached",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"assetCached",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("asset cached success: "+e.file,n.LogLevels.verbose),C(e.file,!0))})),f=t.PubSub.subscribe(i+".assetCachedFailed",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("asset cached failed: "+e.file+" with error: "+e.errMsg,n.LogLevels.error),C(e.file,!1))})),g=t.PubSub.subscribe(i+".preCacheFileFailed",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("failed to request to save file:"+e.file+" with error "+e.errMsg,n.LogLevels.error),C(e.file,!1))})),l=0;l<m;l++)-1===L(y,s[l])?(-1===L(A,s[l])?A.push(s[l]):I(s[l]),n.cacheAsset(e,s[l])):-1!==L(y,s[l])&&C(s[l],!0);return 0===m&&v([p,f,g]),u.promise()},cacheLibsAsset:function(e){var t=jQuery.Deferred(),i=e.replace(/^.*[\\\/]/,"");return c.libs.cacheQueue.push(i),n.cacheAsset("libs",e).then((function(){!function(e){c.libs.cache.push(i);var t=c.libs.cacheQueue.indexOf(e);-1!==e&&c.libs.cacheQueue.splice(t,1)}(e),t.resolve(c.libs.cache)}),(function(){t.reject("Libs asset cache failed: "+e)})),t.promise()},cacheAds:function(e,t,n,i){var r,a=n.length;for(r=0;r<a;r++){var o=Y(n[r]);c[e.cacheBase].cacheQueue.push(o)}return D(e,i)},cacheSingleAd:function(e,t,n){c[e.cacheBase].cacheQueue.splice(0,0,Y(t)),p.cacheNext(e,n)},clearCacheByType:function(e,i){var r,a,o=i.length,s=[],d=null,l=[],u=jQuery.Deferred();if(0===c[e.cacheBase].cache.length&&0===c[e.cacheBase].cacheQueue.length)return u.resolve(c[e.cacheBase].cache),u.promise();for(r=0;r<o;r++)a=n.AdUtils.getAdId(i[r]),d=V(e,a),_(d,i[r])&&(l.push(a),t.Utils.isDefined(i[r].credits)&&!t.Utils.isDefined(d.credits)&&(d.credits=i[r].credits),s.push(d));return jQuery.when(M(e,l)).then((function(){c[e.cacheBase].cache=s,u.resolve(c[e.cacheBase].cache)}),(function(){n.log("error in clear cache by type",n.LogLevels.error),u.reject()})),u.promise()},getCurrentAd:function(e,i){var r=null;return e&&e.cacheBase&&i?(t.Utils.each(i,(function(i,a){return t.Utils.each(c[e.cacheBase].cache,(function(e,t){return!(r=n.AdUtils.getAdId(t)===n.AdUtils.getAdId(a)?t:r)})),!r})),r):null},getNextAvailableAd:function(){return{}},getCacheByType:function(e){return c[e.cacheBase]},getRootCacheStructure:function(){return c},isAdInCache:function(e,t){var n,i=!1,r=c[e.cacheBase],a=r&&r.cache?r.cache.length:0;for(n=0;n<a;n++)if(r.cache[n].id===t){i=!0;break}return i},getAdStatusInQueue:function(e,t){var n=E(e,t);return n?n.cachingStatus:null},setAppData:function(e){return n.setGlobalAppData(e)},getAppData:function(){return n.getGlobalAppData()},deleteCachedAsset:function(e,t){return n.deleteAsset(e,t)},deleteCachedListOfAssets:function(e,t){var i,r=new jQuery.Deferred,a=[],o=0;if(0===t.length)return r.resolve(0),r.promise();for(i=0;i<t.length;i++)a.push(n.deleteAsset(e,t[i]));return jQuery.when.apply(null,a).always((function(){var e=arguments;for(i in e)e[i]&&o++;r.resolve(o)})),r.promise()},deleteCachedCampaign:function(e,t){var i=e.cacheBase+"/"+t;return n.deleteFolder(i),I(e,t),w(e,t)},isFileInCache:G,getCachedAdFolder:H,getAmountOfAssetsInAdFolder:q,isAdExistInCacheAndContainsAssets:Q,setAdInAdsFolder:$,mergeCampaigns:j,areCampaignsAvailable:K,getFileIndexInCache:L,removeAdFromCacheArray:I,cachingStatus:{none:0,pending:1,queued:2}};return re}t.exports=i},{"./Cache/CacheConstants":156}],150:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Unknown=-1]="Unknown",e[e.FolderAndAssetsDoNotExist=0]="FolderAndAssetsDoNotExist",e[e.FolderAndAssetsExist=1]="FolderAndAssetsExist",e[e.FolderExistsAssetsDoNotExist=2]="FolderExistsAssetsDoNotExist"}(i||(i={}));t.exports=class{constructor(e,t){this.controller=e,this.cacheUtils=t}isAdExistInCache(e){return this.getCacheStatusOfAd(e)===i.FolderAndAssetsExist}getCacheStatusOfAd(e){const t=this.controller.AdUtils.getAdId(e);if(!(null==e?void 0:e.adAssets)||!t)return i.Unknown;const n=this.controller.Cache.getCachedAdFolder(t);if(!n)return i.FolderAndAssetsDoNotExist;return e.adAssets.some((e=>!this.isAssetInAdsCacheFolder(e.URL,t,n)))?i.FolderExistsAssetsDoNotExist:i.FolderAndAssetsExist}isAssetInAdsCacheFolder(e,t,n=this.controller.Cache.getCachedAdFolder(t)){const i=this.cacheUtils.extractFileNameFromURL(e);if(!i||!n)return!1;return n.assets.some((e=>this.controller.getCacheFileEncodingPatch().isFileNameMatches(e,i)))}}},{}],151:[function(e,t,n){t.exports=function(e,t,n,i){function r(e,t,n,i,r){var o=e+n-i,s=t.length;return s<o?(a(r,i,e),t):s===o?t:s>o?t.splice(0,o):void 0}function a(t,n,i){e.PubSub.publish("AdsAssetsClearanceService.cacheReachedMaximumCapacity",[{demandSourceName:t.demandSourceName,productType:t.productType,maxAdsToSaveInCache:n,amountOfAdsCached:i}])}return{enactClearanceLogic:function(e,o,s,d,l){var c=function(e){for(var n=[],i=[],r=e.length,a=0;a<r;a++)t.isAdExistInCacheAndContainsAssets(e[a])?i.push(e[a]):n.push(e[a]);return{adsFromFeedThatAreNotInCache:n,adsThatWereAlreadyInTheCache:i}}(e),u=c.adsFromFeedThatAreNotInCache,p=t.getCacheSizeByType(s);if(o=function(e,t,n){for(var r=e,a=i.getAdIdsOfAds(n),o=0;o<r&&o<t.length;o++){var s=t[o].isCacheable,d=i.getAdId(t[o]),l=-1!==a.indexOf(d);s&&!l||e--}return e}(o,e,c.adsThatWereAlreadyInTheCache),function(e,t){return t<=0||0===e.length}(u,o)||function(e,t,n){return e+t<=n}(p,o,d))return{adsToCache:u,adsToRemoveFromCache:[],adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache};var f=function(e){for(var i=t.getCacheByType(e).cache,r=[],a=i.length,o=0;o<a;o++){var s=i[o];0===n.getReferenceCountOfAd(s.id)&&r.push(s)}return r}(s);return 0===f.length?(a(l,d,p),{adsToCache:u,adsToRemoveFromCache:[],adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache}):{adsToCache:u,adsToRemoveFromCache:r(p,f,o,d,l),adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache}}}}},{}],152:[function(e,t,n){t.exports=function(t,n,i){var r,a,o,s,d=e("./CacheConstants"),l=new(e("./CacheUtils"))(t,n),c=new(e("./AdsReferencesManager")),u={},p={},f={};function g(e,r,a,o){var c=n.AdUtils.getAdId(r);if(!l.isAssetValid(e))return t.Utils.returnRejectedPromise(d.errors.cacheAssetInvalidParams);var u=e[d.assetKeys.URL],p=l.extractFileNameFromURL(u);if(!p)return I("urlNotMatched",{demandSourceName:a.demandSourceName,productType:a.productType,asset:e,ad:r}),t.Utils.returnRejectedPromise(d.errors.cacheAssetInvalidParams);if(s.isAssetInAdsCacheFolder(p,c))return e[d.assetKeys.file]=p,t.Utils.returnResolvedPromise(e);var f=new jQuery.Deferred,g=l.buildAdFolderPath(c);return function(e,i,r){var a=[],o=t.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",c),s=t.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedFailure",u);function c(o){o[d.assetKeys.path]===i&&n.getCacheFileEncodingPatch().isFileNameMatches(l.extractFileNameFromURL(o[d.assetKeys.file]),l.extractFileNameFromURL(e[d.assetKeys.URL]))&&(t.PubSub.clearHandlers(a),e[d.assetKeys.path]=l.buildAdAssetsPath(o[d.assetKeys.path],o[d.assetKeys.file]),e[d.assetKeys.file]=o[d.assetKeys.file],r.resolve(e))}function u(i){n.getCacheFileEncodingPatch().isFileNameMatches(l.extractFileNameFromURL(i[d.assetKeys.file]),l.extractFileNameFromURL(e[d.assetKeys.URL]))&&(t.PubSub.clearHandlers(a),r.reject("failed caching file "+i[d.assetKeys.file]))}a.push(o,s)}(e,g,f),i.saveFileWithRetry(u,g,a,o),f.promise()}function v(e,r,o){var c=n.AdUtils.getAdId(e);if(!c)return t.Utils.returnRejectedPromise("Failed to cache ad "+c||n.AdUtils.getBannerId(e));if(!e.isCacheable)return t.Utils.returnResolvedPromise();if(I("adAssetsCacheStatus",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e,adAssetsCacheStatus:s.getCacheStatusOfAd(e)}),s.isAdExistInCache(e))return t.Utils.returnResolvedPromise();if(function(e){return u.hasOwnProperty(e)}(c))return function(e){if(u.hasOwnProperty(e))return u[e];return t.Utils.returnResolvedPromise()}(c);var p=new jQuery.Deferred;!function(e,t){u.hasOwnProperty(e)||(u[e]=t)}(c,p.promise());for(var f=[],v=0;v<e.adAssets.length;v++)f.push(g(e.adAssets[v],e,r,o));return jQuery.when.apply(null,f).then((function(){var n=t.Utils.convertArrayLikeObjectToArray(arguments);!function(e,t){if(!t||!Array.isArray(t))return;for(var n=[],i=0;i<t.length;i++){var r=t[i];r&&r.hasOwnProperty(d.assetKeys.file)&&n.push(r[d.assetKeys.file])}a.setAdInAdsFolder(e,n)}(e,n),b(c),I("saveAdInCacheSuccess",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e}),p.resolve()}),(function(a){A(n.AdUtils.getAdId(e),r.instanceUniqueId),I("saveAdInCacheFailure",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e});var o=l.buildAdFolderPath(c);!function(e,i,r,a,o){var s=[],d=n.AdUtils.getAdId(e),l=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",u),c=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",u);function u(n){n.path===i&&(t.PubSub.clearHandlers(s),I("deleteAdFromCacheSuccess",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),b(d),a.reject("ad "+d+" failed to cached with reason: "+r))}s.push(l,c)}(e,o,a,p,r),i.deleteFolder(o)})),p.promise()}function m(e,t,n,i,r){t<=0?r.resolve():0===e.length&&t>0?r.reject(d.errors.cacheMandatoryAdsFailed):v(e.shift(),n,i).then((function(){t--,m(e,t,n,i,r)})).fail((function(){m(e,t,n,i,r)}))}function h(e,t,n,i){t<=0||0===e.length||v(e.shift(),n,i).then((function(){t--,h(e,t,n,i)})).fail((function(){h(e,t,n,i)}))}function b(e){u.hasOwnProperty(e)&&delete u[e]}function S(e){p.hasOwnProperty(e)&&delete p[e]}function y(e,t){c.setReferenceForAd(e,t)}function A(e,t){c.unsetReferenceForAd(e,t)}function C(e,r){var o=n.AdUtils.getAdId(e);return function(e){return null===a.getCachedAdFolder(e)}(o)?t.Utils.returnResolvedPromise():function(e){return p.hasOwnProperty(e)}(o)?function(e){return p.hasOwnProperty(e)?p[e]:t.Utils.returnResolvedPromise()}(o):function(e,r){var o=n.AdUtils.getAdId(e),s=new jQuery.Deferred;!function(e,t){p.hasOwnProperty(e)||(p[e]=t)}(o,s.promise());var d=l.buildAdFolderPath(o);return function(e,i,r,o){var s=[],d=n.AdUtils.getAdId(e),c=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",f),u=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",p);function p(n){n.path===i&&(t.PubSub.clearHandlers(s),S(d),I("deleteAdFromCacheFailure",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),r.reject(n.errorMsg))}function f(n){n.path===i&&(t.PubSub.clearHandlers(s),S(d),a.removeAdFromCacheArray(l.getAdLevelCacheConfiguration(),d),I("deleteAdFromCacheSuccess",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),r.resolve())}s.push(c,u)}(e,d,s,r),i.deleteFolder(d),s.promise()}(e,r)}function I(e,n){t.PubSub.publish("AdsAssetsManager."+e,[n])}return{init:function(i,u){a=i,function(e){if(0===Object.keys(e).length)return;n.getSegmentationAllocator().addAdLevelCacheSegment(e.adLevelCacheGroup)}(f=u||{}),o=f[d.maxAdsToSaveInCache]||d.defaultMaxAdsToSaveInCache,r=new(e("./AdsAssetsClearanceService"))(t,a,c,n.AdUtils),s=new(e("./AdCacheStatus"))(n,l)},setAdAssetsForAds:function(e){if(e)for(var t=0;t<e.length;t++)e[t].adAssets=l.extractAssetsFromAd(e[t])},cacheAssetsOfAd:v,cacheAdsWithClearanceLogic:function(e,n,i,a,c){if(0===e.length||!n||!r)return t.Utils.returnResolvedPromise(d.errors.cacheAdsWithClearanceLogicConfigurationProblem);var u=JSON.parse(JSON.stringify(e));return function(e,n){if(0===e.length)return t.Utils.returnResolvedPromise();for(var i=[],r=new jQuery.Deferred,a=0;a<e.length;a++)i.push(C(e[a],n));jQuery.when.apply(null,i).then(r.resolve,r.reject),r.promise()}(r.enactClearanceLogic(u,n,l.getAdLevelCacheConfiguration(),o,a).adsToRemoveFromCache,a),function(e,n,i,r,a){function o(){return h(e,n,r,a),t.Utils.returnResolvedPromise()}if(!function(e){return e>0}(i)||function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable)return!1}return!0}(e,i))return o();if(function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable&&!s.isAdExistInCache(i))return!1}return!0}(e,i))return I("adsAlreadyCached",{demandSourceName:r.demandSourceName,productType:r.productType}),o();var d=JSON.parse(JSON.stringify(e));return function(e,t,n,i){var r=new jQuery.Deferred;return m(e,t,n,i,r),r.promise()}(d,i,r,a).then(o)}(u,n,i,a,c)},areNonMandatoryAdsToCacheConfigured:function(e,n){return!(!t.Utils.isDefined(e)||!t.Utils.isDefined(n))&&e<n},setReferencesForAds:function(e,t){var i;if(Array.isArray(e))for(var r=0;r<e.length;r++)(i=e[r])&&i.isCacheable&&y(n.AdUtils.getAdId(e[r]),t)},unsetReferencesForAds:function(e,t){if(Array.isArray(e))for(var i=0;i<e.length;i++)A(n.AdUtils.getAdId(e[i]),t)},unsetReferencesForInstance:function(e){c.unsetAllReferencesForReferrer(e)}}}},{"./AdCacheStatus":150,"./AdsAssetsClearanceService":151,"./AdsReferencesManager":154,"./CacheConstants":156,"./CacheUtils":157}],153:[function(e,t,n){t.exports=function(t,n){var i=e("./CacheConstants"),r=new(e("./CacheUtils"))(t);return{saveFileWithRetry:function(a,o,s,d){var l=[],c=new(e("./CacheAssetRetry"))(d,f),u=t.PubSub.subscribe("NativeCallback.assetCached",(function(e){if(e.path=decodeURIComponent(e.path),e[i.assetKeys.path]!==o||!n.getCacheFileEncodingPatch().isFileNameMatches(r.extractFileNameFromURL(e[i.assetKeys.file]),r.extractFileNameFromURL(a)))return;c.areRetryAttemptsPerformed()&&t.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetrySuccess",[{demandSourceName:s.demandSourceName,productType:s.productType,file:a,currentRetryAttempt:c.getAttemptsSoFar(),totalRetryAttempts:d.adAssetRetryAttempts}]);t.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",[e]),t.PubSub.clearHandlers(l)})),p=t.PubSub.subscribe("NativeCallback.assetCachedFailed",(function(e){if(e.path=decodeURIComponent(e.path),e[i.assetKeys.path]!==o||!n.getCacheFileEncodingPatch().isFileNameMatches(r.extractFileNameFromURL(e[i.assetKeys.file]),r.extractFileNameFromURL(a)))return;if(c.shouldExecuteRetry())return void c.performRetryWithDelay();c.areRetryAttemptsPerformed()&&t.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetryFailed",[{demandSourceName:s.demandSourceName,productType:s.productType,file:a,currentRetryAttempt:c.getAttemptsSoFar(),totalRetryAttempts:d.adAssetRetryAttempts,errMsg:e.errMsg}]);t.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedFailure",[e]),t.PubSub.clearHandlers(l)}));function f(){n.callSDKFunction("saveFile",{file:a,path:o,overrideExistingFile:!1})}l.push(u,p),f()},deleteFolder:function(e){if(e){var i=[],r=t.PubSub.subscribe("NativeCallback.deleteFolderSuccess",(function(r){n.isIOS()&&(r.path=decodeURIComponent(r.path));if(r.path!==e)return;t.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",[r]),t.PubSub.clearHandlers(i)})),a=t.PubSub.subscribe("NativeCallback.deleteFolderFailed",(function(r){n.isIOS()&&(r.path=decodeURIComponent(r.path));if(r.path!==e)return;t.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderFailure",[r]),t.PubSub.clearHandlers(i)}));i.push(r,a),n.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")}}}}},{"./CacheAssetRetry":155,"./CacheConstants":156,"./CacheUtils":157}],154:[function(e,t,n){t.exports=function(){var e={};function t(t,n){if(t&&n&&e.hasOwnProperty(t)){var i=e[t].indexOf(n);-1!==i&&e[t].splice(i,1)}}return{setReferenceForAd:function(t,n){t&&n&&(e.hasOwnProperty(t)||(e[t]=[]),-1===e[t].indexOf(n)&&e[t].push(n))},unsetReferenceForAd:t,unsetAllReferencesForReferrer:function(n){for(var i=Object.keys(e),r=0;r<i.length;r++)t(i[r],n)},getReferenceCountOfAd:function(t){return function(t){return t&&e.hasOwnProperty(t)?e[t]:[]}(t).length}}}},{}],155:[function(e,t,n){t.exports=function(e,t){var n=e&&e.adAssetRetryAttempts,i=e&&e.adAssetRetryInterval,r=0;return{shouldExecuteRetry:function(){return r<n&&"function"==typeof t},areRetryAttemptsPerformed:function(){return r>0},getAttemptsSoFar:function(){return r},performRetryWithDelay:function(){setTimeout((function(){r++,t()}),1e3*i)}}}},{}],156:[function(e,t,n){t.exports={assetKeys:{URL:"URL",size:"size",label:"label",path:"path",file:"file"},errors:{cacheAssetInvalidParams:"Unable to cache asset due to invalid cacheModule/adId/asset",cacheAdsWithClearanceLogicConfigurationProblem:"Unable to cacheAds due to not being in new flow/no ads/no need to cache ads/no clearance service",cacheMandatoryAdsFailed:"Failed to cache mandatory ads"},adsAssetsCacheDir:"ads",supportNewCacheStructureConfigurationKey:"supportNewCacheStructure",fileNameFromURLPattern:/[^/]+$/,adLevelCache:"adLevelCache",maxAdsToSaveInCache:"maxAdsToSaveInCache",defaultMaxAdsToSaveInCache:30}},{}],157:[function(e,t,n){t.exports=function(t,n){var i=e("./CacheConstants");e("../../components/AdUtils")(t,n);const{ExternalAdProtocolType:r}=e("../../components/adInterfaces");var{MraidCreativeLoadStrategy:a}=e("../../components/MraidCreativeService");return{isAssetValid:function(e){return e&&"string"==typeof e[i.assetKeys.URL]},extractAssetsFromAd:function(e){e.ext&&e.ext.appData&&e.ext.appData.adAssets&&(e.ext.appData.appImages=e.ext.appData.adAssets,delete e.ext.appData.adAssets);var i=[],o=[];o=(o=o.concat(function(e){if(n.AdUtils.isCampaignContainsMraidCreative(e.ext))return function(e){const i=n.AdUtils.getMraidCreativeLoadStrategy(e);if(n.AdUtils._isCustomHTMLCampaign(e.ext))return t.AdAssets.extractMraidPlayableSource(e,i);if(n.AdUtils.isMraidInteractiveEndCard(e.ext))return t.AdAssets.extractMraidInteractiveEndCardSource(e,i);return t.AdAssets.extractStaticFiles(e)}(e);return t.AdAssets.extractStaticFiles(e)}(e))).concat(function(e){var i=[];if(!n||!n.ExternalAdProtocols||!e)return i;return i=i.concat(function(e){var i=[];const o=n.AdUtils.getMraidCreativeLoadStrategy(e);if(o===a.Cache){const e=t.AdAssets.extractExternalAdProtocolFileURL(r.MRAID,n.ExternalAdProtocols);e&&i.push(e)}return i}(e)),i}(e));for(var s=o.filter((function(e,t,n){return n.indexOf(e)===t})),d=0;d<s.length;d++)i.push({URL:s[d]});return i},buildAdFolderPath:function(e){return i.adsAssetsCacheDir+"/"+e},buildAdAssetsPath:function(e,t){return"../"+e+"/"+t},extractFileNameFromURL:function(e){if(!e)return null;var n=e.match(i.fileNameFromURLPattern);return n&&0!==n.length?t.SDKController&&"function"==typeof t.SDKController.isAndroid?t.SDKController.isAndroid()?n[0].split("?")[0]:n[0]:n[0].split("?")[0]:null},getAdLevelCacheConfiguration:function(){return{cacheBase:i.adsAssetsCacheDir}}}}},{"../../components/AdUtils":29,"../../components/MraidCreativeService":63,"../../components/adInterfaces":104,"./CacheConstants":156}],158:[function(e,t,n){t.exports=class{constructor(){this.store={}}setData(e,t){this.store[e]=t}getData(e){return this.store[e]}clear(){this.store={}}}},{}],159:[function(e,t,n){t.exports=function(t,n,i,r,a,o,s,d,l){"use strict";var c,u=!1,p=r.demandSourceName,f=n.adPlayerUrl,g=new(e("./../../components/sdkPluginType/SDKPluginTypeHandler"))(n,t.Utils),v=new(e("./../../components/AdFeaturesParser"))(t,n,i,a,!0),m=a.analyticsCategories,h=new(e("./../../components/SKAdImpression/BannerSKANImpression"))(n,o,m),b={},S=a.displayMode,y=null,A={},C=[],I={},w=n[a.productType],D=new(e("./DemandEntityBuilder.js"))(a,r),P=e("./FetchDemand/FetcherPatch.js")(t,n,a,o,i),F=n.DemandUtils,O=new(e("./../RewardedVideo/dsTaskManager.js"))(t,n,D,i),T=e("../../components/VastService.js")(t,n),x=new(e("./../RewardedVideo/availabilityReporter.js"))(t,n,a,D,O),N=new(e("./../RewardedVideo/availabilityManager.js"))(t,n,x,a),L=e("../../components/containers/WPADUtils")(n);const U=new(e("../../components/AndroidSandbox/AndroidSandboxService"))({core:t,controller:n,analytics:o,shouldReceiveMessage:e=>F.shouldReceiveMessage(D,e)});var M=n.InstancesTimers,V={load:{fail:"",success:""},init:{fail:"",success:""}},E=!1;function k(e){return e?V[e]:V}var B=function(){C.push(t.PubSub.subscribe("SDKController.AdLoaded",(function(e){if(F.shouldReceiveMessage(D,e)){var i=G();if(clearTimeout(c),n.log("ad loaded with params: "+JSON.stringify(e),n.LogLevels.verbose),i&&o.updateBaseData({rvPlayMethod:i.displayMode}),t.Utils.isDefined(e.errMsg)){O.publish("AdErrorState",[F.extendCallbackParamsWithDemandConfig(D,{error:!0})]),n.log("Error in loading ad: "+e.errMsg,n.LogLevels.error);var r={generalMessage:e.errMsg,vastViewCount:0};return r=M.extendEventElapsedTime(D.productType,D.demandSourceName,r),r=n.AdUtils.updateEventWithAdParams(b,i,r),o.report(m.adLoadedError,r),Q(i),void s.noMoreOffers(k().load.fail,e.errorMsg)}o.report(m.adLoaded,{vastViewCount:0}),t.Utils.isDefined(e.enableBackButton)&&n.setBackButtonState(e.enableBackButton),e=n.AdUtils.formatParamsToAdId(e),n.onAdLoaded(G());var d={numOfAdUnits:1,adViewId:e.adViewId};N.adLoadedSuccessfully(d,a.forcePreload)}}))),C.push(t.PubSub.subscribe("SDKController.AdVisible",(function(e){F.shouldReceiveMessage(D,e)&&function(e){s.adVisible(),!0;var t=n.AdUtils.getAdId(e);n.log("Bidder ProductInstance | adVisible | id="+t);var i=G();h.handleBannerSKANImpression(i),O.publish("Engaged",[F.extendCallbackParamsWithParentProductConfig(D,{duringEngage:!0})]);var r=n.getRecoveryInfo();o.trackTimingStop(m.adVisible,{eNameStart:m.showAdCalled,custom_a:r}),n.log("Bidder ProductInstance | send event adVisible"),o.trackTimingStart(m.adVisibleToClose)}(e)}))),C.push(t.PubSub.subscribe(i.BN+".GetConfig",(function(e){if(F.shouldReceiveMessage(D,e)){if(n.log("Bidder ProductInstance | getConfig received"),!G())return void n.log("Bidder ProductInstance | getConfig with no loaded ad");var t={productType:D.productType,demandSourceName:D.demandSourceName,originalDemandSourceName:D.originalDemandSourceName,requestID:b.requestID,displayOnAdReady:b.displayOnAdReady,viewType:a.viewType},i=n.AdUtils.handleExtendingAd(G(),t);e&&e.callback&&e.callback.call(null,i)}}))),C.push(t.PubSub.subscribe(i.BN+".isVisible."+D.demandSourceId,(function(){var e=G();if(e){if(E=!0,!r.isMultipleAdObjects){var t=D.demandSourceId,i=D.originalDemandSourceName;d.remove(i),l.add(i,t)}var a=n.getAdViewContainer(e);a&&a.shouldReportAdVisible()&&n.onAdVisible(e)}}))),C.push(t.PubSub.subscribe(i.BN+".destroy."+D.demandSourceId,(function(){o.report(m.bannerDestroyed),s.resetAdState(),H(),n.unloadAdViewByAd(G()),E=!1}))),C.push(t.PubSub.subscribe(i.BN+".removed."+D.demandSourceId,(function(){E=!1}))),C.push(t.PubSub.subscribe("Cache.assetRetrySuccess",(function(e){F.shouldReceiveMessage(D,e)&&n.InstancesEventsHandler.reportAssetRetrySuccessEvent(e,o)}))),C.push(t.PubSub.subscribe("Cache.assetRetryFailed",(function(e){F.shouldReceiveMessage(D,e)&&n.InstancesEventsHandler.reportAssetRetryFailedEvent(e,o)}))),C.push(t.PubSub.subscribe("SDKController.MrailImpression",(function(e){F.shouldReceiveMessage(D,e)&&n.InstancesEventsHandler.reportMrailImpressionEvent(e,o)}))),C.push(t.PubSub.subscribe("SDKController.Analytics",(function(e){F.shouldReceiveMessage(D,e)&&n.InstancesEventsHandler.handleAnalyticsGlobalEvent(e,o)}))),C.push(t.PubSub.subscribe(i.CB+".enterForeground",(function(e){E&&n.onEnterForeground(e,G())}))),C.push(t.PubSub.subscribe(i.CB+".viewableChange",(function(){if(E){n.sendMessageToAdView({name:"viewableChange"},G())}}))),C.push(t.PubSub.subscribe(i.CB+".deviceStatusChanged",(function(e){if(E){var i=t.Utils.extend({name:"deviceStatusChanged"},e);n.sendMessageToAdView(i,G())}}))),C.push(t.PubSub.subscribe(i.CB+".enterBackground",(function(e){E&&n.onEnterBackground(e,G())}))),C.push(t.PubSub.subscribe(a.adUnitCallbacks.adClicked,(function(e){if(F.shouldReceiveMessage(D,e)){var t=G();t&&E&&n.callSDKFunction(a.controllerNativeAPI.adClicked,F.extendCallbackParamsWithProductConfig(t,{}))}})))},R=function(e){!1;var i=n.AdUtils.getAdId(e);O.publish("Engaged",[F.extendCallbackParamsWithProductConfig(D,{duringEngage:!1})]);var r=G();clearTimeout(c),r?(n.log("onEngageEnd with params: "+JSON.stringify(r),n.LogLevels.verbose),t.Utils.isDefined(r)&&r.toRemove&&(n.AdsAssetsManager.unsetReferencesForAds([e],D.instanceUniqueId),n.log("removing ad id: "+i,n.LogLevels.verbose))):n.log("Tried to end engage with no ad",n.LogLevels.error)},K=function(e){var r=function(e){return b.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(_),function(e){if(e){var t={blacklistedCampaigns:e.join(",")};n.getTokenService().updateToken(t)}}(w.filteredListService.getFilteredListCampaigns())),t.Utils.returnResolvedPromise()},s=function(e){for(var i=e&&e.length||0,r="",a=0;a<i;a++)r+=n.AdUtils.getAdType(e[a],b),a<i-1&&(r+=", ");return o.updateBaseData({feedSize:i,feedCampaignOrder:r}),t.Utils.returnResolvedPromise()},d=function(e){return e.some((function(e){return n.OMIDService.isAdOmidSupported(e,a.productType)}))&&n.OMIDService.downloadOmidJsBundle(),t.Utils.returnResolvedPromise()};return function(e){var l=e.adm;O.setConnection(!0);var u=l.seatbid.bid,p=u[0],m=l.seatbid.ext,h=p.ext.adSource||m.adSource;return o.updateBaseData({landingId:m.landingId,strategyId:m.strategyId,adSource:h,dspname:m.dspName}),window.jQuery.when(function(e){b=v.parse(e.adm,e)}(e)).then(J.bind(null,b)).then(n.CampaignsFilter.filterByAppInstalled.bind(null,u,b,a.filterDisableTypes)).then(r).then(s.bind(null,u)).then(d.bind(null,u)).then((function(){return N.setAMSettings({preFetchAllVasts:b.preFetchAllVasts,numOfBannersToInitSuccess:b.numOfBannersToInitSuccess,reportOnAdunitReady:b.reportOnAdunitReady}),p?(!1,I={productType:a.productType,demandSourceName:D.demandSourceName,retryAttempts:b.adunitRetryAttempts||1,retryInterval:b.adunitRetryInterval||1,assetType:i.assetType.adunitAsset},t.Utils.returnResolvedPromise()):t.Utils.returnRejectedPromise(i.errors.noFill)})).then((function(){return n.getAdPlayerAssets().prepareAdPlayerAssets(I)})).then(n.AdsAssetsManager.setAdAssetsForAds.bind(null,u)).then(n.AdsAssetsManager.setReferencesForAds.bind(null,u,D.instanceUniqueId)).then((function(){p.inventoryIndex=0,p.inventoryId=1,p.displayMode=S.nonprecache,!0,function(e){var r=new window.jQuery.Deferred;if(!O.canPreload())return n.log("Cannot preload at this time, "+O.getStatusMsg(),n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.taskManagerPreload);var s=G()||e;if(!s)return n.log("Cannot preload with no offer",n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.preloadNoAd);(function(e,r){n.log("Bidder ProductInstance | preloadFlow");var s,d={preload:!0};e.isWPAD=L.shouldDisplayAdOnExternalWebView(e,b),n.AdUtils.setViewType(b,e,i.viewTypes.externalView),A.shouldBuildAdUnitUrlForExternal=!0,s=2,e.displayStrategy=s;var l=n.AdUtils.updateEventWithAdParams(b,e,{});l=t.Utils.extend(l,{displaystrategy:s}),o.updateBaseData(l),W(e);var u=n.getDeviceOs(),p=f.getAdPlayerUrl(!0,u,D,A);(function(e){var t=a.timerLengths.loadAdToAdPlayerTimeout;t>-1&&(clearTimeout(c),c=setTimeout((function(){j(e)}),t))})(e),b=t.Utils.extend(b,d),n.AdUtils.setViewType(b,e),g.shouldShowInStandAloneView(n.getConfig())&&n.AdUtils.extendSettingsWithStandaloneViewSupport(b);n.loadAdUnitUrl(e,p,D,b),function(e,t){var i=n.getContainerCreationHandler(e),r=i.getState();r===i.getCreationStates().createdSuccessfully?(n.log("product instance | containerState | createdSuccessfully ",n.LogLevels.info),t.resolve(e)):r===i.getCreationStates().duringCreation?window.jQuery.when(i.getCreationResultPromise()).then((function(){n.log("product instance | during creation result: success",n.LogLevels.info),t.resolve(e)})).fail((function(e){t.reject("product instance | "+e)})):t.reject("product instance | did not start to create native webview")}(e,r)})(s=t.Utils.extend(!0,s,D),r),r.promise()}(p)})).fail((function(e){var t=e||"Fail parse adUnit info from api response";n.AdsAssetsManager.unsetReferencesForAds(u,D.instanceUniqueId),e&&n.log(e,n.LogLevels.error),x.publishAvailabilityFalse("NoMoreOffers",e||t)})),(new window.jQuery.Deferred).resolve(t.Utils.extend(!0,{},l.seatbid.ext,{numOfAdUnits:l.seatbid.bid.length}))}(e)},j=function(e){var i=n.AdUtils.getAdId(e),r=m.adLoadedError;n.log("Error in loading ad - timeout in "+i,n.LogLevels.error);var a,d,l="Error in loading ad - timeout",c={callfailreason:l};c=n.AdUtils.updateEventWithAdParams(b,e,c),o.report(r,c),F.extendCallbackParamsWithProductConfig(D,e),T.removeIframe((a=i,d="",t.Utils.isDefined(D.demandSourceName)&&(d=D.demandSourceName),d+(D.productType+a))),n.unloadAdViewByAd(e),Q(e),s.noMoreOffers(k().load.fail,l),E=!1},_=function(e){e&&e.cid&&w.filteredListService.addToFilteredListCampaigns(e.cid)},W=function(e){y=e};function G(){return y}var H=function(){q()},q=function(){n.AdsAssetsManager.unsetReferencesForAds([G()],D.instanceUniqueId)};function J(e){e&&n.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}function Q(e){n.log("_resetPreloadedAd",n.LogLevels.verbose),R(e),o.resetBaseData(i.baseDataKeys)}return{name:p,init:function(){u||(B(),O.init(),n.initAnalytics(F.extendCallbackParamsWithParentProductConfig(D,{})),U.init(),u=!0)},loadAdWithAdm:function(e,i,r){!function(e,t,n){V[e].success=t||V[e].success,V[e].fail=n||V[e].fail}("load",i,r),s.loadWithADM(),n.log("loadAdWithAdm | bidder | resetting last response to none",n.LogLevels.verbose),n.DeviceDataService.shouldPullDataOnLoadAd()&&n.DeviceDataService.pullData(),P.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!O.canEngage());var o,d,l=n.AdUtils.validateADM(e.adm,a.errors.load);l.isValid?K(e):(o=l.errMsg,d=F.extendCallbackParamsWithDemandConfig(D,{errMsg:o}),n.callSDKFunction(r,d),t.PubSub.publish(a.productType+".failedToLoad",[d]))},reset:H,getStatus:O.getStatus,statesManager:s,instConfig:r,clearListeners:function(){t.Utils.each(C,(function(e,n){t.PubSub.unsubscribe(n)}))},getDSAnalytics:function(){return o},getPreLoadedAd:G,initProduct:function(){},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/AndroidSandbox/AndroidSandboxService":35,"../../components/VastService.js":96,"../../components/containers/WPADUtils":116,"./../../components/AdFeaturesParser":27,"./../../components/SKAdImpression/BannerSKANImpression":87,"./../../components/sdkPluginType/SDKPluginTypeHandler":125,"./../RewardedVideo/availabilityManager.js":189,"./../RewardedVideo/availabilityReporter.js":190,"./../RewardedVideo/dsTaskManager.js":191,"./DemandEntityBuilder.js":161,"./FetchDemand/FetcherPatch.js":165}],160:[function(e,t,n){t.exports=function(t,n,i,r,a,o,s,d){"use strict";var l,c,u,p=!1,f=r.demandSourceName,g=(n.adUnitUrl,n.adPlayerUrl),v=!1,m=new(e("./../../components/MultipleInventories")),h=new(e("./PreloadAdManager"))(t,n),b=(e("../../components/OMIDConstants"),new(e("./../../components/sdkPluginType/SDKPluginTypeHandler"))(n,t.Utils)),S=new(e("./../../components/AdFeaturesParser"))(t,n,i,a,!0),y=new(e("../IOSAudioSessionHandler"))(t,n),{MraidCreativeService:A}=e("../../components/MraidCreativeService"),C=a.analyticsCategories,I={},w=a.displayMode,D=!1,P=null,F={},O=i.closeButtonStates,T=[],x=(i.CB,{}),N={},L=n[a.productType],U=new(e("./DemandEntityBuilder.js"))(a,r),M=e("../../patches/PatchIOSLoadAfterLoad.js")(t,n,U),V=e("./FetchDemand/FetcherPatch.js")(t,n,a,o,i),E=n.DemandUtils,k=new(e("./../RewardedVideo/dsTaskManager.js"))(t,n,U,i),B=e("../../components/VastService.js")(t,n),R=new(e("./../RewardedVideo/availabilityReporter.js"))(t,n,a,U,k),K=new(e("./../RewardedVideo/availabilityManager.js"))(t,n,R,a),j=e("../../components/containers/WPADUtils")(n),_=new(e("../../components/InlineStoreService"))(t,n,o);const W=new(e("../../components/AndroidSandbox/AndroidSandboxService"))({core:t,controller:n,analytics:o,shouldReceiveMessage:e=>E.shouldReceiveMessage(U,e)});var G=n.InstancesTimers,H={load:{fail:"",success:""},init:{fail:"",success:""}},q=function(){_.init(),T.push(t.PubSub.subscribe("StoreKit.storeKitDisplayFailed",(function(e){o.report(C.storeKitDisplayFailed,{generalMessage:e})}))),T.push(t.PubSub.subscribe("StoreKit.storeKitCoolDown",(function(e){E.shouldReceiveMessage(U,e)&&o.report(C.storeKitCoolDown,{generalMessage:e.message})}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",(function(e){if(E.shouldReceiveMessage(U,e)){var t,i,r;if(n.log("globals ready: "+D+" initSuccess in settings: "+I.numOfBannersToInitSuccess+" adUnits: "+m.size(e.inventoryId),n.LogLevels.verbose),0===I.numOfBannersToInitSuccess)i=1,t=s.areCampaignsAvailable(ie(e.inventoryId).slice(0,i),i);else{var a=re(e.inventoryId);i=a.length;var o=X(m.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=o<=i?o:i,t=s.areCampaignsAvailable(a,r)}n.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,n.LogLevels.verbose),D&&t&&Y(e.inventoryId)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",(function(e){if(E.shouldReceiveMessage(U,e)){var i,r={};t.Utils.isDefined(e.id)&&(i=ne(e.id,e.inventoryId),(r=n.AdUtils.updateEventWithAdParams(I,i,r)).inventoryIndex=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1),o.report(C.campaignDeletedCache,r)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignSavedCallback",(function(e){if(E.shouldReceiveMessage(U,e)){var i,r=-1,a=null,s={};t.Utils.isDefined(e.id)&&(i=ne(e.id,e.inventoryId),a=e.id,r=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1,s=n.AdUtils.updateEventWithAdParams(I,i,s)),s=t.Utils.extend(s,{eNameStart:{name:C.campaignSavedCache.name+(a||"")},inventoryIndex:r}),o.trackTimingStop(C.campaignSavedCache,s)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",(function(e){if(E.shouldReceiveMessage(U,e)){var n=t.Utils.extend(!0,{},C.campaignSavedCache);n.name=n.name+(e.id||""),o.trackTimingStart(n)}}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",(function(e){E.shouldReceiveMessage(U,e)&&n.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheNextFail",(function(e){E.shouldReceiveMessage(U,e)&&e.deletedAds&&e.deletedAds.length>0&&t.Utils.each(e.deletedAds,(function(t,i){var r=ne(i,e.inventoryId),a=n.AdUtils.updateEventWithAdParams(I,r,{}),s=e.deletedAdsData;if(s&&s[t].id==i){var d=s[t].failedAssetsUrlsArray.toString();a.rvnomoreoffersreason=d.substring(0,999)}o.report(C.campaignFailedToCache,a),ee(i,e.inventoryId)}))}))),T.push(t.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",(function(e){E.shouldReceiveMessage(U,e)&&(t.PubSub.publish(a.productType+".fallbackToNonPrecache",[e]),o.report(C.fallbackToNonPrecache))}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",(function(e){if(E.shouldReceiveMessage(U,e)){n.log("RV cacheAdsFailedCallback "+JSON.stringify(e),n.LogLevels.verbose);for(var t,i,r,a,l=e.deletedOffers.length,c=e.deletedOffers,u=e.deletedAdsData,p=0;p<l;p++){var f=c[p],g=ne(f,e.inventoryId),v=n.AdUtils.updateEventWithAdParams(I,g,{});if(u&&u[p].id==f){var h=u[p].failedAssetsUrlsArray.toString();v.rvnomoreoffersreason=h.substring(0,999)}o.report(C.campaignFailedToCache,v),Z(f,e.inventoryId)}if(0===I.numOfBannersToInitSuccess)i=1,t=s.areCampaignsAvailable(ie(e.inventoryId).slice(0,i),i);else{var b=re(e.inventoryId);i=b.length;var S=X(m.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=S<=i?S:i,t=s.areCampaignsAvailable(b,r)}D&&t?Y(e.inventoryId):(d.noMoreOffers((a?H[a]:H).load.fail,e.errorMsg),R.publishAvailabilityFalse("NoMoreOffers",e.errorLog))}}))),T.push(t.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",(function(e){E.shouldReceiveMessage(U,e)&&n.log("PM | preProcessingFailedCallback "+e,n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("Cache.assetRetrySuccess",(function(e){E.shouldReceiveMessage(U,e)&&n.InstancesEventsHandler.reportAssetRetrySuccessEvent(e,o)}))),T.push(t.PubSub.subscribe("Cache.assetRetryFailed",(function(e){E.shouldReceiveMessage(U,e)&&n.InstancesEventsHandler.reportAssetRetryFailedEvent(e,o)}))),T.push(t.PubSub.subscribe("SDKController.MrailImpression",(function(e){E.shouldReceiveMessage(U,e)&&n.InstancesEventsHandler.reportMrailImpressionEvent(e,o)}))),T.push(t.PubSub.subscribe("SDKController.displaySKOverlay",(function(e){E.shouldReceiveMessage(U,e)&&n.SKOverlayManager.displaySKOverlay()}))),T.push(t.PubSub.subscribe("SDKController.dismissSKOverlay",(function(e){E.shouldReceiveMessage(U,e)&&n.SKOverlayManager.dismissOverlay()}))),T.push(t.PubSub.subscribe("SDKController.AdTracked",(function(e){E.shouldReceiveMessage(U,e)&&(e=n.AdUtils.formatParamsToAdId(e),n.log("AdTracked with params: "+JSON.stringify(e),n.LogLevels.verbose),o.report(C.adTracked),n.callSDKFunction("adCredited",E.extendCallbackParamsWithParentProductConfig(U,{credits:ne(n.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))}))),T.push(t.PubSub.subscribe("SDKController.AdStarted",(function(e){if(E.shouldReceiveMessage(U,e)&&n.RingerSwitchService.isInitiated()){var t={},i=ve();i&&i.ext&&(t=De(P.ext)),n.RingerSwitchService.startListener(t),n.log("Ringer | startListener ringer status from AdStarted.",n.LogLevels.info)}}))),T.push(t.PubSub.subscribe("SDKController.Analytics",(function(e){E.shouldReceiveMessage(U,e)&&n.InstancesEventsHandler.handleAnalyticsGlobalEvent(e,o)}))),T.push(t.PubSub.subscribe("SDKController.AdLoaded",(function(e){if(E.shouldReceiveMessage(U,e)){var r=n.AdUtils.getAdId(e),s=ne(r,e.inventoryId),d=e.inventoryId;if(clearTimeout(l),n.log("ad loaded with params: "+JSON.stringify(e),n.LogLevels.verbose),s&&o.updateBaseData({rvPlayMethod:s.displayMode}),t.Utils.isDefined(e.errMsg)){k.publish("AdErrorState",[E.extendCallbackParamsWithDemandConfig(U,{error:!0})]),n.log("Error in loading ad: "+e.errMsg,n.LogLevels.error);var u={generalMessage:e.errMsg,vastViewCount:0};return u=G.extendEventElapsedTime(U.productType,U.demandSourceName,u),u=n.AdUtils.updateEventWithAdParams(I,s,u),o.report(C.adLoadedError,u),pe(s),void function(e){var t=n.AdUtils.getAdId(e),r=k.getStatus().duringEngage;function s(){n.log(a.productType+" adLoaded with error | no offers for user - show dialog",n.LogLevels.verbose),n.setCloseButtonState({productType:a.productType,demandSourceName:f,state:O.close});var t={productType:a.productType,message:c&&c.noOffers?c.noOffers:i.labels.noOffers,yes:"close",alwaysClose:!0};n.postAdUnitEvent({name:"alertUserOnError",options:t}),o.report(C.userAlert,{inventoryIndex:e.inventoryIndex||-1})}ee(t,e.inventoryId),r&&!v?s():(n.log("DemandSource | adLoaded with error - removing and moving to next offer",n.LogLevels.verbose),ge(null),n.removeAdUnit(ne(t,e.inventoryId)))}(s)}o.report(C.adLoaded,{vastViewCount:0}),t.Utils.isDefined(e.enableBackButton)&&n.setBackButtonState(e.enableBackButton),e=n.AdUtils.formatParamsToAdId(e),n.onAdLoaded(ne(n.AdUtils.getAdId(e),e.inventoryId));var p={totalNumberCredits:te(d),numOfAdUnits:m.size(d),adViewId:e.adViewId,bundleId:s?s.bundleId:""};K.adLoadedSuccessfully(p,a.forcePreload)}}))),T.push(t.PubSub.subscribe("SDKController.AdVisible",(function(e){E.shouldReceiveMessage(U,e)&&function(e){u=Date.now(),d.adVisible(),v=!0;var t=n.AdUtils.getAdId(e),i=ne(t,e.inventoryId);n.log("Bidder ProductInstance | adVisible | id="+t),k.publish("Engaged",[E.extendCallbackParamsWithParentProductConfig(U,{duringEngage:!0})]);var r=n.getRecoveryInfo(),a=function(e){if(e&&e.ext&&e.ext.type){if("customEndCard"===e.ext.type&&void 0!==e.ext.UII)return!0}return!1}(i)?1:0;o.trackTimingStop(C.adVisible,{eNameStart:C.showAdCalled,custom_a:r,custom_b:n.getIT(),custom_c:a,custom_d:n.isEscapingUser()?1:0,custom_e:Ie(i)}),n.log("Bidder ProductInstance | send event adVisible"),n.SKAdImpressionService.startImpression(i,Oe,Te),ee(t,e.inventoryId),o.trackTimingStart(C.adVisibleToClose)}(e)}))),T.push(t.PubSub.subscribe("SDKController.AdError",(function(e){E.shouldReceiveMessage(U,e)&&n.log("SDKController.AdError:"+JSON.stringify(e),n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("SDKController.dialogBoxResume",(function(e){E.shouldReceiveMessage(U,e)&&o.report(C.dialogBoxResume)}))),T.push(t.PubSub.subscribe("SDKController.dialogBoxExit",(function(e){E.shouldReceiveMessage(U,e)&&o.report(C.dialogBoxExit)}))),T.push(t.PubSub.subscribe("SDKController.adClosed",(function(e){if(E.shouldReceiveMessage(U,e)){if("Interstitial"===a.productType){var t=e.ad&&e.ad.ext&&e.ad.ext.xButtonBehavior,i=e.ad&&e.ad.ext&&e.ad.ext.xButtonData&&e.ad.ext.xButtonData.skipInTime,r="moveToEndCard"===t&&void 0!==i&&u&&Date.now()-u<1e3*i;r&&n.setEscapingUser(!0),o.report(C.iue,{custom_d:r?1:0})}we()&&(n.log("audioSession | handleAudioSessionEnd",n.LogLevels.info),y.disableControlOverAudioSession()),n.SKAdImpressionService.endImpression(e.ad,xe,Ne)}}))),T.push(t.PubSub.subscribe(a.productType+".GetConfig",(function(e){if(E.shouldReceiveMessage(U,e)){n.log("Bidder ProductInstance | getConfig received");var t=ve();if(!t)return void n.log("Bidder ProductInstance | getConfig with no loaded ad");var i={productType:U.productType,demandSourceName:U.demandSourceName,originalDemandSourceName:U.originalDemandSourceName,requestID:I.requestID,displayOnAdReady:I.displayOnAdReady,viewType:a.viewType},r=ne(n.AdUtils.getAdId(t),t.inventoryId),o=n.AdUtils.handleExtendingAd(r,i);e&&e.callback&&e.callback.call(null,o)}}))),T.push(t.PubSub.subscribe(a.productType+"isVisible",(function(e){if(n.log("Bidder ProductInstance | isVisible"),E.shouldReceiveMessage(U,e)){var t=ve();if(n.isAdDisplayed(t))return void n.log("Bidder ProductInstance | isVisible | isAdDisplayed=true");if(!t)return void n.log("Bidder ProductInstance | isVisible | ad is null");n.getCurrentDisplayedAdType()!==a.productType&&n.getCurrentDisplayedAd()||n.setCurrentDisplayedAd(t)}})))};function J(e){var i={};if(t.Utils.isDefined(e.ad)){var r=e.ad&&t.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;i=n.AdUtils.updateEventWithAdParams(I,e.ad,i),i=t.Utils.extend(i,{inventoryIndex:r})}return i}T.push(t.PubSub.subscribe("ExternalContainer.duringCreation",(function(e){E.shouldReceiveMessage(U,e)&&o.report(C.duringCreation)})));var Q=function(t){var r;if(((r=a.productType)===i.RV||r===i.IS)&&(t&&t.customComponents)){var s=n.environmentConfiguration(),d=new(e("../DynamicUI/CustomComponentsEvents"))(o);new(e("../DynamicUI/CustomComponentsLoader"))(n,d,s.getDynamicUIHost()).downloadCustomComponents(t.customComponents)}};function $(e){for(var t=0;t<e.length;t++)e[t].isCacheable=e[t].adAssets.length>0||n.AdUtils.isPlayablePrecachedAd(e[t])}function z(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e}))}var X=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},Y=function(e){if(n.log("Bidder ProductInstance | handlePossibleAdUnitsReady",n.LogLevels.verbose),ae(e)){var r=m.size(e),o=te(e);a.forcePreload||K.canReportAvailable(r,o),function(e,r){var a=ae(r),o=s.isPrecache();h.canPreloadCandidateAd(!1,!1,a,!1,o,I.displayOnAdReady)&&function(e){var r=new window.jQuery.Deferred;if(!k.canPreload())return n.log("Cannot preload at this time, "+k.getStatusMsg(),n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.taskManagerPreload);var a=ve()||ae(e);if(!a)return n.log("Cannot preload with no offer",n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.preloadNoAd);a=t.Utils.extend(!0,a,U),Fe(a,!1,r),r.promise()}(r)}(0,e)}},Z=function(e,t){m.removeOfferById(e,t)&&!m.isEmpty(t)&&s.incrementNextCampaign()},ee=function(e,t){var i=m.getOfferById(e,t);i?i.toRemove=!0:n.log("Error in mark current ad to be removed:"+e,n.LogLevels.error)},te=function(e){for(var t=0,n=m.getOffers(e),i=m.size(e),r=0;r<i;r++)t+=n[r].credits;return t},ne=function(e,t){var i=m.getOfferById(e,t);return i||n.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(m.getOffers(t)),1),i},ie=function(e){return m.getOffers(e).filter((function(e){return!(t.Utils.isDefined(e.toRemove)&&e.toRemove)}))},re=function(e){return ie(e).filter((function(e){return e.isCacheable}))},ae=function(e){var t,i=ne(n.AdUtils.getAdId(de(e)),e);return s.isPrecache()&&i&&i.isCacheable&&!I.fallbackToStreaming?(i=ne(n.AdUtils.getAdId(se(e)),e),t=w.precache):t=w.nonprecache,i&&!i.displayMode&&oe(i,t),i},oe=function(e,t){e&&(e.displayMode=t)},se=function(e){return 0===I.numOfBannersToInitSuccess?s.getCurrentAd(ie(e).slice(0,1)):s.getCurrentAd(ie(e))},de=function(e){return m.getCurrentOffer(e)},le=function(e){v=!1;var i=n.AdUtils.getAdId(e);k.publish("Engaged",[E.extendCallbackParamsWithProductConfig(U,{duringEngage:!1})]);var r=ne(i,e.inventoryId);clearTimeout(l),r?(n.log("onEngageEnd with params: "+JSON.stringify(r),n.LogLevels.verbose),_.clearListeners(),t.Utils.isDefined(r)&&r.toRemove&&(n.AdsAssetsManager.unsetReferencesForAds([e],U.instanceUniqueId),n.log("removing ad id: "+i,n.LogLevels.verbose),Z(i,r.inventoryId))):n.log("Tried to end engage with no ad",n.LogLevels.error)},ce=function(e){var r=function(e){return I.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(fe),function(e){if(e){var t={blacklistedCampaigns:e.join(",")};n.getTokenService().updateToken(t)}}(L.filteredListService.getFilteredListCampaigns())),t.Utils.returnResolvedPromise()},d=function(e){for(var i=e&&e.length||0,r="",a=0;a<i;a++)r+=n.AdUtils.getAdType(e[a],I),a<i-1&&(r+=", ");return o.updateBaseData({feedSize:i,feedCampaignOrder:r}),t.Utils.returnResolvedPromise()},l=function(e){return function(e){for(var n=0;n<e.length;n++){var i=e[n].ext.layoutData;if(t.Utils.isDefined(i)&&t.Utils.isDefined(i.html)&&i.html.length>0)return!0}return!1}(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.dapi):t.Utils.returnResolvedPromise()},u=function(e){var i=s.isPrecache()&&function(e){for(var t=!1,i=0;i<e.length;i++)if(n.AdUtils.isPlayablePrecachedAd(e[i])){t=!0;break}return t}(e);return i?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.externalObfuscation).then((function(t){!function(e,t){for(var i=0;i<e.length;i++)n.AdUtils.isPlayablePrecachedAd(e[i])&&(e[i].ext.ableToCache="success"===t)}(e,t)})):t.Utils.returnResolvedPromise()},p=function(e){return e.some((function(e){return n.OMIDService.isAdOmidSupported(e,a.productType)}))&&n.OMIDService.downloadOmidJsBundle(),t.Utils.returnResolvedPromise()},f=function(e,t,i){var r=new window.jQuery.Deferred,s=t.sfts,d=setTimeout((function(){s?(o.report(C.campaignCacheTimeoutToFallback),t.fallbackToStreaming=!0,t.numOfBannersToInitSuccess=0,n.getBiddingLimitations().handleLoadFailure("Caching timeout, fallback to streaming",o),o.report(C.cachingFailedToFallback),r.resolve()):(o.report(C.adLevelCachingTimeout,{callfailreason:"ad level timeout expired when caching ads"}),r.reject("cacheAdsAssets timeout expired"))}),a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow);return n.AdsAssetsManager.cacheAdsWithClearanceLogic(e,t.numOfBannersToCache,t.numOfBannersToInitSuccess,i,be(t)).then(r.resolve).always(clearTimeout.bind(null,d)).fail((function(e){s?(t.fallbackToStreaming=!0,t.numOfBannersToInitSuccess=0,n.getBiddingLimitations().handleLoadFailure("Caching failed, fallback to streaming",o),o.report(C.cachingFailedToFallback),r.resolve()):r.reject(e)})),r.promise()};return function(e){var g=e.adm;k.setConnection(!0);var v,h=g.seatbid.bid,b=g.seatbid.ext,y=m.getAvailableInventoryId(),w=h.length>0&&h[0].ext.adSource||b.adSource;return o.updateBaseData({landingId:b.landingId,strategyId:b.strategyId,adSource:w,dspname:b.dspName}),b.deliveryPlumbus,window.jQuery.when(function(e){var t=e.adm;t&&t.seatbid&&t.seatbid.ext&&t.seatbid.ext.hasOwnProperty("sfts")&&o.report(C.sfts,{generalMessage:JSON.stringify(t.seatbid.ext.sfts)}),I=S.parse(t,e)}(e),function(e){e.labels,c=e.labels}(b)).then(Q.bind(null,I)).then(ye.bind(null,I)).then(Ae.bind(null,h[0])).then(Se.bind(null,I)).then(n.CampaignsFilter.filterByAppInstalled.bind(null,h,I,a.filterDisableTypes)).then(r).then(d.bind(null,h)).then(p.bind(null,h)).then(s.decidePrecacheStatus.bind(null,{numOfCampaigns:h.length,settings:I})).then((function(){return v=h.length>0,n.log("should use ad-player? "+v),K.setAMSettings({preFetchAllVasts:I.preFetchAllVasts,isPreCache:s.isPrecache(),numOfBannersToInitSuccess:I.numOfBannersToInitSuccess,reportOnAdunitReady:I.reportOnAdunitReady}),h&&h.length>0?(D=!1,x={productType:a.productType,demandSourceName:U.demandSourceName,retryAttempts:I.adunitRetryAttempts||1,retryInterval:I.adunitRetryInterval||1,assetType:i.assetType.adunitAsset},v?t.Utils.returnResolvedPromise():n.adUnitGlobals.updateAdUnitGlobals(!0,I.purgeAdunitLibsFile,x)):t.Utils.returnRejectedPromise(i.errors.noFill)})).then((function(){return v?t.Utils.returnResolvedPromise():window.jQuery.when(l(h),u(h))})).then((function(){return function(e){return e?n.getAdPlayerAssets().prepareAdPlayerAssets(x):t.Utils.returnResolvedPromise()}(v)})).then((function(){var e=n.AdUtils.getMraidCreativeLoadStrategy(h[0]);return new A(t,n,window.jQuery,o,e).updateAdWithMraidCreative(h)})).then(n.AdsAssetsManager.setAdAssetsForAds.bind(null,h)).then($.bind(null,h)).then(n.AdsAssetsManager.setReferencesForAds.bind(null,h,U.instanceUniqueId)).then(z.bind(null,h)).then(f.bind(null,h,I,U)).then(Ce.bind(null,h)).then((function(){D=!0;var e=m.setOffers(h.slice(0),y);0!==I.numOfBannersToInitSuccess||a.forcePreload||K.reportAdAvailable({numOfAdUnits:m.size(e),totalNumberCredits:te(e)}),n.getBiddingLimitations().handleLoadSuccess(),Y(e)})).fail((function(e){var t=e||"Fail parse adUnit info from api response";n.AdsAssetsManager.unsetReferencesForAds(h,U.instanceUniqueId),m.removeInventory(y),me(),ge(null),n.getBiddingLimitations().handleLoadFailure(t,o),e&&n.log(e,n.LogLevels.error),R.publishAvailabilityFalse("NoMoreOffers",e||t)})),(new window.jQuery.Deferred).resolve(t.Utils.extend(!0,{},g.seatbid.ext,{numOfAdUnits:g.seatbid.bid.length}))}(e)},ue=function(e,r,a){var d,l=n.AdUtils.getAdId(e);n.log("Error in loading ad - timeout in "+l,n.LogLevels.error),d=a?C.showAdFail:C.adLoadedError;var c,u,p={isprecache:s.isPrecache(),callfailreason:"Error in loading ad - timeout"};p=n.AdUtils.updateEventWithAdParams(I,e,p),o.report(d,p),E.extendCallbackParamsWithProductConfig(U,e),ee(l,e.inventoryId),ge(null),B.removeIframe((c=l,u="",t.Utils.isDefined(U.demandSourceName)&&(u=U.demandSourceName),u+(U.productType+c))),n.getBiddingLimitations().handleLoadFailure("Error in loading ad - timeout",o),I.viewType===i.viewTypes.externalView?n.removeAdUnitFromExternal(e):n.removeAdUnit(e)},pe=function(e){e&&e.cid?n.blacklistService.addToBlacklistedCampaigns(U.productType,U.demandGroupName,e.cid):n.log("DemandSource | cannot add to blacklist with no ad",n.LogLevels.error)},fe=function(e){e&&e.cid&&L.filteredListService.addToFilteredListCampaigns(e.cid)},ge=function(e){P=e};function ve(){return P}var me=function(){K.reset(),h.reset(),N={}},he=function(){for(var e=Object.keys(m.getInventories()),t=0;t<e.length;t++)n.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e[t]),U.instanceUniqueId)};function be(e){return{adAssetRetryAttempts:t.Utils.isNumber(e.adAssetRetryAttempts)?Number(e.adAssetRetryAttempts):1,adAssetRetryInterval:t.Utils.isNumber(e.adAssetRetryInterval)?Number(e.adAssetRetryInterval):1}}function Se(e){e&&e.hasOwnProperty(i.numOfBannersToInitSuccess)&&e.hasOwnProperty(i.numOfBannersToCache)&&o.updateBaseData({cacheConfig:e[i.numOfBannersToInitSuccess]+"/"+e[i.numOfBannersToCache]})}function ye(e){e&&n.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}function Ae(e){e&&n.AdUtils.setMraidCreativeLoadStrategy(e)}function Ce(e){e.forEach((function(e){var t=n.AdUtils.getAdId(e);N.hasOwnProperty(t)&&(e.adAssetsCacheStatus=N[t])}))}function Ie(e){return e&&e.ext&&e.ext.videoData&&e.ext.videoData.videoTime?e.ext.videoData.videoTime:-1}function we(){return n.isIOS()&&I.manageIOSAudioSession}function De(e){return e?{ringerUpdateDelay:I.ringerUpdateDelay,shouldSetRingerUpdateDelay:n.AdUtils.isPlayableCampaign(e)||n.AdUtils.isMRAIDCampaign(e)||n.AdUtils.isExternalCampaign(e)}:{}}function Pe(e,r){n.log(r,n.LogLevels.error);var s=E.extendCallbackParamsWithDemandConfig(U,{errMsg:r});t.PubSub.publish(a.productType+".failedToShow",[s]);var d=r;d!==i.errors.showAdFailedReasons.preloadNoAd&&d!==i.errors.showAdFailedReasons.showNoAd&&(d+=k.getStatusMsg()),o.report(C.showAdFail,{callFailReason:d}),n.callSDKFunction(e,E.extendCallbackParamsWithDemandConfig(U,{errMsg:r})),r!==i.errors.showAdFailedReasons.onAdVisibleFailed&&r!==i.errors.showAdFailedReasons.screenVisibleTimeout||t.PubSub.publish(i.taskManager+".Engaged",[E.extendCallbackParamsWithProductConfig(U,{duringEngage:!1})])}function Fe(e,r,d){n.log("Bidder ProductInstance | preloadFlow"),h.preloadAdFinished();var c,u=!1,p=s.isPrecache();e&&e.displayMode===w.softprecache&&(u=!0),!p||u||I.fallbackToStreaming||function(e){var i=n.AdUtils.getAdId(e),r=s.getConfig().precachePath+i+"/";t.AdAssets.updateAdunitPrecachePath(e,r,n.isAndroid())}(e),e.isWPAD=j.shouldDisplayAdOnExternalWebView(e,I),e.isWPAD?(n.AdUtils.setViewType(I,e,i.viewTypes.externalView),F.shouldBuildAdUnitUrlForExternal=!0,c=2):(n.log("Bidder ProductInstance | ad is not WPAD"),n.AdUtils.removeViewTypeFromSetting(I),F.shouldBuildAdUnitUrlForExternal=!1,c=1),e.displayStrategy=c;var f=n.AdUtils.updateEventWithAdParams(I,e,{});f=t.Utils.extend(f,{displaystrategy:c}),o.updateBaseData(f),ge(e);var v=p||n.getAdPlayerAssets().isAdplayerReadyToUseFromCache(),m=n.getDeviceOs(),S=g.getAdPlayerUrl(v,m,U,F);!function(e,t,n){var i=a.timerLengths.loadAdToAdPlayerTimeout;i>-1&&(clearTimeout(l),l=setTimeout((function(){ue(e,t,n)}),i))}(e,S,r),I=t.Utils.extend(I,{preload:!0}),n.AdUtils.setViewType(I,e),b.shouldShowInStandAloneView(n.getConfig())&&n.AdUtils.extendSettingsWithStandaloneViewSupport(I),e=n.StoreKitService.updateAdWithStoreAppId(e,I),n.loadAdUnitUrl(e,S,U,I),e.isWPAD?function(e,t){var i=n.getContainerCreationHandler(e),r=i.getState();r===i.getCreationStates().createdSuccessfully?(n.log("product instance | containerState | createdSuccessfully ",n.LogLevels.info),t.resolve(e)):r===i.getCreationStates().duringCreation?window.jQuery.when(i.getCreationResultPromise()).then((function(){n.log("product instance | during creation result: success",n.LogLevels.info),t.resolve(e)})).fail((function(e){t.reject("product instance | "+e)})):t.reject("product instance | did not start to create native webview")}(e,d):d.resolve(e)}function Oe(){o.report(C.startImpressionSuccess)}function Te(e){o.report(C.startImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function xe(){o.report(C.endImpressionSuccess)}function Ne(e){o.report(C.endImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}return{name:f,init:function(){p||(me(),q(),T.push(t.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",(function(e){if(E.shouldReceiveMessage(U,e)){var t={custom_b:e.maxAdsToSaveInCache};t=G.extendEventElapsedTime(U.productType,U.demandSourceName,t),o.report(C.adLevelCacheReachedMaxCapacity,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",(function(e){if(E.shouldReceiveMessage(U,e)){var t=J(e);t=G.extendEventElapsedTime(U.productType,U.demandSourceName,t),o.report(C.saveAdInCacheSuccess,t);var i=n.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(I.numOfBannersToInitSuccess,I.numOfBannersToCache);D&&i&&Y(m.getActiveInventoryId())}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",(function(e){if(E.shouldReceiveMessage(U,e)){var t=J(e);t=G.extendEventElapsedTime(U.productType,U.demandSourceName,t),o.report(C.saveAdInCacheFailure,t),ee(n.AdUtils.getAdId(e.ad))}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",(function(e){if(E.shouldReceiveMessage(U,e)){var t=J(e);t=G.extendEventElapsedTime(U.productType,U.demandSourceName,t),o.report(C.deleteAdFromCacheSuccess,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",(function(e){if(E.shouldReceiveMessage(U,e)){var t=J(e);t=G.extendEventElapsedTime(U.productType,U.demandSourceName,t),o.report(C.deleteAdFromCacheFailure,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",(function(e){if(E.shouldReceiveMessage(U,e)){var n=G.extendEventElapsedTime(U.productType,U.demandSourceName,{});n=t.Utils.extend(n,e),o.report(C.adsAlreadyCached,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",(function(e){if(E.shouldReceiveMessage(U,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=G.extendEventElapsedTime(U.productType,U.demandSourceName,{generalMessage:t.substring(0,250)});o.report(C.adAssetRetrySuccess,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",(function(e){if(E.shouldReceiveMessage(U,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=G.extendEventElapsedTime(U.productType,U.demandSourceName,{});i=t.Utils.extend(i,{callfailreason:e.errMsg,generalMessage:n.substring(0,250)}),o.report(C.adAssetRetryFail,i)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.urlNotMatched",(function(e){if(E.shouldReceiveMessage(U,e)){var n=J(e);n=t.Utils.extend(n,{generalMessage:JSON.stringify(e.asset)}),o.report(C.urlNotMatched,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.adAssetsCacheStatus",(function(e){if(E.shouldReceiveMessage(U,e)){var i=n.AdUtils.getAdId(e.ad);i&&t.Utils.isDefined(e.adAssetsCacheStatus)&&!t.Utils.isDefined(N[i])&&(N[i]=e.adAssetsCacheStatus)}}))),s.init(),k.init(),n.initAnalytics(E.extendCallbackParamsWithParentProductConfig(U,{})),W.init(),p=!0)},loadAdWithAdm:function(e,i,r){!function(e,t,n){H[e].success=t||H[e].success,H[e].fail=n||H[e].fail}("load",i,r),d.loadWithADM(),n.log("loadAdWithAdm | bidder | resetting last response to none",n.LogLevels.verbose),n.DeviceDataService.shouldPullDataOnLoadAd()&&n.DeviceDataService.pullData(),me(),ge(null),V.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!k.canEngage());var o,s,l=n.AdUtils.validateADM(e.adm,a.errors.load);l.isValid?ce(e):(o=l.errMsg,s=E.extendCallbackParamsWithDemandConfig(U,{errMsg:o}),n.callSDKFunction(r,s),t.PubSub.publish(a.productType+".failedToLoad",[s]))},showAd:function(e,r,a){var s=ve()||ae(m.getActiveInventoryId());function d(e){return function(e){var r=new window.jQuery.Deferred;if(!e)return r.reject(i.errors.showAdFailedReasons.showNoAd);if(!k.canEngage())return r.reject(i.errors.showAdFailedReasons.taskManagerEngage);return function(e){t.PubSub.publish(i.taskManager+".Engaged",[E.extendCallbackParamsWithProductConfig(U,{duringEngage:e})])}(!0),e=t.Utils.extend(e,{showAdCallbacks:{onShowSuccess:r.resolve,onShowFailed:r.reject}}),n.displayAdView(e),r.promise()}(e).then((function(){!function(e){o.trackTimingStop(C.showAdSuccess,{eNameStart:C.showAdCalled}),n.callSDKFunction(e,E.extendCallbackParamsWithDemandConfig(U)),M.onShowSuccess(U)}(r)}),(function(e){Pe(a,e)}))}s?(n.RingerSwitchService.isInitiated()&&s&&(n.RingerSwitchService.startListener(De(s.ext)),n.log("Ringer | startListener from DS.",n.LogLevels.info)),function(){if(we())return n.log("audioSession | handleAudioSessionStart",n.LogLevels.info),y.enableControlOverAudioSession();var e=new jQuery.Deferred;return e.resolve(),e.promise()}().always((function(){n.isContainerLoaded(s)?d(s):function(e){var t=new window.jQuery.Deferred;return Fe(e,!0,t),t.promise()}(s).then(d).fail((function(e){Pe(a,e)}))}))):Pe(a,"ShowAd | Bidding | there is no ad to show.")},showAdBanner:function(){var e=ve();if(e){n.setCurrentDisplayedAd(e);var t=n.getAdViewContainer(e);t&&t.shouldReportAdVisible()&&n.onAdVisible(e)}},reset:function(){he(),m.reset(),me(),ge(null)},getStatus:k.getStatus,statesManager:d,instConfig:r,clearListeners:function(){t.Utils.each(T,(function(e,n){t.PubSub.unsubscribe(n)}))},engageEnd:function(e,r){if(n.log("engageEnd",n.LogLevels.verbose),E.shouldReceiveMessage(U,e)){!function(e){n.log("_resetPreloadedAd",n.LogLevels.verbose),le(e),o.resetBaseData(i.baseDataKeys),h.setCanPreloadFlag(!0)}(e);var d={handlePrefetchFailedOnBackground:function(e){n.log("_backgroundPrefetchFailed | ManualLoad",n.LogLevels.verbose),this.publishNoMoreOffers(i.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){var t;n.log("handlePrefetchFailedOnVisible | manuel load",n.LogLevels.verbose),t=e,s.isPrecache()&&n.AdsAssetsManager.cacheAssetsOfAd(m.getActiveInventory().getCurrentOffer(),U,be(I)).then(Y.bind(null,t.inventoryId)).fail((function(){I.sfts&&(o.report(C.campaignFailedCacheToFallback),Y(t.inventoryId))}))},handleAdClosed:function(e){n.log("handleAdClosed | manuel load",n.LogLevels.verbose),n.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),U.instanceUniqueId),m.removeInventory(e.inventoryId)},publishNoMoreOffers:function(e){n.log("publishNoMoreOffers | ManualLoad",n.LogLevels.verbose);var r=E.extendCallbackParamsWithDemandConfig(U,{errorMsg:e||i.noMoreOffersReason.noMoreOffersToShowInFeed});t.PubSub.publish(a.productType+".NoMoreOffers",[r])}};!function(e){n.log("getAndResetErrorStateFromTaskManager",n.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[E.extendCallbackParamsWithProductConfig(U,{error:!1})]),t}(k)?e.engaged?d.handleAdClosed(e):d.handlePrefetchFailedOnBackground(e):e.engaged?d.handlePrefetchFailedOnVisible(e):d.handlePrefetchFailedOnBackground(e),(t.Utils.isFunction(r)?r:function(){})()}},getDSAnalytics:function(){return o},getPreLoadedAd:ve,initProduct:function(){},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/AndroidSandbox/AndroidSandboxService":35,"../../components/InlineStoreService":56,"../../components/MraidCreativeService":63,"../../components/OMIDConstants":72,"../../components/VastService.js":96,"../../components/containers/WPADUtils":116,"../../patches/PatchIOSLoadAfterLoad.js":221,"../DynamicUI/CustomComponentsEvents":171,"../DynamicUI/CustomComponentsLoader":172,"../IOSAudioSessionHandler":178,"./../../components/AdFeaturesParser":27,"./../../components/MultipleInventories":66,"./../../components/sdkPluginType/SDKPluginTypeHandler":125,"./../RewardedVideo/availabilityManager.js":189,"./../RewardedVideo/availabilityReporter.js":190,"./../RewardedVideo/dsTaskManager.js":191,"./DemandEntityBuilder.js":161,"./FetchDemand/FetcherPatch.js":165,"./PreloadAdManager":168}],161:[function(e,t,n){t.exports=function(t,n){var i=e("../../components/Constants.js");return{productType:t.productType,demandGroupName:n.demandGroupName||n.demandSourceName,demandSourceName:n.demandSourceName,demandType:n.demandType||i.demandSourceType.demandSource,isInAppBidding:n.isInAppBidding,isOneFlow:n.isOneFlow,isLoadWithAdmFlow:n.isLoadWithAdmFlow,isMultipleAdObjects:!!n.isMultipleAdObjects,demandSourceId:n.demandSourceId,waterfallPosition:n.waterfallPosition,originalDemandSourceName:n.originalDemandSourceName||n.demandSourceName,instanceUniqueId:t.productType+"."+n.demandSourceName,adSize:n.adSize,watermark:n.watermark}}},{"../../components/Constants.js":40}],162:[function(e,t,n){t.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},adTracked:{name:"adTracked",id:34},apsAttribution:{name:"apsAttribution",id:41},apsAttributionSuccess:{name:"apsAttributionSuccess",id:42},apsAttributionFailed:{name:"apsAttributionFailed",id:43},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},loadRequest:{name:"loadRequest",id:301},loadAdWithFill:{name:"loadAdWithFill",id:201},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},getExtraOffersInventoryFailed:{name:"getExtraOffersInventoryFailed",id:160},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},saveAdInCacheSuccess:{name:"saveAdInCacheSuccess",id:279},saveAdInCacheFailure:{name:"saveAdInCacheFailure",id:280},deleteAdFromCacheSuccess:{name:"deleteAdFromCacheSuccess",id:281},deleteAdFromCacheFailure:{name:"deleteAdFromCacheFailure",id:282},adLevelCacheReachedMaxCapacity:{name:"adLevelCacheReachedMaxCapacity",id:283},adsAlreadyCached:{name:"adsAlreadyCached",id:284},adLevelCachingTimeout:{name:"adLevelCachingTimeout",id:285},cachingFailedToFallback:{name:"cachingFailedToFallback",id:286},duringCreation:{name:"duringCreation",id:287},startImpressionSuccess:{name:"startImpressionSuccess",id:304},startImpressionFailed:{name:"startImpressionFailed",id:305},endImpressionSuccess:{name:"endImpressionSuccess",id:306},endImpressionFailed:{name:"endImpressionFailed",id:307},overlayDismissed:{name:"overlayDismissed",id:299},overlayDismissFailure:{name:"overlayDismissFailure",id:337},overlayRemovalFailure:{name:"overlayRemovalFailure",id:338},overlayMissing:{name:"overlayMissing",id:339},presentOverlay_c:{name:"presentOverlay_c",id:352},overlayDidFinishPresentation_c:{name:"overlayDidFinishPresentation_c",id:353},presentOverlayFailed_c:{name:"presentOverlayFailed_c",id:354},dismissOverlay_c:{name:"dismissOverlay_c",id:355},overlayWillStartDismissal_c:{name:"overlayWillStartDismissal_c",id:356},overlayDidFinishDismissal_c:{name:"overlayDidFinishDismissal_c",id:357},overlayWillStartPresentation_c:{name:"overlayWillStartPresentation_c",id:358},presentOverlayDuringPendingPresent:{name:"podpp",id:359},noFill:{name:"noFill",id:20},urlNotMatched:{name:"urlNotMatched",id:349},storeKitCoolDown:{name:"storeKitCoolDown",id:374},storeKitDisplayFailed:{name:"storeKitDisplayFailed",id:375},customComponentDownloadSuccess:{name:"customComponentDownloadSuccess",id:361},customComponentDownloadError:{name:"customComponentDownloadError",id:362},mraidCreativeFetchSuccess:{name:"mraidCreativeFetchSuccess",id:789},mraidCreativeFetchFailed:{name:"mraidCreativeFetchFailed",id:790},mrailImpression:{name:"mrailImpression",id:700},destroyMultipleAdInstance:{name:"destroyMultipleAdInstance",id:290},getTokenFromNativeFailed:{name:"getTokenFromNativeFailed",id:423},getTokenFromNativeSuccess:{name:"getTokenFromNativeSuccess",id:424},campaignFailedCacheToFallback:{name:"campaignFailedCacheToFallback",id:425},campaignCacheTimeoutToFallback:{name:"campaignCacheTimeoutToFallback",id:426},sfts:{name:"sfts",id:427},iue:{name:"iue",id:428},longUrlNonBiddingRequest:{name:"longUrlNonBiddingRequest",id:458},inlineStoreLaunched:{name:"inlineStoreLaunched",id:461},inlineStoreFailed:{name:"inlineStoreFailed",id:462},inlineStoreActivityLaunched:{name:"inlineStoreActivityLaunched",id:463},inlineStoreActivityFailed:{name:"inlineStoreActivityFailed",id:464},inlineStoreClosed:{name:"inlineStoreClosed",id:465},inlineStoreDestroyed:{name:"inlineStoreDestroyed",id:467},inlineStoreDestroyFailed:{name:"inlineStoreDestroyFailed",id:468},inlineStoreMissingParams:{name:"inlineStoreMissingParams",id:469}}}},{}],163:[function(e,t,n){t.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],164:[function(e,t,n){t.exports=function(t){var n=e("./FetchDemandConst.js");return{fetchFeed:function(e,i,r){return t({url:e,data:i,type:n.direct.http.method,dataType:n.direct.http.dataType,timeout:r||1e4})},get:function(e,i,r){return t({url:e,data:i,type:n.direct.http.method,timeout:r||1e4})}}}},{"./FetchDemandConst.js":163}],165:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=295e3,o=t.getConfig().mobileSDKSettings.deviceOs,s=t.getConfig().controllerConfig||{},d={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842},applyBackgroundPatchLogic:{name:"applyBackgroundPatchLogic",id:843},applyBackgroundPatchLogicEnd:{name:"applyBackgroundPatchLogicEnd",id:844}};function l(){t.callSDKFunction(r.nativeInterfaceMethod.displayWebView,{display:!0,productType:r.IS,activityThemeTranslucent:!0,success:"webviewPatch"})}function c(){setTimeout((function(){t.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()}))}function u({elapsed:t,event:n}){var a=e.PubSub.subscribe(r.CB+".viewableChange",(function(t){t.isViewable&&(e.PubSub.unsubscribe(a),c())})),o=e.PubSub.subscribe(r.CB+".webviewPatch",(function(){e.PubSub.unsubscribe(o),function({elapsed:e,event:t}){var n=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e;i.report(t,{generalMessage:n>0?n:-9})}({elapsed:t,event:n}),c()}))}function p(e){if(o!==r.deviceOs.android)return!1;if("number"!=typeof e||e<a)return!1;var n=t.SupplyConfigurations.getNetworkConfigValueByKey("shouldApplyNetworkSolution"),i=s.shouldApplyNetworkSolution;return!1!==n&&!1!==i}return{applyCommunicationSolution:function(e,n){var r;p(e)&&(n||(t.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),r=e,i.report(d.applyPatchLogic,{generalMessage:a>0?r:-8}),u({elapsed:e,event:d.applyPatchLogicEnd}),l()))},shouldApplyCommunicationSolution:p,applyBackgroundCommunicationSolution:function(e){p(e)&&(i.report(d.applyBackgroundPatchLogic,{generalMessage:a>0?e:-8}),u({elapsed:e,event:d.applyBackgroundPatchLogicEnd}),l())}}}},{}],166:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s,d=e("./PayloadBuilderConstants.js"),l="PayloadBuilder | ",c=e("../../components/storeKit/SKANModel")(),u=i.productType,p=i.demandSourceName,f=i.demandGroupName,g=0,v=!1,m=0,h=t.getConfig().controllerConfig;function b(e){var i=t.getSDKDataByKey(r.abTests.abt);return i&&i.hasOwnProperty(r.abtParamByProductType[u])&&i[r.abtParamByProductType[u]].length>0&&(e.abt=i[r.abtParamByProductType[u]]),n.Utils.returnResolvedPromise(e)}function S(e){var i=c.extractDataForPayload(h,t.getConfig().applicationSettings);return e=n.Utils.extend(e,i),n.Utils.returnResolvedPromise(e)}function y(e){return(e=n.Utils.extend(e,{demandSource:p,impressionsCount:g,auid:t.AppUserIdService.getAUID()})).ett=t.getETT(),n.Utils.returnResolvedPromise(e)}function A(e){var r=t.ImpressionsCounterService.getPayloadCounters(i);return e=n.Utils.extend(e,r),n.Utils.returnResolvedPromise(e)}function C(e){var r={},s=t.getApiData({fpf:0});v&&s&&(r.fpf=s.fpf);var d=i.waterfallPosition;return n.Utils.isDefined(d)&&(r.wp=d),r.retryCounter=m,r.delpl=a,o&&(r.sesp=o),e=n.Utils.extend(e,r),n.Utils.returnResolvedPromise(e)}function I(e){var i=t.getApiData({segmentId:0}),r=t.getApiData({segmentName:0});return i&&r&&(e=n.Utils.extend(e,{segmentId:i.segmentId,segmentName:r.segmentName})),n.Utils.returnResolvedPromise(e)}function w(e){var i=t.getApiData({coppa:0});return e.cscd=i&&i.coppa,n.Utils.returnResolvedPromise(e)}function D(e){var i=t.getApiData({med_ver:0});return i&&i.med_ver&&(e.medv=i.med_ver),n.Utils.returnResolvedPromise(e)}function P(e){var i=new window.jQuery.Deferred;return t.shouldExtendApiDataWithDebugData()?t.getSDKDebugParams().then((function(t){return e=n.Utils.extend(e,t),n.Utils.returnResolvedPromise(e)})).always((function(){i.resolve(e)})):i.resolve(e),i.promise()}function F(e){if(!t.blacklistService.isEmpty(u,f)){var i=t.blacklistService.getBlacklistedCampaigns(u,f);e=n.Utils.extend(e,{blacklistedCampaigns:i.join(",")})}return n.Utils.returnResolvedPromise(e)}function O(e){return t.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(u)&&(e=n.Utils.extend(e,{lastSeenCampaignId:t.LastSeenCampaignService.getLastDisplayedAdCampaignId()})),n.Utils.returnResolvedPromise(e)}function T(e){if(t.OMIDService.isNativeServiceActivated()){var i=t.OMIDService.getVersionData();e=n.Utils.extend(e,{omidEnabled:!0,omidVersion:i.omidVersion,omidPartnerVersion:i.omidPartnerVersion})}else e=n.Utils.extend(e,{omidEnabled:!1,moatSupported:!1});return n.Utils.returnResolvedPromise(e)}function x(e){return t.getTokenService().getToken().then((function(i){if("object"!=typeof i)return n.Utils.returnResolvedPromise(e);var a,o=(a=t.SupplyConfigurations.getNetworkConfigValueByKey(d.addTokenKeysToPayload),Array.isArray(a)||(a=[]),a);return n.Utils.each(i,(function(t,n){var i;i=t,(o.indexOf(i)>-1||function(e){return e.indexOf(d.metaDataPrefix)>-1}(t))&&(e[t]=n)})),i.hasOwnProperty(d.metaDataOneTokenKey)&&function(e,t){"object"==typeof t&&n.Utils.each(t,(function(t,n){e[d.metaDataPrefix+t]=n}))}(e,i[d.metaDataOneTokenKey]),t.isIOS()&&!t.isLegacy(t.featureMap.mutableAdvertingTrackingData)&&function(e,i){var a=function(e){for(var t,n={},i=r.advertiserIdParamsToUpdate,a=0;a<i.length;a++)void 0!==e[t=i[a]]&&(n[t]=e[t]);return n}(i);if(!a)return;t.getConfigurationHelper().parseConfiguration(a,{},t.getConfig().mobileSDKSettings),t.AdvertisingIdService.decideOnAdvertisingId(t.getConfig().mobileSDKSettings,h),n.Utils.each(a,(function(n,i){var r=t.getSDKDataByKey(n);void 0!==r&&(e[n]=r)}))}(e,i),n.Utils.returnResolvedPromise(e)})).fail((function(){return n.Utils.returnResolvedPromise(e)}))}function N(e){return e=V(e,r.xCodeData.xCodeVersion),e=V(e,r.xCodeData.xCodeBuildVersion),e=V(e,r.xCodeData.xCodeSdkName),e=V(e,r.xCodeData.xCodeSdkBuild),n.Utils.returnResolvedPromise(e)}function L(e){return s&&(e=n.Utils.extend(e,{asel:s})),n.Utils.returnResolvedPromise(e)}function U(e){var i=t.getIDFI();return i&&(e=n.Utils.extend(e,{idfi:i})),n.Utils.returnResolvedPromise(e)}function M(e){return e.mediationABGroup=t.SupplyConfigurations.getValueByKey("abInternal"),n.Utils.returnResolvedPromise(e)}function V(e,i){var r=t.getSDKDataByKey(i);return r&&(e=n.Utils.extend(e,{[i]:r})),e}function E(e){return t.log(l+"returnPayload | built payload for "+u),n.Utils.returnResolvedPromise(e)}return{createPayload:function(e){return g=e.impressionsCount,v=e.firstAttemptToGetFeed,m=e.retryCounter,a=e.deliveryPlumbus,o=e.sesp,s=e.adServicesExtensionLevel,t.getApplicationInfo(t.DemandUtils.extendCallbackParamsWithParentProductConfig(i,{})).then(t.getAPIRequiredData).then(y).then(A).then(C).then(w).then(D).then(I).then(b).then(S).then(P).then(F).then(O).then(T).then(x).then(N).then(L).then(U).then(M).then(E)}}}},{"../../components/storeKit/SKANModel":127,"./PayloadBuilderConstants.js":167}],167:[function(e,t,n){t.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",metaDataOneTokenKey:"md",addTokenKeysToPayload:"addTokenKeysToPayload",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],168:[function(e,t,n){t.exports=function(e,t){var n=!0;function i(e){n=!!e}return{canPreloadCandidateAd:function(i,r,a,o,s,d){if(!n)return t.log("PreloadAdManager | Can not preload next ad right now"),!1;if(i&&!r)return t.log("PreloadAdManager | Skipping preload on capped demand"),!1;if(d)return t.log("PreloadAdManager | can preload true | Display when ad ready true"),!0;var l=e.VastUtils.isVastCampaign(a);return r||s&&!l||o?(t.log("PreloadAdManager | preload ad "+t.AdUtils.getAdId(a)),!0):(t.log("PreloadAdManager | skip preload ad "+t.AdUtils.getAdId(a)),!1)},preloadAdFinished:function(){i(!1)},setCanPreloadFlag:i,reset:function(){i(!0)}}}},{}],169:[function(e,t,n){function i(t,n,i,r,a,o,s,d){"use strict";var l,c,u=!1,p=r.demandSourceName,f=n.adUnitUrl,g=n.adPlayerUrl,v=new(e("./../../components/MultipleInventories.js")),m=new(e("./PreloadAdManager"))(t,n),h=e("../../components/OMIDConstants"),b=new(e("./../../components/AdFeaturesParser"))(t,n,i,a,!1),{MraidCreativeService:S}=e("../../components/MraidCreativeService"),y=new(e("../../patches/PublisherPatchEasybrain.js"))(n.getConfigurationHelper()),A=new(e("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(n,t.Utils),C=a.analyticsCategories,I={},w=t.Utils.extend(!0,{},a.precacheConfig),D=a.displayMode,P=!1,F=0,O=null,T=null,x=null,N=!1,L,U=[],M,V={},E,k=i.closeButtonStates,B=!1,R=[],K=null,j=null,_=null,W=i.CB,G=null,H=0,q={},J={},Q={},$,z=n[a.productType],X=new(e("./DemandEntityBuilder.js"))(a,r),Y=e("../../patches/PatchIOSLoadAfterLoad.js")(t,n,X),Z=o,ee=e("./FetchDemand/FetcherPatch.js")(t,n,a,Z,i),te=n.DemandUtils,ne=new(e("./../RewardedVideo/dsTaskManager.js"))(t,n,X,i),ie=e("../../components/VastService.js")(t,n),re=new(e("./../RewardedVideo/availabilityReporter.js"))(t,n,a,X,ne),ae=new(e("./../RewardedVideo/availabilityManager.js"))(t,n,re,a),oe=new(e("./PayloadBuilder.js"))(n,t,X,i),se=e("../../components/containers/WPADUtils")(n),de=new(e("../IOSAudioSessionHandler"))(t,n),le,ce=!0,ue=n.getExternalContainer(),pe=n.InstancesTimers,fe=function(){R.push(t.PubSub.subscribe("StoreKit.storeKitDisplayFailed",(function(e){Z.report(C.storeKitDisplayFailed,{generalMessage:e})}))),R.push(t.PubSub.subscribe("StoreKit.storeKitCoolDown",(function(e){te.shouldReceiveMessage(X,e)&&Z.report(C.storeKitCoolDown,{generalMessage:e.message})}))),R.push(t.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){var t,i,r;if(n.log("globals ready: "+P+" initSuccess in settings: "+I.numOfBannersToInitSuccess+" adUnits: "+v.size(e.inventoryId),n.LogLevels.verbose),0===I.numOfBannersToInitSuccess)i=1,t=le.areCampaignsAvailable(Qe(e.inventoryId).slice(0,i),i);else{var a=$e(e.inventoryId);i=a.length;var o=Ke(v.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=o<=i?o:i,t=le.areCampaignsAvailable(a,r)}n.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,n.LogLevels.verbose),P&&t&&_e(e.inventoryId)}}))),R.push(t.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){var i,r={};t.Utils.isDefined(e.id)&&(i=qe(e.id,e.inventoryId),(r=n.AdUtils.updateEventWithAdParams(I,i,r)).inventoryIndex=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1),Z.report(C.campaignDeletedCache,r)}}))),R.push(t.PubSub.subscribe("PrecacheManager.campaignSavedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){var i,r=-1,a=null,o={};t.Utils.isDefined(e.id)&&(i=qe(e.id,e.inventoryId),a=e.id,r=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1,o=n.AdUtils.updateEventWithAdParams(I,i,o)),o=t.Utils.extend(o,{eNameStart:{name:C.campaignSavedCache.name+(a||"")},inventoryIndex:r}),Z.trackTimingStop(C.campaignSavedCache,o)}}))),R.push(t.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){var n=t.Utils.extend(!0,{},C.campaignSavedCache);n.name=n.name+(e.id||""),Z.trackTimingStart(n)}}))),R.push(t.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",(function(e){te.shouldReceiveMessage(X,e)&&n.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),n.LogLevels.verbose)}))),R.push(t.PubSub.subscribe("PrecacheManager.cacheNextFail",(function(e){te.shouldReceiveMessage(X,e)&&e.deletedAds&&e.deletedAds.length>0&&t.Utils.each(e.deletedAds,(function(t,i){var r=qe(i,e.inventoryId),a=n.AdUtils.updateEventWithAdParams(I,r,{}),o=e.deletedAdsData;if(o&&o[t].id==i){var s=o[t].failedAssetsUrlsArray.toString();a.rvnomoreoffersreason=s.substring(0,999)}Z.report(C.campaignFailedToCache,a),Ge(i,e.inventoryId)}))}))),R.push(t.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",(function(e){te.shouldReceiveMessage(X,e)&&(t.PubSub.publish(a.productType+".fallbackToNonPrecache",[e]),Z.report(C.fallbackToNonPrecache))}))),R.push(t.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){n.log("RV cacheAdsFailedCallback "+JSON.stringify(e),n.LogLevels.verbose);for(var t,i,r,a=e.deletedOffers.length,o=e.deletedOffers,s=e.deletedAdsData,d=0;d<a;d++){var l=o[d],c=qe(l,e.inventoryId),u=n.AdUtils.updateEventWithAdParams(I,c,{});if(s&&s[d].id==l){var p=s[d].failedAssetsUrlsArray.toString();u.rvnomoreoffersreason=p.substring(0,999)}Z.report(C.campaignFailedToCache,u),We(l,e.inventoryId)}if(0===I.numOfBannersToInitSuccess)i=1,t=le.areCampaignsAvailable(Qe(e.inventoryId).slice(0,i),i);else{var f=$e(e.inventoryId);i=f.length;var g=Ke(v.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=g<=i?g:i,t=le.areCampaignsAvailable(f,r)}ae.cacheAdsFailed(P,t,e.errorLog,_e.bind(null,e.inventoryId))}}))),R.push(t.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",(function(e){if(te.shouldReceiveMessage(X,e)){n.log("PM | preProcessingFailedCallback "+e,n.LogLevels.verbose);var t=e.id,i=qe(t,e.inventoryId);Ve(i)&&(te.extendCallbackParamsWithProductConfig(X,i),n.addAdToLoadedCreatives(i),be(i))}}))),R.push(t.PubSub.subscribe("Cache.assetRetrySuccess",(function(e){te.shouldReceiveMessage(X,e)&&n.InstancesEventsHandler.reportAssetRetrySuccessEvent(e,Z)}))),R.push(t.PubSub.subscribe("Cache.assetRetryFailed",(function(e){te.shouldReceiveMessage(X,e)&&n.InstancesEventsHandler.reportAssetRetryFailedEvent(e,Z)}))),R.push(t.PubSub.subscribe("SDKController.MrailImpression",(function(e){te.shouldReceiveMessage(X,e)&&n.InstancesEventsHandler.reportMrailImpressionEvent(e,Z)}))),R.push(t.PubSub.subscribe("SDKController.AdTracked",(function(e){te.shouldReceiveMessage(X,e)&&(e=n.AdUtils.formatParamsToAdId(e),n.log("AdTracked with params: "+JSON.stringify(e),n.LogLevels.verbose),Z.report(C.adTracked),n.callSDKFunction("adCredited",te.extendCallbackParamsWithParentProductConfig(X,{credits:qe(n.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))}))),R.push(t.PubSub.subscribe("SDKController.AdStarted",(function(e){if(te.shouldReceiveMessage(X,e)&&n.RingerSwitchService.isInitiated()){var t={},i=Pt();i&&i.ext&&(t=pn(x.ext)),n.RingerSwitchService.startListener(t),n.log("Ringer | startListener ringer status from AdStarted.",n.LogLevels.info)}}))),R.push(t.PubSub.subscribe("SDKController.Analytics",(function(e){te.shouldReceiveMessage(X,e)&&n.InstancesEventsHandler.handleAnalyticsGlobalEvent(e,Z)}))),R.push(t.PubSub.subscribe("SDKController.AdLoaded",(function(e){if(te.shouldReceiveMessage(X,e)){var i=n.AdUtils.getAdId(e),r=qe(i,e.inventoryId),a=e.inventoryId;clearTimeout(L),n.log("ad loaded with params: "+JSON.stringify(e),n.LogLevels.verbose),r&&Z.updateBaseData({rvPlayMethod:r.displayMode});var o=0;if(t.VastUtils.isVastCampaign(r)&&(o=t.VastUtils.getVastViewCount(r)),t.Utils.isDefined(e.errMsg)){ne.publish("AdErrorState",[te.extendCallbackParamsWithDemandConfig(X,{error:!0})]),n.log("Error in loading ad: "+e.errMsg,n.LogLevels.error);var s={generalMessage:e.errMsg,vastViewCount:t.VastUtils.getVastViewCountForEvent(o)};return s=n.AdUtils.updateEventWithAdParams(I,r,s),s=pe.extendEventElapsedTime(X.productType,X.demandSourceName,s),Z.report(C.adLoadedError,s),t.VastUtils.setMaxVastCount(r),Ct(r),void be(r)}var d=pe.extendEventElapsedTime(X.productType,X.demandSourceName,{vastViewCount:t.VastUtils.getVastViewCountForEvent(o)});Z.report(C.adLoaded,d),t.Utils.isDefined(e.enableBackButton)&&n.setBackButtonState(e.enableBackButton),e=n.AdUtils.formatParamsToAdId(e),n.onAdLoaded(qe(n.AdUtils.getAdId(e),e.inventoryId)),ae.adLoadedSuccessfully({numOfAdUnits:v.size(a),totalNumberCredits:He(a)},!1)}}))),R.push(t.PubSub.subscribe("SDKController.AdLoadError",(function(e){te.shouldReceiveMessage(X,e)&&(ae.adLoadError(),n.unloadAdViewsByProduct(X),Ut())}))),R.push(t.PubSub.subscribe("SDKController.AdError",(function(e){te.shouldReceiveMessage(X,e)&&n.log("SDKController.AdError:"+JSON.stringify(e),n.LogLevels.verbose)}))),R.push(t.PubSub.subscribe("SDKController.dialogBoxResume",(function(e){te.shouldReceiveMessage(X,e)&&Z.report(C.dialogBoxResume)}))),R.push(t.PubSub.subscribe("SDKController.dialogBoxExit",(function(e){te.shouldReceiveMessage(X,e)&&Z.report(C.dialogBoxExit)}))),R.push(t.PubSub.subscribe("SDKController.adClosed",(function(e){te.shouldReceiveMessage(X,e)&&(dn(),n.SKAdImpressionService.endImpression(e.ad,wn,Dn))}))),R.push(t.PubSub.subscribe(a.productType+".GetConfig",(function(e){if(te.shouldReceiveMessage(X,e)){n.log("ProductInstance | getConfig received");var t=Pt();if(!t)return void n.log("ProductInstance | getConfig with no loaded ad");var i={productType:X.productType,demandSourceName:X.demandSourceName,originalDemandSourceName:X.originalDemandSourceName,requestID:I.requestID,displayOnAdReady:I.displayOnAdReady,viewType:a.viewType},r=qe(n.AdUtils.getAdId(t),t.inventoryId),o=n.AdUtils.handleExtendingAd(r,i);e&&e.callback&&e.callback.call(null,o)}}))),R.push(t.PubSub.subscribe(a.productType+".isVisible",(function(e){if(n.log("ProductInstance | isVisible"),te.shouldReceiveMessage(X,e)){var t=Pt(),r=n.getCurrentDisplayedAd();if(n.isAdDisplayed(t))return void n.log("ProductInstance | isVisible | isAdDisplayed=true");t?r&&n.getCurrentDisplayedAdType()!==a.productType?Z.report(C.bannerLoadedDuringShow):(n.setCurrentDisplayedAd(t),n.getCurrentDisplayedAdType()===i.BN&&ue.shouldReportAdVisibleForBanners()&&(n.log("ProductInstance | isVisible | shouldReportAdVisible"),n.onAdVisible(t))):n.log("ProductInstance | isVisible | ad is null")}})))};R.push(t.PubSub.subscribe("ExternalContainer.duringCreation",(function(e){te.shouldReceiveMessage(X,e)&&Z.report(C.duringCreation)})));var ge=function(){R.push(t.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",(function(e){if(te.shouldReceiveMessage(X,e)){var t={custom_b:e.maxAdsToSaveInCache};t=pe.extendEventElapsedTime(X.productType,X.demandSourceName,t),Z.report(C.adLevelCacheReachedMaxCapacity,t)}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",(function(e){if(te.shouldReceiveMessage(X,e)){var t=ve(e);t=pe.extendEventElapsedTime(X.productType,X.demandSourceName,t),Z.report(C.saveAdInCacheSuccess,t);var i=n.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(I.numOfBannersToInitSuccess,I.numOfBannersToCache);P&&i&&_e(v.getActiveInventoryId())}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",(function(e){if(te.shouldReceiveMessage(X,e)){var t=ve(e);t=pe.extendEventElapsedTime(X.productType,X.demandSourceName,t),Z.report(C.saveAdInCacheFailure,t),Ge(n.AdUtils.getAdId(e.ad))}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",(function(e){if(te.shouldReceiveMessage(X,e)){var t=ve(e);t=pe.extendEventElapsedTime(X.productType,X.demandSourceName,t),Z.report(C.deleteAdFromCacheSuccess,t)}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",(function(e){if(te.shouldReceiveMessage(X,e)){var t=ve(e);t=pe.extendEventElapsedTime(X.productType,X.demandSourceName,t),Z.report(C.deleteAdFromCacheFailure,t)}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",(function(e){te.shouldReceiveMessage(X,e)&&(e=pe.extendEventElapsedTime(X.productType,X.demandSourceName,e),Z.report(C.adsAlreadyCached,e))}))),R.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",(function(e){if(te.shouldReceiveMessage(X,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=pe.extendEventElapsedTime(X.productType,X.demandSourceName,{generalMessage:t.substring(0,250)});Z.report(C.adAssetRetrySuccess,n)}}))),R.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",(function(e){if(te.shouldReceiveMessage(X,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=pe.extendEventElapsedTime(X.productType,X.demandSourceName,{});i=t.Utils.extend(i,{callfailreason:e.errMsg,generalMessage:n.substring(0,250)}),Z.report(C.adAssetRetryFail,i)}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.urlNotMatched",(function(e){if(te.shouldReceiveMessage(X,e)){var n=ve(e);n=t.Utils.extend(n,{generalMessage:JSON.stringify(e.asset)}),Z.report(C.urlNotMatched,n)}}))),R.push(t.PubSub.subscribe("AdsAssetsManager.adAssetsCacheStatus",(function(e){if(te.shouldReceiveMessage(X,e)){var i=n.AdUtils.getAdId(e.ad);i&&t.Utils.isDefined(e.adAssetsCacheStatus)&&!t.Utils.isDefined(Q[i])&&(Q[i]=e.adAssetsCacheStatus)}})))};function ve(e){var i={};if(t.Utils.isDefined(e.ad)){var r=e.ad&&t.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;i=n.AdUtils.updateEventWithAdParams(I,e.ad,i),i=t.Utils.extend(i,{inventoryIndex:r})}return i}function me(){return Z}function he(){j=null,K=null}function be(e){var t=n.AdUtils.getAdId(e);Ge(t,e.inventoryId);var r=ne.getStatus().duringEngage;he();var o=l.getNextAd(r,e.inventoryId);function s(){n.log("RV adLoaded with error | no offers for user - show dialog",n.LogLevels.verbose),n.setCloseButtonState({productType:a.productType,demandSourceName:p,state:k.close});var t={productType:a.productType,message:M&&M.noOffers?M.noOffers:i.labels.noOffers,yes:"close",alwaysClose:!0};n.postAdUnitEvent({name:"alertUserOnError",options:t}),Z.report(C.userAlert,{inventoryIndex:e.inventoryIndex||-1})}r&&e.isWPAD||r&&!o?s():(n.log("DemandSource | adLoaded with error - removing and moving to next offer",n.LogLevels.verbose),Dt(null),n.removeAdUnit(qe(t,e.inventoryId)))}var Se=function(e){var t="AttemptToBringNewAds | ";n.log(t),Z.report(C.attemptToBringNewFeed,{generalMessage:ne.getStatusMsg()}),B?n.log(t+"Cannot bring feed attemptToBringNewAdsInProcess="+B):(B=!0,ae.inventoryEmpty(e),setTimeout((function(){n.log(t+"Can bring feed"),n.unloadAdViewsByProduct(X),B=!1,Ut()}),0))},ye=function(t){if(Ae(a.productType)&&t&&t.customComponents){var i=n.environmentConfiguration(),r=new(e("../DynamicUI/CustomComponentsEvents"))(Z);new(e("../DynamicUI/CustomComponentsLoader"))(n,r,i.getDynamicUIHost()).downloadCustomComponents(t.customComponents)}};function Ae(e){return e===i.RV||e===i.IS}function Ce(e){E=e.labels,M=e.labels}var Ie=function(e){e&&e.seatbid&&e.seatbid.ext&&e.seatbid.ext.hasOwnProperty("sfts")&&Z.report(C.sfts,{generalMessage:JSON.stringify(e.seatbid.ext.sfts)}),I=b.parse(e,null)};function we(e){n.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}function De(e){e&&n.AdUtils.setMraidCreativeLoadStrategy(e)}var Pe=function(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e,le.isPrecache()&&le.setAdInventoryIndex(n.AdUtils.getAdId(t),e)}))};function Fe(e){return e?n.getAdPlayerAssets().prepareAdPlayerAssets(q):t.Utils.returnResolvedPromise()}function Oe(e){for(var t=0;t<e.length;t++)e[t].isCacheable=e[t].adAssets.length>0||n.AdUtils.isPlayablePrecachedAd(e[t])}function Te(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e}))}function xe(){t.Utils.each(R,(function(e,n){t.PubSub.unsubscribe(n)}))}function Ne(){T&&clearTimeout(T),O&&clearInterval(O)}function Le(e){n.AdsAssetsManager.unsetReferencesForInstance(X.instanceUniqueId);var i=!!e&&e.engaged;xe(),Ne();var r=t.Utils.extend(!0,{},X,{engaged:i});t.PubSub.publish(a.productType+".exhaustedDemandSource",[r])}function Ue(e){var t,i=[];for(t=0;t<e.length;t++)le.isAdInCache(n.AdUtils.getAdId(e[t]))||i.push(e[t]);return i}var Me=function(e){var n=[];return t.Utils.each(e,(function(e,t){t.ext&&t.ext.appData&&t.ext.appData.adAssets&&(t.ext.appData.appImages=t.ext.appData.adAssets,delete t.ext.appData.adAssets),n.push(t)})),n},Ve=function(e){return le.isPrecache()&&t.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},Ee=function(e){return 1===e.length&&Ve(e[0])&&(N=!0),t.Utils.returnResolvedPromise()},ke=function(e){ot(t.VastUtils.isVastCampaign(e)),e.inventoryId&&ut()},Be=function(e){var t=[];return N?t.push(n.AdUtils.formatVastAdForPrecache(e[0],ke.bind(null,e[0]))):t=n.AdUtils.formatAdsForPrecache(e),t},Re=function(e,r){var a,o,s,d=le.isPrecache();e=Me(e),Pe(e);var l=v.setOffers(e.slice(0),r);a=Be(e),o=Ke(e,I.numOfBannersToCache);var c=function(){if(t.VastUtils.isThereVastCampaign(Qe(l))&&ae.setAMSettings({reportOnAdunitReady:!1},!0),d){var s=Ke(e,I.numOfBannersToInitSuccess),c=le.areCampaignsAvailable(a.slice(0,s),s);c&&Z.report(C.campaignsAvailableFromCache),n.log("DemandSource | updateCurrentAds areCampaignsAvailable "+c,n.LogLevels.verbose),0===I.numOfBannersToInitSuccess&&ae.reportAdAvailable({numOfAdUnits:v.size(l),totalNumberCredits:He(l)}),(c||0===o||0===I.numOfBannersToInitSuccess)&&_e(l);var u=Ue(a),p={cacheTimeoutSuccessCallback:function(){Re(e,r)},cacheTimeoutFailCallback:je,applicationUserId:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),applicationKey:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:u,inventoryId:l,adAssetsCacheConfig:J};le.handleCacheAds(p)}else _e(l)};d&&(s=le.mergeCampaigns(a,o),n.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(s),n.LogLevels.verbose)),!d||I.purgeCacheOnInit?(n.log("DemandSource | already purged cache so go strait to adding the new ads",n.LogLevels.verbose),c()):le.clearCacheByType(s).always(c)},Ke=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},je=function(e){ae.cacheTimeoutFail(e)},_e=function(e){n.log("ProductInstance | handlePossibleAdUnitsReady",n.LogLevels.verbose);var i=ze(e);if(i){var r=t.VastUtils.isVastCampaign(i);if(N&&ot(r,e))ct(e);else{var a=v.size(e),o=He(e);t.VastUtils.areAllCampaignTypesAreVast(Qe(e));ae.canReportAvailable(a,o)}l.attemptToPreloadAd(!1,e)}},We=function(e,t){v.removeOfferById(e,t)&&!v.isEmpty(t)&&le.incrementNextCampaign()},Ge=function(e,t){var i=v.getOfferById(e,t);i?i.toRemove=!0:n.log("Error in mark current ad to be removed:"+e,n.LogLevels.error),_=null},He=function(e){for(var t=0,n=v.getOffers(e),i=v.size(e),r=0;r<i;r++)t+=n[r].credits;return t},qe=function(e,t){var i=v.getOfferById(e,t);return i||n.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(v.getOffers(t)),1),i},Je=function(e,t,n){return v.replaceOfferById(e,t,n)},Qe=function(e){return v.getOffers(e).filter((function(e){return!(t.Utils.isDefined(e.toRemove)&&e.toRemove)}))},$e=function(e){return Qe(e).filter((function(e){return e.isCacheable}))},ze=function(e){var t,i=qe(n.AdUtils.getAdId(tt(e)),e);return le.isPrecache()&&i&&i.isCacheable?(i=qe(n.AdUtils.getAdId(et(e)),e),t=D.precache):t=D.nonprecache,i&&!i.displayMode&&Ye(i,t),i},Xe=function(e,t){if(!e)return null;var i=Ze(t);return i?qe(n.AdUtils.getAdId(i),t):null},Ye=function(e,t){e&&(e.displayMode=t)},Ze=function(e){return Qe(e).length>0?Qe(e)[0]:null},et=function(e){return 0===I.numOfBannersToInitSuccess?le.getCurrentAd(Qe(e).slice(0,1)):le.getCurrentAd(Qe(e))},tt=function(e){return v.getCurrentOffer(e)},nt=function(e){var i=n.AdUtils.getAdId(e);ne.publish("Engaged",[te.extendCallbackParamsWithProductConfig(X,{duringEngage:!1})]),Dt(null),he();var r=qe(i,e.inventoryId);clearTimeout(L),r?(n.log("onEngageEnd with params: "+JSON.stringify(r),n.LogLevels.verbose),t.Utils.isDefined(r)&&r.toRemove&&(n.AdsAssetsManager.unsetReferencesForAds([e],X.instanceUniqueId),n.log("removing ad id: "+i,n.LogLevels.verbose),We(i,r.inventoryId))):n.log("Tried to end engage with no ad",n.LogLevels.error)},it=function(e){var i=n.AdUtils.getAdId(e),r=qe(i,e.inventoryId);t.Utils.isDefined(r)&&r.toRemove&&(n.log("removing ad id: "+i,n.LogLevels.verbose),We(i,r.inventoryId))};function rt(e){K&&"pending"===K.state()&&(t.Utils.isDefined(e)?(n.log("handleVastAvailability - VAST failed to load with reason: "+e),K.reject()):(n.log("handleVastAvailability - VAST verified - resolve"),K.resolve()))}function at(e){var n="";return t.Utils.isDefined(X.demandSourceName)&&(n=X.demandSourceName),n+=X.productType+e}function ot(e,t){return st(e)||dt(t)}function st(e){return I.preFetchAllVasts&&e}function dt(e){return le.isPrecache()&&t.VastUtils.areAllCampaignTypesAreVast(Qe(e))}function lt(e){n.log("handleVastAvailability",n.LogLevels.verbose),ut(),ct(e)}function ct(e){window.jQuery.when(K).then((function(){ae.canReportAvailable(v.size(e),He(e))}))}function ut(){K&&"pending"===K.state()||(K=new window.jQuery.Deferred)}var pt=function(){return ne.canInitCallToApi().then((function(){}),(function(){return n.log(a.errors.init[1001]+ne.getStatusMsg(),n.LogLevels.error),a.errors.init[1001]})).then((function(){F++,t.Utils.decodeValues(c),i.BN===a.productType&&Z.report(C.getInventory),ee.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer));var e=z.getDestination(p);return vt(c,e),n.FetchDirectService.fetchFeed(e,c,a.timerLengths.serverResponseTimeoutInMilis)})).then(ft).then(ht,(function(e,t){var n,i=new window.jQuery.Deferred;switch(n=a.errors.load.invalid,typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return"timeout"===t?i.reject(a.errors.load.timeout):i.reject(n)}))},ft=function(e){var n=new window.jQuery.Deferred;if(e&&e.errorCode){var i=e.errorMessage?e.errorMessage:a.errors.load.invalidErrorCode;return n.reject(i)}return e.seatbid&&e.seatbid.bid&&e.seatbid.ext&&t.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):n.reject(a.errors.load.invalidAdm)};function gt(e,t){var n="";return window.jQuery&&"function"==typeof window.jQuery.param&&(n="?"+window.jQuery.param(e)),t+n}function vt(e,t){if("string"==typeof t&&""!==t){var n=gt(e,t),i=n.length;if(i>7999){var r=n.substring(0,555);Z.report(C.longUrlNonBiddingRequest,{generalmessage:r,custom_b:i})}}}function mt(e){if(e){var t={blacklistedCampaigns:e.join(",")};n.getTokenService().updateToken(t)}}var ht=function(e){var r=function(e){for(var i=e&&e.length||0,r="",a=0;a<i;a++)r+=n.AdUtils.getAdType(e[a],I),a<i-1&&(r+=", ");return Z.updateBaseData({feedSize:i,feedCampaignOrder:r}),t.Utils.returnResolvedPromise()},o=function(e){return e.some((function(e){return n.OMIDService.isAdOmidSupported(e,a.productType)}))&&n.OMIDService.downloadOmidJsBundle(),t.Utils.returnResolvedPromise()},d=function(e,i,r){if(an())return t.Utils.returnResolvedPromise();var o=new window.jQuery.Deferred,s=setTimeout((function(){var e={callfailreason:"ad level timeout expired when caching ads"};e=pe.extendEventElapsedTime(r.productType,r.demandSourceName,e),Z.report(C.adLevelCachingTimeout,e),o.reject("cacheAdsAssets timeout expired")}),a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow);return n.AdsAssetsManager.cacheAdsWithClearanceLogic(e,i.numOfBannersToCache,i.numOfBannersToInitSuccess,r,Et(i)).then(o.resolve).always(clearTimeout.bind(null,s)).fail((function(e){o.reject(e)})),o.promise()};return function(e){ne.setConnection(!0);var l=e.seatbid.bid,c=e.seatbid.ext,u=l.length>0&&l[0].ext.adSource||c.adSource;z.getAmountOfSupportedInventories()===i.DEFAULT_AMOUNT_OF_INVENTORIES&&(Tt(),v.reset());var p,f=v.getAvailableInventoryId();return Z.updateBaseData({landingId:c.landingId,strategyId:c.strategyId,adSource:u}),$=c.deliveryPlumbus,c.sessionPlumbus&&s.setData(a.productType+"sesp",c.sessionPlumbus),window.jQuery.when(Ie(e),Ce(c)).then((function(){if(!(l&&l.length>0))return t.Utils.returnRejectedPromise(i.errors.noFill);Z.report(C.loadAdWithFill)})).then(ye.bind(null,I)).then(we.bind(null,I)).then(De.bind(null,l[0])).then(kt.bind(null,I)).then(n.CampaignsFilter.filterByAppInstalled.bind(null,l,I,a.filterDisableTypes)).then(r.bind(null,l)).then(o.bind(null,l)).then(le.decidePrecacheStatus.bind(null,{numOfCampaigns:l.length,settings:I})).then((function(){return Z.updateBaseData(n.AdUtils.extractEventData(l[0])),p=l&&l.length>0,n.log("should use ad-player? "+p),ae.setAMSettings({preFetchAllVasts:I.preFetchAllVasts,isPreCache:le.isPrecache(),numOfBannersToInitSuccess:I.numOfBannersToInitSuccess,reportOnAdunitReady:I.reportOnAdunitReady}),p?(P=!1,Mt(),Z.report(C.loadAd),t.Utils.returnResolvedPromise()):t.Utils.returnRejectedPromise(i.errors.noFill)})).then((function(){return p?t.Utils.returnResolvedPromise():window.jQuery.when(function(e){return Rt(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.dapi):t.Utils.returnResolvedPromise()}(l),function(e){return le.isPrecache()&&Kt(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.externalObfuscation).then((function(t){jt(e,t)})):t.Utils.returnResolvedPromise()}(l))})).then((function(){return an()?le.handleCacheClear():t.Utils.returnResolvedPromise()})).then(Ee(l)).then((function(){return Fe(p)})).then((function(){var e=n.AdUtils.getMraidCreativeLoadStrategy(l[0]);return new S(t,n,window.jQuery,Z,e).updateAdWithMraidCreative(l)})).then(n.AdsAssetsManager.setAdAssetsForAds.bind(null,l)).then(Oe.bind(null,l)).then(n.AdsAssetsManager.setReferencesForAds.bind(null,l,X.instanceUniqueId)).then(Te.bind(null,l)).then(d.bind(null,l,I,X)).then(Gt.bind(null,l)).then((function(){if(Z.updateBaseData(n.AdUtils.extractEventData(l[0])),P=!0,an())return Vt(),Re(l,f);var e=v.setOffers(l.slice(0),f);0===I.numOfBannersToInitSuccess&&ae.reportAdAvailable({numOfAdUnits:v.size(e),totalNumberCredits:He(e)}),_e(e)})).fail((function(e){var t=e||"Fail parse adUnit info from api response";n.AdsAssetsManager.unsetReferencesForAds(l,X.instanceUniqueId),v.removeInventory(f),i.BN===a.productType&&Z.report(C.getInventoryFailed,{generalMessage:t}),Ft(),e&&n.log(e,n.LogLevels.error),ae.inventoryEmpty(e||t)})),(new window.jQuery.Deferred).resolve(t.Utils.extend(!0,{},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},bt=function(){t.Utils.each(U,(function(e,t){clearTimeout(t)})),U=[]};function St(e){ne.publish("Engaged",[te.extendCallbackParamsWithProductConfig(X,{duringEngage:e})])}function yt(){var e;e={productType:a.productType,message:M&&M.noInternet?M.noInternet:i.labels.noInternet,yes:"close",alwaysClose:!0},n.alert(e)}var At=function(e,r,a){var o,s=n.AdUtils.getAdId(e);n.log("Error in loading ad - timeout in "+s,n.LogLevels.error),o=a?C.showAdFail:C.adLoadedError;var d={isprecache:le.isPrecache(),callfailreason:"Error in loading ad - timeout"};d=n.AdUtils.updateEventWithAdParams(I,e,d),Z.report(o,d),te.extendCallbackParamsWithProductConfig(X,e),t.VastUtils.isVastCampaign(e)&&Ct(e),Ge(s,e.inventoryId),Dt(null),he(),ie.removeIframe(at(s)),I.viewType===i.viewTypes.externalView?n.removeAdUnitFromExternal(e):n.removeAdUnit(e)},Ct=function(e){e&&e.cid?n.blacklistService.addToBlacklistedCampaigns(X.productType,X.demandGroupName,e.cid):n.log("DemandSource | cannot add to blacklist with no ad",n.LogLevels.error)},It=function(e){e&&e.cid&&z.filteredListService.addToFilteredListCampaigns(e.cid)},wt=function(){T&&clearTimeout(T)},Dt=function(e){x=e};function Pt(){return x}var Ft=function(){Dt(null),he(),ae.reset(),m.reset(),Q={}},Ot=function(){Tt(),v.reset(),Ft()},Tt=function(){for(var e=Object.keys(v.getInventories()),t=0;t<e.length;t++)n.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e[t]),X.instanceUniqueId)},xt=function(){var e=!1;if(X.productType===i.BN&&v){var t=v.getActiveInventoryId();t&&(e=v.isNextOfferAvailable(t))}return e},Nt=function(){var e=v.getActiveInventoryId();if(e){var t=ze(e);v.removeOfferById(t.id,e),_e(e)}};function Lt(){n.DeviceDataService.shouldPullDataOnLoadAd()&&n.DeviceDataService.pullData()}function Ut(e,r){var o=function(e){if(!s){F=0,e=e||a.errors.load.invalid,i.BN===a.productType&&(Z.report(C.getInventoryFailed,{generalMessage:e}),ue.resetExternalAdViewsIdentifiers());var o=te.extendCallbackParamsWithDemandConfig(X,{errMsg:e});n.callSDKFunction(r,o),t.PubSub.publish(a.productType+".failedToLoad",[o])}};if(Lt(),Ft(),xt())Nt();else{var s=!1;(U.push(setTimeout((function(){o(a.errors.load.totalLoadTimeout),s=!0}),a.timerLengths.totalLoadFlowTimeout)),(new window.jQuery.Deferred).resolve()).then(wt).then(vn).then(pt).always(bt).then((function(){s||(F=0,ce=!1)}),(function(t){var n=new window.jQuery.Deferred;return function(e){return!s&&e===a.errors.load.timeout&&z.doesAllowConsecutiveGatewayRequestsDuringLoad()&&F<a.maxNumOfAttemptsToCallAPI}(t)?(setTimeout((function(){Ut(e,r)}),a.timerLengths.initAttemptsDelay),n.resolve()):n.reject(t)})).then(null,o)}}function Mt(){q={productType:a.productType,demandSourceName:X.demandSourceName,retryAttempts:I.adunitRetryAttempts||1,retryInterval:I.adunitRetryInterval||1,assetType:i.assetType.adunitAsset}}function Vt(){J={productType:a.productType,demandSourceName:X.demandSourceName,retryAttempts:I.adAssetRetryAttempts,retryInterval:I.adAssetRetryInterval,assetType:i.assetType.adAsset}}function Et(e){return{adAssetRetryAttempts:t.Utils.isNumber(e.adAssetRetryAttempts)?Number(e.adAssetRetryAttempts):1,adAssetRetryInterval:t.Utils.isNumber(e.adAssetRetryInterval)?Number(e.adAssetRetryInterval):1}}function kt(e){e&&e.hasOwnProperty(i.numOfBannersToInitSuccess)&&e.hasOwnProperty(i.numOfBannersToCache)&&Z.updateBaseData({cacheConfig:e[i.numOfBannersToInitSuccess]+"/"+e[i.numOfBannersToCache]})}function Bt(){return I.purgeAdunitLibsFile}function Rt(e){for(var n=0;n<e.length;n++){var i=e[n].ext.layoutData;if(t.Utils.isDefined(i)&&t.Utils.isDefined(i.html)&&i.html.length>0)return!0}return!1}function Kt(e){for(var t=!1,i=0;i<e.length;i++)if(n.AdUtils.isPlayablePrecachedAd(e[i])){t=!0;break}return t}function jt(e,t){for(var i=0;i<e.length;i++)n.AdUtils.isPlayablePrecachedAd(e[i])&&(e[i].ext.ableToCache="success"===t)}function _t(e){var i=I.numOfBannersToCache,r=Qe(e).slice(0,i),a=!0;return t.Utils.each(r,(function(e,t){return!n.AdUtils.isCacheableAd(t)||Ve(t)||le.isAdInCache(n.AdUtils.getAdId(t))||le.getAdStatusInQueue(n.AdUtils.getAdId(t))===le.cachingStatus.pending||(a=!1),a})),a}function Wt(e){var i=le.isPrecache();i&&!an()?n.AdsAssetsManager.cacheAssetsOfAd(v.getActiveInventory().getCurrentOffer(),X,Et(I)).then(_e.bind(null,e.inventoryId)):i&&!_t(e.inventoryId)?le.updateCache(J):N&&t.VastUtils.isVastCanPlayAgain(e)&&le.cacheSingleAd(n.AdUtils.formatVastAdForPrecache(e,ke.bind(null,e)),J)}function Gt(e){e.forEach((function(e){var t=n.AdUtils.getAdId(e);Q.hasOwnProperty(t)&&(e.adAssetsCacheStatus=Q[t])}))}function Ht(e,r){if(n.log("engageEnd",n.LogLevels.verbose),te.shouldReceiveMessage(X,e))if(e.productType!==i.BN){Jt(e);var a=Qt;qt(ne)?e.engaged?a.handlePrefetchFailedOnVisible(e):a.handlePrefetchFailedOnBackground(e):e.engaged?a.handleAdClosed(e):a.handlePrefetchFailedOnBackground(e),(t.Utils.isFunction(r)?r:function(){})()}else it(e)}function qt(e){n.log("getAndResetErrorStateFromTaskManager",n.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[te.extendCallbackParamsWithProductConfig(X,{error:!1})]),t}function Jt(e){n.log("_resetPreloadedAd",n.LogLevels.verbose),nt(e),Z.resetBaseData(i.baseDataKeys),m.setCanPreloadFlag(!0)}var Qt={handlePrefetchFailedOnBackground:function(e){n.log("_backgroundPrefetchFailed | ManualLoad",n.LogLevels.verbose),l.getNextAd(!1,e.inventoryId,!0)?Wt(e):this.publishNoMoreOffers(i.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){n.log("handlePrefetchFailedOnVisible | manuel load",n.LogLevels.verbose),Wt(e)},handleAdClosed:function(e){n.log("handleAdClosed | manuel load | Do not perform internal load."),Ft(),Tt(),v.reset(),t.PubSub.publish(a.productType+".resetStateManager",[X])},publishNoMoreOffers:function(e){n.log("publishNoMoreOffers | ManualLoad",n.LogLevels.verbose);var r=te.extendCallbackParamsWithDemandConfig(X,{errorMsg:e||i.noMoreOffersReason.noMoreOffersToShowInFeed});t.PubSub.publish(a.productType+".NoMoreOffers",[r])}};function $t(e){if(te.shouldReceiveMessage(X,e)){var i=n.AdUtils.getAdId(e),r=qe(i,e.inventoryId);if(n.log("ProductInstance | adVisible | id="+i),ne.publish("Engaged",[te.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]),n.SKAdImpressionService.startImpression(r,Cn,In),t.VastUtils.isVastCampaign(r)){var a=t.VastUtils.getVastViewCount(r);Z.trackTimingStop(C.adVisible,{vastViewCount:t.VastUtils.getVastViewCountForEvent(a),eNameStart:C.showAdCalled}),n.log("ProductInstance | send event adVisible"),t.VastUtils.isVastCanPlayAgain(r)||Ge(i,e.inventoryId)}else{var o=n.getRecoveryInfo(),s=zt(r)?1:0;Z.trackTimingStop(C.adVisible,{eNameStart:C.showAdCalled,custom_b:n.getIT(),custom_a:o,custom_c:s}),n.log("ProductInstance | send event adVisible"),Ge(i,e.inventoryId)}Z.trackTimingStart(C.adVisibleToClose),I.extraOffersInEndCard&&n.ExtraOffers.isSupported(n.getConfig().mobileSDKSettings.deviceOs,n.getConfig().mobileSDKSettings.deviceApiLevel,r,I)&&Xt()}}function zt(e){if(e&&e.ext&&e.ext.type&&("customEndCard"===e.ext.type&&void 0!==e.ext.UII))return!0;return!1}function Xt(){window.jQuery.when(vn()).then((function(e){var t=n.getCurrentDisplayedAd();return n.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)})).then((function(e){n.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))})).fail((function(e){n.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";n.log("onExtraOffersFetchFail | Reason: "+t),Z.report(C.getExtraOffersInventoryFailed,{callfailreason:t})}))}function Yt(t,n){return new(e("../../components/precacheManager.js"))(t,n,Zt())}function Zt(){var e=an()?X.productType+"_"+X.demandSourceName:i.cacheAdsDirectory;return w.cacheBase=e,w.precachePath="../"+w.cacheBase+"/",w=t.Utils.extend(w,X)}function en(){var e=n.SupplyConfigurations.getNetworkConfigValueByKey(i.cacheConfiguration);e&&e.adLevelCacheTimeout&&(a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow=1e3*e.adLevelCacheTimeout)}function tn(e){return X[e]}function nn(e){e&&e.demandSourceName===p&&vn()}function rn(e,t){var i;if(n.log("in load ad with params: "+JSON.stringify(e),n.LogLevels.verbose),!e||e.demandSourceName!==p)return i=pe.extendEventElapsedTime(a.productType,p,{callFailReason:a.errors.general.dsNameNotValid}),Z.report(C.loadAdIgnored,i),void pe.clearStartTime(a.productType,p);n.unloadAdViewsByProduct(X),n.log("resetting last response to none",n.LogLevels.verbose),Ut(e,t)}function an(){for(var e=z.getDestination(p),t=[i.gatewayDestinationMap.IS.production,i.gatewayDestinationMap.BN.production,i.gatewayDestinationMap.RV.production],n=0;n<t.length;n++)if(-1!==e.indexOf(t[n]))return!1;return!0}function on(){if(sn())return n.log("audioSession | handleAudioSessionStart",n.LogLevels.info),de.enableControlOverAudioSession();var e=new jQuery.Deferred;return e.resolve(),e.promise()}function sn(){return n.isIOS()&&I.manageIOSAudioSession}function dn(){sn()&&(n.log("audioSession | handleAudioSessionEnd",n.LogLevels.info),de.disableControlOverAudioSession())}function ln(e,t,i){var r=ze(v.getActiveInventoryId());n.RingerSwitchService.isInitiated()&&r&&(n.RingerSwitchService.startListener(pn(r.ext)),n.log("Ringer | startListener from DS.",n.LogLevels.info)),mn(),on().always((function(){l.preload(!0,v.getActiveInventoryId()).then((function(){return l.show(Pt())})).then((function(){fn(t)})).fail((function(e){n.log("Cannot engage at this time "+ne.getStatusMsg(),n.LogLevels.error),gn(i,e)}))}))}function cn(){var e=Pt();if(e){n.setCurrentDisplayedAd(e);var t=n.getAdViewContainer(e);t&&t.shouldReportAdVisible()&&n.onAdVisible(e)}}function un(e){var r=new window.jQuery.Deferred;return e?ne.canEngage()?(St(!0),e=t.Utils.extend(e,{showAdCallbacks:{onShowSuccess:r.resolve,onShowFailed:r.reject}}),n.displayAdView(e),r.promise()):r.reject(i.errors.showAdFailedReasons.taskManagerEngage):r.reject(i.errors.showAdFailedReasons.showNoAd)}function pn(e){return e?{ringerUpdateDelay:I.ringerUpdateDelay,shouldSetRingerUpdateDelay:n.AdUtils.isPlayableCampaign(e)||n.AdUtils.isMRAIDCampaign(e)||n.AdUtils.isExternalCampaign(e)}:{}}function fn(e){Z.trackTimingStop(C.showAdSuccess,{eNameStart:C.showAdCalled}),n.callSDKFunction(e,te.extendCallbackParamsWithDemandConfig(X)),Y.onShowSuccess(X)}function gn(e,r){var o=te.extendCallbackParamsWithDemandConfig(X,{errMsg:r});t.PubSub.publish(a.productType+".failedToShow",[o]);var s=r;s!==i.errors.showAdFailedReasons.preloadNoAd&&s!==i.errors.showAdFailedReasons.showNoAd&&(s=s+". "+ne.getStatusMsg()),Z.report(C.showAdFail,{callFailReason:s}),n.callSDKFunction(e,te.extendCallbackParamsWithDemandConfig(X,{errMsg:r})),r!==i.errors.showAdFailedReasons.onAdVisibleFailed&&r!==i.errors.showAdFailedReasons.screenVisibleTimeout||St(!1)}function vn(){var e={impressionsCount:n.ImpressionsCounterService.getPayloadCounters(X).instanceImpressions,firstAttemptToGetFeed:ce,retryCounter:F,deliveryPlumbus:$,sesp:s.getData(a.productType+"sesp"),adServicesExtensionLevel:n.getAdServicesExtensionLevel()};return oe.createPayload(e).then((function(e){return c=e}))}function mn(){G=new window.jQuery.Deferred;var e=t.PubSub.subscribe(W+".getDemandSourceStateSuccess",(function(n){te.shouldReceiveMessage(X,n)&&(t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(i),"resolved"!==G.state()&&(H=n&&n.state||H,G.resolve(n)))})),i=t.PubSub.subscribe(W+".getDemandSourceStateFail",(function(n){te.shouldReceiveMessage(X,n)&&(t.PubSub.unsubscribe(i),t.PubSub.unsubscribe(e),"resolved"!==G.state()&&G.resolve())})),r=te.extendCallbackParamsWithParentProductConfig(X);n.callSDKFunction("getDemandSourceState",r,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function hn(e,t){var i=n.getContainerCreationHandler(e),r=i.getState();r===i.getCreationStates().createdSuccessfully?(n.log("product instance | containerState | createdSuccessfully ",n.LogLevels.info),t.resolve(e)):r===i.getCreationStates().duringCreation?window.jQuery.when(i.getCreationResultPromise()).then((function(){n.log("product instance | during creation result: success",n.LogLevels.info),t.resolve(e)})).fail((function(e){t.reject("product instance | "+e)})):t.reject("product instance | did not start to create native webview")}function bn(e){var i=n.AdUtils.getAdId(e),r=w.precachePath+i+"/";t.AdAssets.updateAdunitPrecachePath(e,r,n.isAndroid())}function Sn(e,n,i){var r=!1;return e&&!n&&(t.VastUtils.isVastCampaign(i)&&!Ve(i)||(r=!0)),r}function yn(e,t,n){var i=a.timerLengths.loadAdToAdPlayerTimeout;i>-1&&(clearTimeout(L),L=setTimeout((function(){At(e,t,n)}),i))}function An(){return r.shouldAvoidHandleFrameClose}function Cn(){Z.report(C.startImpressionSuccess)}function In(e){Z.report(C.startImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function wn(){Z.report(C.endImpressionSuccess)}function Dn(e){Z.report(C.endImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Pn(){var e=H===i.demandSourceStates.cappedPerSession;return e&&t.Utils.isDefined(X)&&n.log("isDemandCapped | demandSource "+X.demandSourceName+" is capped"),e}var Fn={name:p,init:function(){l=this,u||(Ft(),le=Yt(t,n),fe(),ge(),en(),le.init(),ne.init(),n.initAnalytics(te.extendCallbackParamsWithParentProductConfig(X,{})),u=!0)},isNextAvailable:function(e){if(le.isPrecache()){var n=Qe(e);return le.isNextAvailable(n)||n&&n[0]&&!n[0].isCacheable}return v.isNextOfferAvailable(e)||t.VastUtils.isVastCanPlayAgain(ze(e))},prepareAdToEngageEnd:function(e){return Ve(e)?le.deleteCachedCampaign(n.AdUtils.getAdId(e)):t.Utils.returnResolvedPromise()},getNextAd:function(e,t,n){var i=l.isNextAvailable(t);return le.isPrecache()&&!i&&(i=Xe(n||e,t)),i},attemptToPreloadAd:function(e,i){var r=Pn();if(!r||e){var a=Qe(i),o=ze(i),s=st(t.VastUtils.isVastCampaign(o))||t.VastUtils.areAllCampaignTypesAreVast(a),d=le.isPrecache();ot(t.VastUtils.isVastCampaign(o),i)&&lt(i),m.canPreloadCandidateAd(r,e,o,s,d,I.displayOnAdReady)&&l.preloadAd(e,i)}else n.log("Skipping preload on capped demand",n.LogLevels.verbose)},preloadAd:function(e,t){l.preload(e,t).then((function(){e&&l.show(Pt())}))},preload:function(e,r){var a,o=new window.jQuery.Deferred;return ne.canPreload()?(a=Pt()||ze(r))||(a=Xe(e,r),Ye(a,D.softprecache),a)?(a=t.Utils.extend(!0,a,X),n.isContainerLoaded(a)?o.resolve(a):l.preloadFlow(a,e,o),o.promise()):(n.log("Cannot preload with no offer",n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.preloadNoAd)):(n.log("Cannot preload at this time, "+ne.getStatusMsg(),n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,r,a){n.log("ProductInstance | preloadFlow"),m.preloadAdFinished();var o,s=!1,d=le.isPrecache(),l={preload:!r};e&&e.displayMode==D.softprecache&&(s=!0),Sn(d,s,e)&&bn(e),e.isWPAD=se.shouldDisplayAdOnExternalWebView(e,I),e.isWPAD?(n.AdUtils.setViewType(I,e,i.viewTypes.externalView),V.shouldBuildAdUnitUrlForExternal=!0,o=2):(n.log("ProductInstance | ad is not WPAD"),n.AdUtils.removeViewTypeFromSetting(I),V.shouldBuildAdUnitUrlForExternal=!1,o=1),e.displayStrategy=o;var c=n.AdUtils.updateEventWithAdParams(I,e,{});c=t.Utils.extend(c,{displaystrategy:o}),Z.updateBaseData(c),Dt(e);var u=d||n.getAdPlayerAssets().isAdplayerReadyToUseFromCache(),p=n.getDeviceOs(),f=g.getAdPlayerUrl(u,p,X,V);yn(e,f,r),I=t.Utils.extend(I,l),n.AdUtils.setViewType(I,e),A.shouldShowInStandAloneView(n.getConfig())&&n.AdUtils.extendSettingsWithStandaloneViewSupport(I),e=n.StoreKitService.updateAdWithStoreAppId(e,I),n.loadAdUnitUrl(e,f,X,I),e.isWPAD?hn(e,a):a.resolve()},show:un,getDSAnalytics:me,adVisible:$t,engageEnd:Ht,initProduct:nn,loadAd:rn,showAd:ln,showAdBanner:cn,getProperty:tn,getPreLoadedAd:Pt,isDemandCapped:Pn,shouldAvoidHandleFrameClose:An,reset:Ot,getStatus:ne.getStatus,instConfig:r,statesManager:d};return l=Fn,Fn}t.exports=i},{"../../components/MraidCreativeService":63,"../../components/OMIDConstants":72,"../../components/VastService.js":96,"../../components/containers/WPADUtils":116,"../../components/precacheManager.js":122,"../../patches/PatchIOSLoadAfterLoad.js":221,"../../patches/PublisherPatchEasybrain.js":224,"../DynamicUI/CustomComponentsEvents":171,"../DynamicUI/CustomComponentsLoader":172,"../IOSAudioSessionHandler":178,"./../../components/AdFeaturesParser":27,"./../../components/MultipleInventories.js":66,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":125,"./../RewardedVideo/availabilityManager.js":189,"./../RewardedVideo/availabilityReporter.js":190,"./../RewardedVideo/dsTaskManager.js":191,"./DemandEntityBuilder.js":161,"./FetchDemand/FetcherPatch.js":165,"./PayloadBuilder.js":166,"./PreloadAdManager":168}],170:[function(e,t,n){t.exports=function(e,t,n){const i=n&&n.getNetworkConfigValueByKey("adLoadedTimeout");var r;r=isNaN(i)?8e3:i;var a=(e=e||{}).Features||{},o=e.ProductName;return{initiated:!1,overrideFeedSettings:a,productType:o,errors:{init:{missingData:"Failed to get required parameters",1001:"Trying to call API while during an un-finished process"},load:{noMoreOffers:"Failed to load "+o+" ad",duringLoad:"Load "+o+" is already in progress",duringShow:"Can not Load "+o+" when showing ad",timeout:"API request timeout",totalLoadTimeout:"JS Load process timeout - totalLoadTimeout of 20 seconds",invalidErrorCode:"Invalid API response has error code with no error message",invalidAdm:"Invalid API response Adm structure is wrong",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:o+" load is in progress",visible:o+" is already showing",tryingToEngage:o+" is in showing process",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:30,cacheBase:null,precachePath:null,timeoutForCachingAdsInAdLevelCacheFlow:2e4},timeUnit:6e4,timerLengths:{initAttemptsDelay:500,serverResponseTimeoutInMilis:7e3,loadAdToAdPlayerTimeout:r,totalLoadFlowTimeout:22e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:1,analyticsCategories:t,shouldDisplayOnAdReady:!!a.displayOnAdReady,forcePreload:e.forcePreload,adUnitCallbacks:e.AdUnitCallbacks,controllerNativeAPI:e.ControllerNativeAPI}}},{}],171:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=new(e("../../modules/DemandSource/EventCategories"));t.exports=class{constructor(e){this.analytics=e}trackDownloadSuccess(e){this.analytics.report(i.customComponentDownloadSuccess,e)}trackDownloadFailed(e){this.analytics.report(i.customComponentDownloadError,e)}}},{"../../modules/DemandSource/EventCategories":162}],172:[function(e,t,n){"use strict";var i=e("tslib");t.exports=class{constructor(e,t,n){this.controller=e,this.analytics=t,this.dynamicUIHost=n}downloadCustomComponents(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){for(let t in e)if(e.hasOwnProperty(t)){const n=e[t];for(let e=0;e<n.length;e++)yield this.downloadCustomComponentAndFireEvent(n[e],t)}}))}getComponentUrl(e,t){const{id:n}=e;return`${this.dynamicUIHost}templates/${t}/${n}.html`}downloadCustomComponentAndFireEvent(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getComponentUrl(e,t);try{const t=yield this.controller.FetchDirectService.get(n);e.htmlContent=t,this.analytics.trackDownloadSuccess({generalMessage:n})}catch(t){e.errorReason=t?t.statusText:"unknown",this.analytics.trackDownloadFailed({callFailReason:t.statusText,generalMessage:n})}}))}}},{tslib:25}],173:[function(e,t,n){t.exports=function(t){var n={prod:e("./EnvironmentProduction"),staging:e("./EnvironmentStaging")};return n[t.environment]?new n[t.environment](t,e("./constants")):new n.staging(t,e("./constants"))}},{"./EnvironmentProduction":174,"./EnvironmentStaging":175,"./constants":176}],174:[function(e,t,n){t.exports=function(e,t){var n,i=t.fileExtension,r=t.controllerFolder,a=t.cacheRootFolder,o=t.jQueryFileName,s=e.controllerVersion,d=e.schema,l=e.cdnDomain,c=e.scdnDomain,u=e.environment,p=a[e.deviceOs],f=e.cdnService,g=e.domain;function v(){return d+"//"+l+"/mobileSDKController"}function m(){return p}return{getControllerHost:v,getControllerJsUrl:function(){return v()+"/versions/"+s+"/sdk_controller"+i+".js"},getJQueryUrls:function(){return[d+"//code.jquery.com/"+o,d+"//"+l+"/libs/"+o]},getConfig:function(){return{controllerVersion:s,schema:d,cdnDomain:l,environment:u,cacheRootFolder:p,serviceCdn:f,domain:g}},getCacheControllerJsUrl:function(){return m()+"/"+r+s+"/sdk_controller"+i+".js"},getCacheJQueryPath:function(){return m()+"/assets/"+o},getAppConfigDomain:function(){return d+"//"+f},getUrlToCdnAdUnit:function(){return n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+c},setController:function(e){n=e},getStaticGlobalsUrl:function(e){return d+"//"+c+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return d+"//"+c+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return d+"//"+f+"/delivery/mobile/adUnit/getAppConfig.php"},getCacheRootFolder:m,getExternalLibrariesUrl:function(){return v()+"/libs/"},getCacheLibsPath:function(){return m()+"/libs/"},getDynamicUIHost:function(){return d+"//"+l+"/ad-player/dist/dynamic-ui/"}}}},{}],175:[function(e,t,n){t.exports=function(e,t){t.fileExtension;var n=t.controllerFolder,i=t.cacheRootFolder,r=t.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,d=(e.scdnDomain,e.environment),l=e.stagingCdnDomain,c=i[e.deviceOs],u=e.cdnService,p=e.domain;function f(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e}function g(){return c}return{getControllerHost:f,getControllerJsUrl:function(){return f()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:d,cacheRootFolder:c,stagingCdnDomain:l,domain:p}},getCacheControllerJsUrl:function(){return e=a,g()+"/"+n+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return g()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getUrlToCdnAdUnit:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e},setController:function(e){e},getStaticGlobalsUrl:function(e){var t=l.split(".")[0];return o+"//"+l+"/users/staging/"+t+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=l.split(".")[0];return o+"//"+l+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},getCacheRootFolder:g,getExternalLibrariesUrl:function(){return f()+"/common/libs/"},getCacheLibsPath:function(){return g()+"/libs/"},getDynamicUIHost:function(){return f()+"/ad-player/dist/dynamic-ui/"}}}},{}],176:[function(e,t,n){t.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],177:[function(e,t,n){t.exports={serviceAPIKey:"audioSessionAPI",cbNative:"NativeCallback.",API:{getAudioSessionData:{name:"getAudioSessionData",success:"getAudioSessionDataSuccess",failure:"getAudioSessionDataFailure"},setAudioSessionData:{name:"setAudioSessionData",success:"setAudioSessionDataSuccess",failure:"setAudioSessionDataFailure"},activateAudioSession:{name:"activateAudioSession",success:"activateAudioSessionSuccess",failure:"activateAudioSessionFailure"},deactivateAudioSession:{name:"deactivateAudioSession",success:"deactivateAudioSessionSuccess",failure:"deactivateAudioSessionFailure"},isOtherAppPlayingAudio:{name:"isOtherAppPlayingAudio",success:"isOtherAppPlayingAudioSuccess",failure:"isOtherAppPlayingAudioFailure"},getAvailableCategories:{name:"getAvailableCategories",success:"getAvailableCategoriesSuccess",failure:"getAvailableCategoriesFailure"},getAvailableModes:{name:"getAvailableModes",success:"getAvailableModesSuccess",failure:"getAvailableModesFailure"}},knownCategories:{AVAudioSessionCategoryAmbient:"AVAudioSessionCategoryAmbient",AVAudioSessionCategorySoloAmbient:"AVAudioSessionCategorySoloAmbient",AVAudioSessionCategoryPlayback:"AVAudioSessionCategoryPlayback",AVAudioSessionCategoryRecord:"AVAudioSessionCategoryRecord",AVAudioSessionCategoryPlayAndRecord:"AVAudioSessionCategoryPlayAndRecord",AVAudioSessionCategoryMultiRoute:"AVAudioSessionCategoryMultiRoute"},knownCategoryOptions:{AVAudioSessionCategoryOptionMixWithOthers:1,AVAudioSessionCategoryOptionDuckOthers:2,AVAudioSessionCategoryOptionAllowBluetooth:4,AVAudioSessionCategoryOptionDefaultToSpeaker:8,AVAudioSessionCategoryOptionInterruptSpokenAudioAndMixWithOthers:17,AVAudioSessionCategoryOptionAllowBluetoothA2DP:32,AVAudioSessionCategoryOptionAllowAirPlay:64},knownModes:{AVAudioSessionModeDefault:"AVAudioSessionModeDefault",AVAudioSessionModeVoiceChat:"AVAudioSessionModeVoiceChat",AVAudioSessionModeVideoRecording:"AVAudioSessionModeVideoRecording",AVAudioSessionModeMeasurement:"AVAudioSessionModeMeasurement",AVAudioSessionModeMoviePlayback:"AVAudioSessionModeMoviePlayback",AVAudioSessionModeVideoChat:"AVAudioSessionModeVideoChat",AVAudioSessionModeSpokenAudio:"AVAudioSessionModeSpokenAudio"}}},{}],178:[function(e,t,n){t.exports=function(t,n){var i=e("./IOSAudioSessionConstants.js"),r=e("./IOSAudioSessionService.js")(t,n,i),a=!1,o={};function s(){n.log("IOSAudioSessionHandler | setNewAudioSessionData");var e={functionParams:{category:i.knownCategories.AVAudioSessionCategorySoloAmbient}};return r.setAudioSessionData(e)}function d(e){return n.log("IOSAudioSessionHandler | saveCurrentAudioSessionData: "+JSON.stringify(e)),o=e,t.Utils.returnResolvedPromise()}function l(e){n.log("IOSAudioSessionHandler | _setCurrentlyEnabled: isEnabled="+e),a=e}return n.log("IOSAudioSessionHandler | constructor",n.LogLevels.error),{enableControlOverAudioSession:function(){return n.log("IOSAudioSessionHandler | enableControlOverAudioSession"),(n.log("IOSAudioSessionHandler | handleOtherAppPlayingState"),r.getAudioSessionData()).then(d).then(s).then((function(){l(!0)})).fail((function(e){n.log("IOSAudioSessionHandler | enableControlOverAudioSession | failed  with error: "+e)}))},disableControlOverAudioSession:function(){if(n.log("IOSAudioSessionHandler | disableControlOverAudioSession"),a)return r.setAudioSessionData({functionParams:{restoredAudioSessionData:o}}).then((function(){l(!1)})).fail((function(e){n.log("IOSAudioSessionHandler | disableControlOverAudioSession | failed  with error: "+e)}));n.log("IOSAudioSessionHandler | disableControlOverAudioSession | avoid - currently not enabled")}}}},{"./IOSAudioSessionConstants.js":177,"./IOSAudioSessionService.js":179}],179:[function(e,t,n){t.exports=function(e,t,n){var i=t.jQuery();return{getAudioSessionData:function(){t.log("IOSAudioSessionService | getAudioSessionData",t.LogLevels.info);var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAudioSessionData.success,(function(i){var s,d;t.log(n.API.getAudioSessionData.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve((d={},(s=i).category&&(d.category=s.category),s.mode&&(d.mode=s.mode),s.categoryOptions&&(d.categoryOptions=s.categoryOptions),d))})),a=e.PubSub.subscribe(n.cbNative+n.API.getAudioSessionData.failure,(function(i){t.log(n.cbNative+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject({errMsg:"failed in native"})})),t.callSDKService(n.serviceAPIKey,n.API.getAudioSessionData.name,{},n.API.getAudioSessionData.success,n.API.getAudioSessionData.failure),o.promise()},setAudioSessionData:function(r){t.log("IOSAudioSessionService | setAudioSessionData");var a,o,s=new i.Deferred,d=r||{};return a=e.PubSub.subscribe(n.cbNative+n.API.setAudioSessionData.success,(function(i){t.log(n.API.setAudioSessionData.success+" | params "+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(o),s.resolve()})),o=e.PubSub.subscribe(n.cbNative+n.API.setAudioSessionData.failure,(function(i){t.log(n.API.setAudioSessionData.failure+JSON.stringify(i)),e.PubSub.unsubscribe(o),e.PubSub.unsubscribe(a),s.reject()})),t.callSDKService(n.serviceAPIKey,n.API.setAudioSessionData.name,d,n.API.setAudioSessionData.success,n.API.setAudioSessionData.failure),s.promise()},isOtherAppPlayingAudio:function(){t.log("IOSAudioSessionService | isOtherAppPlayingAudio");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.isOtherAppPlayingAudio.success,(function(i){t.log(n.API.isOtherAppPlayingAudio.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.otherAppPlaying)})),a=e.PubSub.subscribe(n.cbNative+n.API.isOtherAppPlayingAudio.failure,(function(i){t.log(n.API.isOtherAppPlayingAudio.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.isOtherAppPlayingAudio.name,{},n.API.isOtherAppPlayingAudio.success,n.API.isOtherAppPlayingAudio.failure),o.promise()},getAvailableCategories:function(){t.log("IOSAudioSessionService | getAvailableCategories");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAvailableCategories.success,(function(i){t.log(n.API.getAvailableCategories.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.availableCategories)})),a=e.PubSub.subscribe(n.cbNative+n.API.getAvailableCategories.failure,(function(i){t.log(n.API.getAvailableCategories.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.getAvailableCategories.name,{},n.API.getAvailableCategories.success,n.API.getAvailableCategories.failure),o.promise()},getAvailableModes:function(){t.log("IOSAudioSessionService | getAvailableModes");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAvailableModes.success,(function(i){t.log(n.API.getAvailableModes.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.availableModes)})),a=e.PubSub.subscribe(n.cbNative+n.API.getAvailableModes.failure,(function(i){t.log(n.API.getAvailableModes.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.getAvailableModes.name,{},n.API.getAvailableModes.success,n.API.getAvailableModes.failure),o.promise()}}}},{}],180:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.InstancesEventsHandler=void 0;n.InstancesEventsHandler=class{constructor(e){this.constants=e.constants,this.controller=e.controller,this.core=e.core,this.analyticsCategories=e.controller.EventsCategories}reportAssetRetrySuccessEvent(e,t){if(e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=this.controller.InstancesTimers.extendEventElapsedTime(e.productType,e.demandSourceName,{generalMessage:n.substring(0,250)});e.assetType===this.constants.assetType.adunitAsset?t.report(this.analyticsCategories.adUnitRetrySuccess,i):e.assetType===this.constants.assetType.adAsset&&t.report(this.analyticsCategories.adAssetRetrySuccess,i)}}reportAssetRetryFailedEvent(e,t){if(e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=this.controller.InstancesTimers.extendEventElapsedTime(e.productType,e.demandSourceName,{generalMessage:n.substring(0,250)});e.assetType===this.constants.assetType.adunitAsset?t.report(this.constants.adUnitRetryFail,i):e.assetType===this.constants.assetType.adAsset&&t.report(this.analyticsCategories.adAssetRetryFail,i)}}reportMrailImpressionEvent(e,t){this.controller.log("MrailImpression with params: "+JSON.stringify(e),this.controller.LogLevels.verbose),e=e.hasOwnProperty("callback")?(delete e.callback,e):e,t.report(this.analyticsCategories.mrailImpression,e)}handleAnalyticsGlobalEvent(e,t){var n=e.action,i=e.eventParam;"fireEvent"===n?(i.label&&Object.keys(i.label).length>0&&this.core.Utils.extend(i.data,i.label),t.report(i.eName,i.data)):"startTiming"===n?t.trackTimingStart(i.eName,i.data):"stopTiming"===n?t.trackTimingStop(i.eName,i.data):"setCustomData"===n&&(this.controller.log("Controller - setCustomData received",this.controller.LogLevels.verbose),t.updateBaseData(i.data))}}},{}],181:[function(e,t,n){t.exports=class{constructor(e,t){this.instancesMap={},this.logTag="InstancesMemoryHandler | ",this.controller=e,this.productAdapter=t}clear(e){if(!this.instancesMap.hasOwnProperty(e))return void this.log("clear | can not clear demandSourceName "+e+" | it does not exist | instancesMap "+this.instancesMap);let t=this.instancesMap[e],n=this.productAdapter[t];if(n){n.clearListeners(),delete this.productAdapter[t];let e=n.getPreLoadedAd();e&&this.controller.unloadAdViewByAdViewId(e.adViewId)}this.remove(e)}isExist(e,t){return this.instancesMap[e]===t}log(e){this.controller.log(this.logTag+e)}add(e,t){this.isExist(e,t)||(this.clear(e),this.instancesMap[e]=t)}remove(e){delete this.instancesMap[e]}}},{}],182:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.Utils.extend(!0,{barSettings:{isUpper:!0,color:"#FF0000"}},t.Features);return{NativeAPI:t.NativeAPI,ControllerCallbacks:t.ControllerCallbacks,AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,DemandName:"InterstitialDS",ProductName:i.IS,Features:r,gatewayDestinationMap:{prod:i.gatewayDestinationMap.IS.production},amountOfInventories:t.amountOfInventories}}},{}],183:[function(e,t,n){t.exports=function(t,n,i,r){"use strict";var a,o,s,d=e("./InstancesMemoryHandler"),l=n.ManualLoadInstancesBuilder,c=n.EventsCategories,u=new(e("./DataStore")),p=new(e("./DemandSource/dsConfig"))(i,c,n.SupplyConfigurations),f=new(e("./prdTaskManager"))(t,n,i.ProductName,r),g=new(e("../components/FilteredListService")),v=e("../components/WatermarkManager"),m={},h={},b=!1,S=n.DemandUtils,y=[],A=null,C=null,I=n.InstancesTimers,w={loadSuccess:null,loadFailure:null};function D(e){I.clear(i.ProductName,e),delete a[e]}function P(e){return t.Utils.extend(!0,{},{originalDemandSourceName:W(e)},e)}function F(o){var d=W(o);return a[d]?a[d]:function(o){var d=W(o),c=new v(o,n),f={productType:i.ProductName,demandSourceName:d,isInAppBidding:R(o),isOneFlow:K(o),isLoadWithAdmFlow:_(o),demandSourceId:o.demandSourceId,originalDemandSourceName:o.originalDemandSourceName||W(o),adSize:{width:o.width,height:o.height,label:o.label},isMultipleAdObjects:j(o),watermark:c.getWatermarkConfig()},g=l.createDemandEntityConfigObj(f);n.log("initiating "+i.ProductName+" demand source with configuration "+JSON.stringify(g),n.LogLevels.verbose),g.shouldAvoidHandleFrameClose=i.shouldAvoidHandleFrameClose,n.isBannerMultipleInstances(i.ProductName)?a[d]=function(i){var a=B(i),o=new(e("./ProductAdapter/BidderProductStatesManager"))(t,n,i,p,r,a);return new(e("./DemandSource/BannerBidderInstance.js"))(t,n,r,i,p,a,o,A,C)}(g):a[d]=g.isLoadWithAdmFlow?function(a){var o=B(a);s=function(a){if(s)return s;var o={productType:i.ProductName,isInAppBidding:!0,originalDemandSourceName:a.originalDemandSourceName||W(a)},d=t.Utils.extend(!0,{},p.precacheConfig);return d.cacheBase=r.cacheAdsDirectory,d.precachePath="../"+d.cacheBase+"/",d=t.Utils.extend(d,o),new(e("../components/precacheManager"))(t,n,d)}(a);var d=new(e("./ProductAdapter/BidderProductStatesManager"))(t,n,a,p,r,o),l=new(e("./DemandSource/BidderProductInstance"))(t,n,r,a,p,o,s,d);return l}(g):function(a){var o=B(a),s=new(e("./ProductAdapter/ProductStatesManager"))(t,n,a,p,r,o,i.NativeAPI),d=new(e("./DemandSource/ProductInstance"))(t,n,r,a,p,o,u,s);return d}(g);return a[d].init(),a[d]}(o)}function O(e){return!!function(e,t){if(t===r.deviceOs.ios)return!!e.isViewControllerSet;return!0}(e,n.getConfig().mobileSDKSettings.deviceOs)}function T(e,t,a){var o=W(e),s=H(e);if(M(s),s.resetBaseData(r.baseDataKeys),L(s,o,c.loadRequest,n.AdUtils.getAdsInternalInfoEventData(e)),E(o))!function(e,t,r){var a=p.errors.load.instanceExhausted;e.productType=i.ProductName;var o=S.extendCallbackParamsWithDemandConfig(e,{errMsg:a});o=I.extendEventElapsedTime(e.productType,e.demandSourceName,o),t.report(c.loadAdFailedForExhaustedInstance,o),I.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(r,o)}(e,s,a);else{var d=F(e);if(d){if(e&&e.productType===r.BN){if(!O(e))return void function(e,t,i){t.report(c.loadAdFailed,{callfailreason:"Missing Parameter : View Controller",timingvalue:I.stop(e.productType,e.demandSourceName)}),n.callSDKFunction(i,S.extendCallbackParamsWithDemandConfig(e,{errMsg:"Missing Parameter : View Controller"}))}(e,s);n.addExternalAdViewIdAndSetStatus(e)}f.canEngage()?n.isBiddingOnlyApp()?G(e,s,a,"non-bidding instance is not available in this app"):d.statesManager.load(d.loadAd,t,a,d.readyStateParams):G(e,s,a,"LWS is not allowed for nonBidding instance")}else x(e,s,a)}}function x(e,t,n){G(e,t,n,p.errors.general.dsNotSet)}function N(e,i,a){var o=F(e),s=q(o);M(s),s.resetBaseData(r.baseDataKeys);var d=function(e){return e&&e.dynamicDemandSource?e.dynamicDemandSource:null}(e),l=function(e){if(!e)return null;try{var n=t.Utils.parseJSON(decodeURIComponent(e));return t.Utils.isEmptyObject(n)&&(n=null),n}catch(e){}return null}(e.adm),u={dynamicDemandSource:d,auctionId:U(l,"-1")};u=t.Utils.extend(u,function(e){var t={};e.label&&(t.adsizelabel=e.label);e.height&&e.width&&(t.adsizeheight=e.height,t.adsizewidth=e.width);return t}(e),function(e){if(!e||!e.seatbid||!e.seatbid.ext)return{};var t={landingId:e.seatbid.ext.landingId,strategyId:e.seatbid.ext.strategyId,adSource:e.seatbid.ext.adSource,dspname:e.seatbid.ext.dspName};return n.AdUtils.updateEventWithAdParams(e.seatbid.ext,e.seatbid.bid[0],t)}(l)),s.updateBaseData(u),L(s,e.originalDemandSourceName,c.loadAd,n.AdUtils.getAdsInternalInfoEventData(e)),o?l?(e.adm=l,o.loadAdWithAdm(e,i,a)):function(e,t,n){G(e,t,n,"unable to parse adm from native SDK")}(e,s,a):x(e,s,a)}function L(e,r,a,o){n.log("productAdapter - load",n.LogLevels.verbose);var s=I.extendEventElapsedTime(i.ProductName,r,{demandSourceName:r,integrationType:n.getBiddingLimitations().toString()});if(o&&o.success)s=t.Utils.extend(s,o.data);else{let e=o?o.error:{custom_a:"unknown error"};s=t.Utils.extend(s,e)}e.report(a,s),p.shouldDisplayOnAdReady&&e.trackTimingStart(c.showAdCalled)}function U(e,t){return e&&e.seatbid.ext.hasOwnProperty("auction")?e.seatbid.ext.auction.id:t}function M(e){n.getTokenService().getToken().then((function(t){const{mt:n}=t;n&&e.updateBaseData({mediationType:n})})).fail((function(e){n.log("Failed to get token from native"+e,n.LogLevels.ERROR)}))}function V(e){return e&&e.productType===i.ProductName}function E(e){return-1!==y.indexOf(e)}function k(e){return e?a[e]:null}function B(e){return t.Analytics.createAnalytic({baseData:{productType:i.ProductName,demandSourceName:e.originalDemandSourceName,demandSourceId:e.demandSourceId,isBiddingInstance:e.isInAppBidding,isOneFlow:e.isOneFlow,isMultipleAdObjects:j(e)}})}function R(e){return!(!e||!e.inAppBidding||"true"!==e.inAppBidding.toLowerCase())}function K(e){return!(!e||!e.isOneFlow||"true"!==e.isOneFlow.toLowerCase())}function j(e){if(!e||!e.isMultipleAdObjects)return!1;var t=e.isMultipleAdObjects;return!0===t||t.toLowerCase&&"true"===t.toLowerCase()}function _(e){return R(e)||K(e)}function W(e){return e&&e.demandSourceName?e.demandSourceName:i.DemandName}function G(e,t,r,a){e.productType=i.ProductName;var o=S.extendCallbackParamsWithDemandConfig(e,{errMsg:a});o.callfailreason=a,o.timingvalue=I.stop(e.productType,e.demandSourceName),o=I.extendEventElapsedTime(e.productType,e.demandSourceName,o),t.report(c.loadAdFailed,o),I.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(r,o)}function H(e){return q(a[W(e)])}function q(e){return e&&e.getDSAnalytics&&e.getDSAnalytics()?e.getDSAnalytics():o}return{init:function(){if(a=this,!b){var e={baseData:{productType:i.ProductName}};o=t.Analytics.createAnalytic(e),A=new d(n,a),C=new d(n,a),function(){var e=n.getProtocol();m={dev:e+i.gatewayDestinationMap.prod,stage:e+i.gatewayDestinationMap.prod,prod:e+i.gatewayDestinationMap.prod};var t,r,a=n.getApiData({destinationMap:0});if(a&&a.destinationMap)for(t in h=a.destinationMap)r=h[t],h[t]&&h[t].length>0&&-1===h[t].indexOf(e)&&(h[t]=e+r)}(),t.PubSub.subscribe(i.AdUnitCallbacks.engageEnd,(function(e,n){if(V(e)){var r=k(e.demandSourceName);r&&r.statesManager&&((e&&e.engaged||i.shouldResetOnEngageEnd)&&r.statesManager.engageEnd(),r.engageEnd(e,(function(){f.publish("Engaged",[{duringEngage:!1,productType:i.ProductName}]),t.Utils.isFunction(n)&&n()})))}})),t.PubSub.subscribe(i.AdUnitCallbacks.adClicked,(function(e){if(V(e)){var t=n.getCurrentDisplayedAd();t&&n.callSDKFunction(i.ControllerNativeAPI.adClicked,S.extendCallbackParamsWithProductConfig(t,{}))}})),t.PubSub.subscribe(i.AdUnitCallbacks.adVisible,(function(e){if(V(e)){var t=k(e.demandSourceName);t&&t.instConfig.isLoadWithAdmFlow||(t?(n.log("ProductAdapter | "+i.AdUnitCallbacks.adVisible+" demandSourceName="+e.demandSourceName),t.adVisible(e),t.statesManager&&t.statesManager.adVisible()):n.log(i.AdUnitCallbacks.adVisible+" called without an active demand source name"))}})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.cacheReady,(function(e){var t=k(e.demandSourceName);t&&t.statesManager&&(t.readyStateParams=e,t.statesManager.cacheReady(w.loadSuccess,e))})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.noMoreOffers,(function(e){var t=k(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(w.loadFailure,e.errorMsg)})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.failedToShow,(function(e){var t=k(e.demandSourceName);t&&t.statesManager&&(n.log(i.ProductName+" failed to show - can not engage ad",n.LogLevels.error),t.statesManager.failedToShow())})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.failedToLoad,(function(e){var t=k(e.demandSourceName);if(t&&t.statesManager){n.log(i.ProductName+" failed to load",n.LogLevels.error);var r={callFailReason:e.errMsg,timingvalue:I.stop(i.ProductName,e.demandSourceName)};r=I.extendEventElapsedTime(i.ProductName,e.demandSourceName,r),H(e).report(c.loadAdFailed,r),I.clearStartTime(i.ProductName,e.demandSourceName),t.statesManager.failedToLoad()}})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.actionClick,(function(e){n.OpenURLService.open(e)||n.log(i.ProductName+" failed to perform ActionClick",n.LogLevels.info)})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.exhaustedDemandSource,(function(e){var t=W(e),i=k(t);n.log("exhaustedDemandSource: "+t,n.LogLevels.verbose),i&&(i.exhausted=!0),y.push(t),e&&e.engaged||(n.log("Demand source deleted in BG: "+t,n.LogLevels.verbose),D(t))})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.fallbackToNonPrecache,(function(e){var t=k(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(w.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.resetStateManager,(function(e){var t=k(W(e));t&&t.statesManager&&t.statesManager.resetAdState()})),t.PubSub.subscribe("SDKController"+i.ControllerCallbacks.onAdWindowsClosed,(function(e){if(V(e)){var t=k(e.demandSourceName);if(t)return t.exhausted?(n.log("Demand source deleted: "+e.demandSourceName,n.LogLevels.verbose),void D(e.demandSourceName)):void 0}})),n.isBannerNoneLWS(i.ProductName)&&t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.reset,(function(e){var t=k(e.demandSourceName);if(t)return n.getExternalContainer().resetReportAdVisibilityFlags(),H(e).report(c.bannerDestroyed),t.statesManager.resetAdState(),void t.reset();n.log("Reset called without an active demand source name",n.LogLevels.verbose)})),t.PubSub.subscribe(r.BN+".isVisible",(function(e){if(e&&e.demandSourceName&&!n.isBannerMultipleInstances(r.BN)){var t=k(e.demandSourceName);t&&t.getPreLoadedAd()&&t.showAdBanner()}})),f.init(),b=!0}},getProductType:function(){return i.ProductName},getDestination:function(e){return h&&h[e]?h[e]:m[n.getEnv()]},getAmountOfSupportedInventories:function(){return i.amountOfInventories},shouldAvoidHandleFrameClose:function(){return i.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return i.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return f},initProduct:function(e,t,a){_(e=P(e))&&(e.demandSourceName=e.demandSourceId),I.setStartTime(i.ProductName,e.demandSourceName,e.loadStartTime);var o={isBiddingInstance:R(e),isOneFlow:K(e),demandSourceName:e.originalDemandSourceName};o=I.extendEventElapsedTime(i.ProductName,e.demandSourceName,o);var s=H(e);s.resetBaseData(r.baseDataKeys),s.report(c.initAd,o);var d=n.getSDKLimitationData(i.ProductName);if(!d.didSucceed)return o={callFailReason:d.errMsg,demandSourceName:e.originalDemandSourceName},o=I.extendEventElapsedTime(i.ProductName,e.demandSourceName,o),H(e).report(c.initAdFail,o),I.clearStartTime(i.ProductName,e.demandSourceName),void n.callSDKFunction(a,{errMsg:d.errMsg,demandSourceName:e.demandSourceName});var l=F(e);l.initProduct(e),n.callSDKFunction(t,S.extendCallbackParamsWithDemandConfig(l.instConfig))},loadProduct:function(e,t,a){if(n.log("productAdapter - loadProduct",n.LogLevels.verbose),e=P(e),I.start(i.ProductName,e.demandSourceName),I.setStartTime(i.ProductName,e.demandSourceName,e.loadStartTime),w.loadSuccess=t,w.loadFailure=a,_(e)){if(e.productType!==r.BN||n.isBannerMultipleInstances(e.productType)){if(j(e)){n.MultipleAdObjectsAdFormatsService.getActiveAdFormats().ismao.includes(i.ProductName)||(n.MultipleAdObjectsAdFormatsService.setActiveAdFormat(i.ProductName),n.getTokenService().updateToken(n.MultipleAdObjectsAdFormatsService.getActiveAdFormats()))}else A.add(e.demandSourceName,e.demandSourceId);e.demandSourceName=e.demandSourceId}N(e,t,a)}else T(e,t,a)},showProduct:function(e,i,a){_(e=P(e))&&(j(e)||(A.remove(e.demandSourceName),C.add(e.demandSourceName,e.demandSourceId)),e.demandSourceName=e.demandSourceId);var o=W(e),s=k(o),d=e&&e.orientationRestriction;if(H(e).updateBaseData({sessionDepth:n.ImpressionsCounterService.getTotalImpressionsByProduct(p.productType)+1}),H(e).report(c.showAd),n.AppOrientationManager.updateAppOrientationByNewRestriction(d),function(e,t,i,r){if(E(i)){var a={errMsg:p.errors.show.instanceExhausted,demandSourceName:i};return H(e).report(c.showAdFail,{callfailreason:p.errors.show.instanceExhausted}),n.callSDKFunction(t,a),!1}return!!r||(H(e).report(c.showAdFail,{callfailreason:p.errors.general.dsNotSet}),n.callSDKFunction(t,{errMsg:p.errors.general.dsNotSet}),!1)}(e,a,o,s)){if(!f.canEngage()){var l="Cannot engage offer at this time",u=s.instConfig,g=S.extendCallbackParamsWithDemandConfig(u,{errMsg:l});t.PubSub.publish(p.productType+".failedToShow",[g]);var v=l;return v!==r.errors.showAdFailedReasons.preloadNoAd&&v!==r.errors.showAdFailedReasons.showNoAd&&(v+=JSON.stringify(s.getStatus())),H(e).report(c.showAdFail,{callFailReason:v}),n.callSDKFunction(a,S.extendCallbackParamsWithDemandConfig(u,{errMsg:l})),void(l!==r.errors.showAdFailedReasons.onAdVisibleFailed&&l!==r.errors.showAdFailedReasons.screenVisibleTimeout||t.PubSub.publish(r.taskManager+".Engaged",[S.extendCallbackParamsWithProductConfig(u,{duringEngage:!1})]))}H(e).trackTimingStart(c.showAdCalled),s.statesManager.show(s.showAd,i,a)}},destroyProduct:function e(i){i.productType!==r.BN?function(e,t){if(n.log("productAdapter - destroy",n.LogLevels.verbose),!e||!j(e.instConfig))return;e.clearListeners(),delete a[e.name];var i=e.getPreLoadedAd();i&&n.unloadAdViewByAdViewId(i.adViewId);var r=S.extendCallbackParamsWithDemandConfig(e.instConfig,{custom_a:t});H(e.instConfig).report(c.destroyMultipleAdInstance,r)}(k(i.demandSourceId),"nativeSDK"+e.name):t.PubSub.publish("destroy."+i.demandSourceId,[])},initProductFail:function(e,t,i){var r=S.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r.callfailreason=i,r.timingvalue=I.stop(e.productType,e.demandSourceName),r=I.extendEventElapsedTime(e.productType,e.demandSourceName,r),H(e).report(c.initAdFail,r),I.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(t,r)},className:"ProductAdapter",filteredListService:g}}},{"../components/FilteredListService":49,"../components/WatermarkManager":99,"../components/precacheManager":122,"./DataStore":158,"./DemandSource/BannerBidderInstance.js":159,"./DemandSource/BidderProductInstance":160,"./DemandSource/ProductInstance":169,"./DemandSource/dsConfig":170,"./InstancesMemoryHandler":181,"./ProductAdapter/BidderProductStatesManager":184,"./ProductAdapter/ProductStatesManager":186,"./prdTaskManager":218}],184:[function(e,t,n){function i(e,t,n,i,r,a){var o={readyToLoad:0,inLoadingProcess:1,loaded:2,readyToShow:3,inShowingProcess:4,visible:5},s=o.readyToLoad,d=o.readyToShow,l=i.analyticsCategories,c=t.DemandUtils,u=c.extendCallbackParamsWithDemandConfig(n),p=t.InstancesTimers;function f(e){return s===e}function g(e){return d===e}function v(e){s=parseInt(e,10)}function m(e){d=parseInt(e,10)}function h(){return v(o.readyToLoad)}function b(){return m(o.readyToShow)}function S(){return f(o.readyToLoad)?i.errors.show.notLoaded:f(o.inLoadingProcess)?i.errors.show.duringLoad:g(o.inShowingProcess)?i.errors.show.tryingToEngage:g(o.visible)?i.errors.show.visible:"fail reason is unknown."}function y(e){if(g(o.visible)||g(o.inShowingProcess))t.log(S(),t.LogLevels.error);else if(!f(o.loaded)){var i=c.extendCallbackParamsWithDemandConfig(n,{errMsg:S()});t.callSDKFunction(e,i)}}function A(){t.log("BidderStateManager _loadWithADM"),v(o.inLoadingProcess)}function C(t,i,r){if(!I()){var s=e.Utils.extend(!0,{demandSourceName:n.originalDemandSourceName,callfailreason:S()},u);return a.report(l.showAdFail,s),void y(r)}m(o.inShowingProcess),t(u,i,r)}function I(){return f(o.loaded)&&g(o.readyToShow)}function w(i,r){v(o.loaded);var s=e.Utils.extend(!0,{},u,{demandSourceName:n.originalDemandSourceName,timingvalue:p.stop(n.productType,n.originalDemandSourceName),integrationType:t.getBiddingLimitations().toString()});s=p.extendEventElapsedTime(n.productType,n.originalDemandSourceName,s),a.report(l.loadAdSuccess,s),p.clearStartTime(n.productType,n.originalDemandSourceName),t.callSDKFunction(i,c.extendCallbackParamsWithDemandConfig(n,r)),e.PubSub.publish("ProductStatesManager.stateResolved",[c.extendCallbackParamsWithProductConfig(n,{response:!0})])}function D(o,s){var d=s===r.errors.noFill?l.noFill:l.loadAdFailed,f=e.Utils.extend(!0,{},u,{demandSourceName:n.originalDemandSourceName,callFailReason:s,timingvalue:p.stop(n.productType,n.originalDemandSourceName),integrationType:t.getBiddingLimitations().toString()});f=p.extendEventElapsedTime(n.productType,n.originalDemandSourceName,f),a.report(d,f),p.clearStartTime(n.productType,n.originalDemandSourceName);var g=c.extendCallbackParamsWithDemandConfig(n,{errMsg:i.errors.load.noMoreOffers});t.callSDKFunction(o,g),e.PubSub.publish("ProductStatesManager.stateResolved",[c.extendCallbackParamsWithProductConfig(n,{response:!1})]),h()}function P(){b()}function F(){h()}function O(){m(o.readyToShow)}function T(){v(o.readyToLoad),m(o.visible)}var x={show:C,cacheReady:w,noMoreOffers:D,failedToShow:P,failedToLoad:F,engageEnd:O,adVisible:T,loadWithADM:A,resetAdState:b};return x}t.exports=i},{}],185:[function(e,t,n){t.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,inLoadingProcess:1,loaded:2,inShowingProcess:3,visible:4}}},{}],186:[function(e,t,n){function i(t,n,i,r,a,o,s){var d=e("./ProductAdapterConstants.js"),l=d.adStates,c=l.notSet,u=r.analyticsCategories,p=n.DemandUtils,f=p.extendCallbackParamsWithDemandConfig(i),g=n.InstancesTimers;function v(e){return c===e}function m(e){c=parseInt(e,10)}function h(){return c}function b(){return m(l.notSet)}function S(){return v(l.loaded)}function y(e,s,d){if(v(l.inLoadingProcess)||i.productType===a.BN&&v(l.loaded)){d.name===u.loadAdFailed.name&&s===a.errors.noFill&&(d=u.noFill);var c=t.Utils.extend(!0,{callFailReason:s},f);c=g.extendEventElapsedTime(i.productType,i.demandSourceName,c),o.report(d,c),g.clearStartTime(i.productType,i.demandSourceName);var m=p.extendCallbackParamsWithDemandConfig(i,{errMsg:r.errors.load.noMoreOffers});n.callSDKFunction(e,m),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!1})])}b()}function A(e){if(s)if(e===s.load){if(v(l.inLoadingProcess))return r.errors.load.duringLoad;if(v(l.visible)||v(l.inShowingProcess))return r.errors.load.duringShow}else if(e===s.show){if(v(l.notSet))return r.errors.show.notLoaded;if(v(l.inLoadingProcess))return r.errors.show.duringLoad;if(v(l.visible)||v(l.inShowingProcess))return r.errors.show.visible}}function C(e,t){if(s){var r={};e===s.load?(r=p.extendCallbackParamsWithDemandConfig(i,{errMsg:A(s.load)}),n.callSDKFunction(t,r)):e===s.show&&(v(l.notSet)||v(l.inLoadingProcess)?(r=p.extendCallbackParamsWithDemandConfig(i,{errMsg:A(s.show)}),n.callSDKFunction(t,r)):(v(l.visible)||v(l.inShowingProcess))&&n.log(A(s.show),n.LogLevels.error))}}function I(e,t,n,r){i.productType!==a.BN?w(e,t,n,r):D(e,n)}function w(e,n,r){v(l.notSet)||v(l.loaded)?(m(l.inLoadingProcess),e(f,r)):(o.report(u.loadAdFailed,t.Utils.extend(!0,{},f,{callfailreason:A(s.load),timingvalue:g.stop(i.productType,i.demandSourceName)})),C(s.load,r))}function D(e,n){var r=function(){};if(v(l.notSet))m(l.inLoadingProcess),e(f,r,n);else if(v(l.loaded))m(l.notSet),e(f,void 0,n);else if(v(l.visible)||v(l.inShowingProcess))m(l.inLoadingProcess),e(f,r,n);else if(v(l.inLoadingProcess))o.report(u.bannerReloadDuringLoad,p.extendCallbackParamsWithDemandConfig(i));else{var a=t.Utils.extend(!0,{},f,{callfailreason:A(s.load),timingvalue:g.stop(i.productType,i.demandSourceName)});o.report(u.loadAdFailed,a),C(s.load)}}function P(e,n,r){if(S())m(l.inShowingProcess),e(f,n,r);else{var a=t.Utils.extend(!0,{callFailReason:A(s.show)},f);a=g.extendEventElapsedTime(i.productType,i.demandSourceName,a),o.report(u.showAdFail,a),C(s.show,r)}}function F(e,t){i.productType!==a.BN?O(e,t):T(e,t)}function O(e,r){var a=!!v(l.inLoadingProcess);if(m(l.loaded),a){var s=t.Utils.extend(!0,{},f,{timingvalue:g.stop(i.productType,i.demandSourceName)});s=g.extendEventElapsedTime(i.productType,i.demandSourceName,s),o.report(u.loadAdSuccess,s),g.clearStartTime(i.productType,i.demandSourceName),n.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(i,r)),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!0})])}}function T(e,r){(v(l.inLoadingProcess)||v(l.visible))&&(o.report(u.loadAdSuccess,{timingvalue:g.stop(i.productType,i.demandSourceName)}),o.trackTimingStart(u.bannerLoadSuccessToVisible),n.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(i,r)),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!0})])),m(l.loaded)}function x(e,t){y(e,t,u.loadAdFailed)}function N(){b()}function L(){b()}function U(){m(l.notSet)}function M(){m(l.visible)}var V={getAdState:h,load:I,show:P,cacheReady:F,noMoreOffers:x,failedToShow:N,failedToLoad:L,engageEnd:U,adVisible:M,resetAdState:b};return V}t.exports=i},{"./ProductAdapterConstants.js":185}],187:[function(e,t,n){t.exports=function(t,n,i){"use strict";var r,a=e("./AdapterSharedConfig"),o=e("./ProductAdapter"),s=[],d=!1;function l(e){return e&&"true"===e.rewarded?n.RewardedVideo:n.Interstitial}function c(){if(!n.RewardedVideo){var r=e("./AdapterSharedConfig"),a=e("./RewardedVideo/RewardedAdConfiguration")(t,r,n.SupplyConfigurations,i);n.RewardedVideo=new o(t,n,a,i),n.RewardedVideo.init()}return n.RewardedVideo}function u(){if(!n.NativeAd){const i=e("native-ads");n.NativeAd=i.apiFactory.createNativeAdApi({controller:n,core:t})}return n.NativeAd}function p(r){return r&&"true"===r.rewarded?c():function(){if(!n.Interstitial){var r=e("./InterstitialDemandSource/AdConfiguration")(t,a,n.SupplyConfigurations,i);n.Interstitial=new o(t,n,r,i),n.Interstitial.init()}return n.Interstitial}()}return{initModule:function(){!function(){if(r)return;s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.init,(function(e,t,i){n.log("productRouter | NativeAPI.init"),t=i=function(){},p(e).initProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.load,(function(e,t,i){n.isLegacy(n.featureMap.keepAlive)||n.callSDKFunction("stillAlive",{key:"loadAd"}),p(e).loadProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.show,(function(e,t,n){l(e).showProduct(e,t,n)}))),s.push(t.PubSub.subscribe(i.CB+".destroyInterstitial",(function(e,t,n){l(e).destroyProduct(e)}))),s.push(t.PubSub.subscribe(i.CB+".initRewardedVideo",(function(e,t,n){c().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")}))),s.push(t.PubSub.subscribe(i.CB+".showRewardedVideo",(function(e,t,n){c().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")}))),s.push(t.PubSub.subscribe(i.CB+".initBanner",(function(e,t,i){!e||e.inAppBidding||d||(d=!0,n.initBannerExternalService()),function(e){n.Banner||(n.Banner=n.BannerFactory.create(e),n.Banner.init());return n.Banner}(e).initProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+".loadBanner",(function(e,t,r){n.isLegacy(n.featureMap.keepAlive)||n.callSDKFunction("stillAlive",{key:"loadAd"}),e.productType=i.BN,n.Banner.loadProduct(e,t,r)}))),s.push(t.PubSub.subscribe(i.CB+".bannerViewVisible",(function(e,t,i){n.Banner.showProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+".destroyBanner",(function(e){e.productType=i.BN,n.Banner.destroyProduct(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.load",(function(e,t){u().load(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.register",(function(e){u().register(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.visibilityChanged",(function(e,t){u().visibilityChanged(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.click",(function(e,t){u().click(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.privacyClick",(function(e,t){u().privacyClick(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.destroy",(function(e,t){u().destroy(e)}))),r=!0}()},destroyListeners:function(){t.Utils.each(s,(function(e,n){t.PubSub.unsubscribe(n)})),r=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig":145,"./InterstitialDemandSource/AdConfiguration":182,"./ProductAdapter":183,"./RewardedVideo/RewardedAdConfiguration":188,"native-ads":22}],188:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.Utils.extend(!0,{},t.Features);return{NativeAPI:t.NativeAPI,ControllerCallbacks:t.ControllerCallbacks,AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,DemandName:"SupersonicAds",ProductName:i.RV,Features:r,gatewayDestinationMap:{prod:i.gatewayDestinationMap.RV.production},amountOfInventories:t.amountOfInventories}}},{}],189:[function(e,t,n){t.exports=function(e,t,n,i){var r=i.responseTypesWithReason,a={};function o(e){n.publishAvailabilityFalse("NoMoreOffers",e)}function s(e){t.log("Availability Manager | reportAdAvailable",t.LogLevels.verbose),n.isCurrentState(r.ready)||n.publishAvailabilityTrue(e)}return{setAMSettings:function(t,n){t&&"object"==typeof t&&(a=n?e.Utils.extend(a,t):t)},cacheAdsFailed:function(e,t,n,i){e&&t?i():o(n)},cacheTimeoutFail:function(e){o(e)},canReportAvailable:function(e,t){a.reportOnAdunitReady&&a.isPreCache&&0!==a.numOfBannersToInitSuccess||s({numOfAdUnits:e,totalNumberCredits:t})},adLoadError:function(){o("Ad loaded with error")},inventoryEmpty:function(e){o(e)},reportAdAvailable:s,reset:function(){n.setLastResponse(r.none),a={}},adLoadedSuccessfully:function(e,t){(t||(a.reportOnAdunitReady||a.preFetchAllVasts)&&a.isPreCache)&&s(e)}}}},{}],190:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=n.responseTypesWithReason,o=a.none,s=t.DemandUtils;function d(e){return o===e}function l(t,r){e.PubSub.publish(n.productType+"."+t,[s.extendCallbackParamsWithParentProductConfig(i,r)])}return{setLastResponse:function(e){o=e},getLastResponse:function(){return o},publishAvailabilityTrue:function(t){l("CacheReady",t=e.Utils.extend(t,{firstCampaignCredits:1})),o=a.ready},publishAvailabilityFalse:function(e,t){d(a.notReady)||"NoMoreOffers"===e&&(l(e,{numOfAdUnits:0,firstCampaignCredits:0,totalNumberCredits:0,errorMsg:t}),o=a.notReady)},isCurrentState:d}}},{}],191:[function(e,t,n){t.exports=function(e,t,n,i){var r,a=!1,o=!1,s=!1,d=!1;function l(e){return e&&e.productType===n.productType&&(!n.demandSourceName||e.demandSourceName===n.demandSourceName)}return{init:function(){a||(e.PubSub.subscribe(i.taskManager+".AdErrorState",(function(t){l(t)&&e.Utils.isDefined(t.error)&&(d=t.error)})),e.PubSub.subscribe(i.taskManager+".Engaged",(function(i){l(i)&&e.Utils.isDefined(i.duringEngage)&&(o=i.duringEngage,t.log("duringEngage "+o+" on demand "+n.demandSourceName,t.LogLevels.verbose))})),e.PubSub.subscribe(i.taskManager+".CacheUpdateStatus",(function(t){l(t)&&e.Utils.isDefined(t.duringCacheUpdate)&&(s=t.duringCacheUpdate)})),a=!0,r=t[n.productType].getProductTM())},canEngage:function(){return!o&&r.canEngage()},canPreload:function(){var e=!d&&r.isConnected();return n&&n.isInAppBidding||(e=e&&!o),e},canInitCallToApi:function(){return!o&&!s&&r.isConnected()?e.Utils.returnResolvedPromise():e.Utils.returnRejectedPromise()},setConnection:function(e){return r.setConnection(e)},getStatusMsg:function(){return" duringEngage:"+o+" duringCacheUpdate:"+s+" error state:"+d},getStatus:function(){return{duringEngage:o,duringCacheUpdate:s,adErrorState:d,isConnected:r.isConnected()}},publish:function(t,n){e.PubSub.publish(i.taskManager+"."+t,n)}}}},{}],192:[function(e,t,n){t.exports=function(t,n,i){var r=e("./configurationValidator.js")(n,i.DebugLevels,i.errors),a=function(){var e=!0;return n.each(t.mobileSDKSettings,(function(t,i){return t.match(/^deviceIds/)&&n.isDefined(i)&&i&&(e=!1),e})),e};return{parseConfiguration:function(e,t,o){var s,d=[],l=t.length;for(s=0;s<l;s++)n.isDefined(e[t[s]])||("applicationUserId"!==t[s]||a())&&d.push(t[s]);return d.length>0?{didSucceed:!1,errMsg:{errMsg:i.errors.missing+JSON.stringify(d)}}:r(e,o)},getDeviceApiLevel:function(){var e=t.mobileSDKSettings.deviceApiLevel;return"android"!==t.mobileSDKSettings.deviceOs||e?"ios"!==t.mobileSDKSettings.deviceOs||e||(e=t.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=t.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=t.mobileSDKSettings.deviceOSVersion;return"android"===t.mobileSDKSettings.deviceOs&&(e=t.mobileSDKSettings.deviceApiLevel?t.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":201}],193:[function(e,t,n){t.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270},omidStartSessionRequired:{name:"omidStartSessionRequired",id:364},omidStartSessionSuccess:{name:"omidStartSessionSuccess",id:365},omidFinishSessionRequired:{name:"omidFinishSessionRequired",id:366},omidFinishSessionSuccess:{name:"omidFinishSessionSuccess",id:367},removeContainerError:{name:"removeContainerError",id:190},linkActivationOnAd:{name:"linkActivationOnAd",id:324},auidFail:{name:"auidFail",id:197},patchOrientation:{name:"patchOrientation",id:343},initFailed:{name:"initFailed",id:344},setAdDisplayAlreadyAdShown:{name:"setAdDisplayAlreadyAdShown",id:350},adChangedOnClose:{name:"adChangedOnClose",id:345},controllerInitiated:{name:"controllerInitiated",id:103},foregroundClose:{name:"foregroundClose",id:601},appStoreRecognizedUnexpectedBehavior:{name:"appStoreRecognizedUnexpectedBehavior",id:346},appStoreDismissSuccess:{name:"appStoreDismissSuccess",id:340},appStoreDismissFail:{name:"appStoreDismissFail",id:341},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323},bannerLoadedNotVisible:{name:"bannerLoadedNotVisible",id:451},appOnForeground:{name:"appOnForeground",id:603},monitorCdn:{name:"monitorCdn",id:453},unhandledNativeException:{name:"unhandledNativeException",id:454},sendPOSTRequest:{name:"sendPOSTRequest",id:455},sendPOSTRequestThrowError:{name:"sendPOSTRequestThrowError",id:456},bgInfo:{name:"bgInfo",id:457},longUrlNonBiddingRequest:{name:"longUrlNonBiddingRequest",id:458}}}},{}],194:[function(e,t,n){t.exports=function(){var e={},t="loadTimer",n={};function i(e,t){return e&&t?e+"."+t:null}function r(e,t){var r=i(e,t);return n.hasOwnProperty(r)?{timeElapsed:Date.now()-n[r],columnName:"custom_c"}:{timeElapsed:Date.now(),columnName:"custom_d"}}return{start:function(n,r){var a=i(n,r);a&&(e.hasOwnProperty(a)?e[a][t]&&window.timerService.stopTimer(e[a][t]):e[a]={},e[a][t]=window.timerService.startTimer())},stop:function(n,r){var a=i(n,r);if(!(a&&e[a]&&e[a][t]))return-1;var o=e[a][t],s=window.timerService.stopTimer(o);return delete e[a][t],s},clear:function(t,n){var r=i(t,n);if(r&&e[r]){var a=e[r];for(var o in a)a.hasOwnProperty(o)&&window.timerService.stopTimer(a[o]);delete e[r]}},setStartTime:function(e,t,r){var a=i(e,t);!n.hasOwnProperty(a)&&r&&(n[a]=r)},getTimeElapsed:r,clearStartTime:function(e,t){var r=i(e,t);n.hasOwnProperty(r)&&delete n[r]},extendEventElapsedTime:function(e,t,n){var i=r(e,t);return n[i.columnName]=i.timeElapsed,n}}}},{}],195:[function(e,t,n){t.exports=function(e){var t="LoadedCreatives | ",n=e.AdUtils,i=[];function r(e){if(!e)return l("in _isExistAd without ad"),!1;var t=void 0!==d(n.getAdId(e),e);return l("_isExistAd | adId "+e.id+" | isExist "+t),t}function a(){return l("_size | size "+i.length),i.length}function o(e,t){return e.productType===t.productType&&(!t.demandSourceName||e.demandSourceName===t.demandSourceName)}function s(e,t){return function(i){return o(i,t)&&n.getAdId(i)==e}}function d(e,t){var n=s(e,t),r=i.filter(n);return r.length>0?r[0]:void 0}function l(n){e.log(t+n)}function c(){l("_printAll"),i.forEach((function(e){l("_printAll | adViewId "+e.adViewId)}))}return{isExistAd:r,addAd:function(e){return l("_addAd"),e?r(e)?(l("_addAd | ad already exist | adViewId "+e.adViewId),!1):(i.push(e),l("_addAd | added successfully | adViewId "+e.adViewId),!0):(l("_addAd | ad is undefined"),!1)},removeAdById:function(e,t){l("_isExistAd adId = "+e);var n=s(e,t),r=a();return c(),i=i.filter((function(e){return!n(e)})),c(),r!==a()},getAdById:d,getAds:function(e){return l("_getAds | productConfig "+e),i.filter((function(t){return o(t,e)}))},getAdsByProductType:function(e){return i.filter((function(t){return t.productType===e.productType}))},size:a,toArray:function(){return l("_toArray"),i.slice()},printAll:c,getAdByAdViewId:function(e){l("getAdByAdViewId | id "+e+"| loadedCreatives "+i);var t=i.filter((function(t){return t.adViewId===e}));return 0!==t.length?t[0]:null}}}},{}],196:[function(e,t,n){t.exports=function(t,n){var i=e("../DemandSource/DemandEntityBuilder.js"),r=t&&t.instancesMap,a=t&&t.waterfallMap;function o(e,t){var i=a&&a[n.sspProductNames[e]];if(i)return i[t]}return{createDemandEntityConfigObj:function(e){console.log("_createDemandEntityConfigObj",e);var t=function(e,t){var i=r&&r[n.sspProductNames[e]];if(i)for(var a=0;a<i.length;a++)if(-1!==i[a].instances.indexOf(t))return{demandGroupName:i[a].demandGroupName,isInstance:!0}}(e.productType,e.demandSourceName)||{},a=!0===t.isInstance?n.demandSourceType.instance:n.demandSourceType.demandSource,s={demandGroupName:t.demandGroupName,demandSourceName:e.demandSourceName,demandType:a,isInAppBidding:e.isInAppBidding,isOneFlow:e.isOneFlow,isMultipleAdObjects:!!e.isMultipleAdObjects,isLoadWithAdmFlow:e.isLoadWithAdmFlow,demandSourceId:e.demandSourceId,waterfallPosition:o(e.productType,e.demandSourceName),originalDemandSourceName:e.originalDemandSourceName,adSize:e.adSize,watermark:e.watermark};return new i({productType:e.productType},s)}}}},{"../DemandSource/DemandEntityBuilder.js":161}],197:[function(e,t,n){t.exports=function(e,t,n,i){var r="$$";return{handler:function(a){return!!function(e){return e&&"string"==typeof e.data&&e.data.length>0}(a)&&(function(e){return 0===e.data.indexOf(r)}(a)?function(i){var a=i.slice(r.length);if(!a)return!1;var o=n.getParams(a);return n.isDefined(o.event)?(t.log("received event: "+o.event,t.LogLevels.verbose),e.publish("SDKController."+o.event,[o]),!0):n.isDefined(o.name)&&n.isDefined(o.parameters)?(t.log("received event: "+o.name,t.LogLevels.verbose),e.publish("SDKController."+o.name,[o.parameters]),!0):void 0}(a.data):function(r){try{var a=JSON.parse(r);return a.arguments=n.extend(a.arguments,{callback:i(a.id)}),e.publish("SDKController."+a.method,[a.arguments]),!0}catch(e){t.log("SDKController | unable to parse message: "+JSON.stringify(r),t.LogLevels.error)}return!1}(a.data))}}}},{}],198:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e("./EventCategories")();t.exports=class{constructor(e,t){this.config=t,this.analytics=e}report(){if(!this.getControllerUrl().includes("networksdk.ssacdn"))return;const e=this.createGeneralMessage();this.analytics.report(i.monitorCdn,{generalMessage:e})}createGeneralMessage(){const e={controllerUrl:this.getControllerUrl()};return JSON.stringify(e)}getControllerUrl(){var e;return null!==(e=window.location.href)&&void 0!==e?e:""}}},{"./EventCategories":193}],199:[function(e,t,n){function i(t,n){var{DSSignals:i}=e("../../components/dssignals/DSSignals"),r=e("../../components/adInterfaces/AdInterfaceConfiguration"),a=e("../../components/adInterfaces/BaseFileRepository"),o=e("../../components/adInterfaces/CacheLocation"),s=window.jQuery,d="SDKController | ",l=e("../../patches/PatchAppOrientation"),c=e("./MessageHandler"),u=e("../../presenter/uiConfig.js"),p=e("../../components/Logger.js")(t.Utils),f=e("../AdUnitManager/AdUnitGlobals.js")(n),g=e("../AdPlayer/AdPlayerAssets"),v=e("../AdUnitManager/LibsManager.js")(t),m=e("../../components/DisplayedAdManager.js"),h=e("../AdUnitUrl.js")(f,t.Utils),b=new(e("../AdPlayer/AdPlayerUrl"))(t.Utils),S=e("./mainConfig.js")(),y=new(e("../../components/ExternalConfig"))(t.Utils),A=new(e("../../components/BlacklistService"))(n),C=new(e("../../components/FrameHelper.js"))(p),I=e("./ConfigurationHelper.js"),w=e("../../components/AdOrientationManager"),D=e("../../components/containers/WebViewManager.js"),P=e("../../components/containers/AdViewsManager.js"),F=e("../../components/containers/BannerExternalContainer.js"),O=e("./sessionConfig")(),T=e("../../components/NativeLifeCycleEventsConstants.js"),x=new(e("../../components/NotchFactory.js"))(n),N=e("../../components/token/TokenService.js"),L=e("../UserSegmentation/SegmentationManager"),U=e("../UserSegmentation/SegmentationAllocator.js"),M=e("../../components/NativeAPIAdapter.js"),V=e("../../constants/SDKFeatureNames"),E=new(e("../../patches/PatchCacheFileEncoding")),k,B,R,K,j,_,W,G,H,q,J,Q,$,z,X,Y,Z,ee,te,ne=!1,ie,re,ae=t.Utils,oe=t.JQWrapper,se=t.PubSub,de=null,le,ce=!1,ue=!0,pe=!1,fe=n.CB,ge=n.RV,ve=n.IS,me=n.BN,he=n.errors,be=n.videoStates,Se=n.closeButtonStates,ye=n.featureCompatibilityMap,Ae=n.confirmCloseMsg,Ce=n.requiredDeviceInfo,Ie=n.requiredAppInfo,we=n.optionalAppInfo,De={v:"3114",controllerbn:"3114",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,gpv:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,safeAreaInsets:null,ext:{},asel:null},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,skd:null},configMapping:{jb:function(){return De.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null,forceOrientationAfterStoreKitClose:null},userType:SuperSonicGlobalConfig.userType},Pe={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},Fe="mobileController.min.css",Oe="/versions/"+De.v+"/"+Fe,Te,xe,Ne,Le,Ue,Me,Ve,Ee=!1,ke=!1,Be=0,Re=3,Ke,je,_e,We={defaultBehavior:0,adunitResponsibility:1},Ge={close:1,nextFrame:2},He=n.defaultOrientation,qe={none:0,device:1,controller:2},Je=u.style.defaultControlFrames,Qe=n.blockedProductsPerApiLevel,$e=n.storeSearchKeys,ze={scrollHeight:""},Xe={RewardedVideo:{},Interstitial:{},Banner:We.defaultBehavior},Ye={RewardedVideo:{},Interstitial:{}},Ze={RewardedVideo:Se.close,Interstitial:Se.close},et={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},tt=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"}],nt,it,rt={},at=!1,ot,st="0",dt=u.templates.mainDefaultTemplate,lt=u.templates.defaultDialogBoxTemplate,ct=u.templates.defaultNavigationTemplate,ut=t.Analytics,pt=e("../../modules/SDKController/EventCategories")();let ft;var gt=function(e,t){var n=$.getDisplayedAdType(),i={productType:"UnKnown",action:"stopTiming",eventParam:{eName:pt.adClosed,data:{eNameStart:pt.adVisibleToClose,custom_d:ie.isEscapingUser()?1:0}}};if(t&&t.customData&&t.customData.click&&(i.eventParam.data=ae.extend(i.eventParam.data,t.customData.click)),t&&t.frameType&&(i.eventParam.data.frameType=t.frameType),e&&(i.eventParam.data.generalMessage=e),n){i.productType=n;var r=$.getDisplayedAdDemandName();r&&(i.demandSourceName=r);var a={productType:i.productType,demandSourceName:i.demandSourceName};t&&t.customData&&"object"==typeof t.customData&&(a=ae.extend(a,t.customData)),a.ad=$.get(),se.publish("SDKController.Analytics",[i]),se.publish("SDKController.adClosed",[a])}else se.publish("SDKController.Analytics",[i])},vt=function(e,t,n,i){var r,a=e.length,o=!0,s=[],d=null;for(r=0;r<a;r++)ae.isDefined(t[e[r]])||(s.push(e[r]),o=!1);return o||(d=he.missing+JSON.stringify(s)+" in "+n,ae.isDefined(i)&&i&&ie.callSDKFunction(i,{errMsg:d}),ie.log(d,ie.LogLevels.error)),{didSucceed:o,errMsg:d}},mt=function(){se.subscribe(fe+".initProducts",(function(e,t,n){s.when(Nt(e)).then((function(){"use strict";ae.isDefined(t)&&ie.callSDKFunction(t),Lt(e)}),(function(e){"use strict";ae.isDefined(n)&&ie.callSDKFunction(n,{errMsg:e})}))})),se.subscribe(fe+".nativeNavigationPressed",(function(){if($.isDisplayed()){var e=$.getDisplayedAdType(),t=$.getDisplayedAdDemandName();if(!pe){var n,i=$.get()||{};if((n=i.settings||{}).hasOwnProperty("disableBB")&&!n.disableBB)(t?Xe[e][t]:Xe[e])===We.adunitResponsibility?Wt({name:"backButtonPressed"}):on()}}})),se.subscribe(fe+".engageEnd",(function(e){if(!yt())if("forceClose"===e.action)gt(),Yt(!1,!1),X.onEngageEnd();else if("secondaryClose"===e.action){var t=$.getDisplayedAdType();q.returnFromNavigationMode(Vt,ze,t,kt)}})),se.subscribe(fe+".failedToStartStoreActivity",(function(e){if(e){ie.log("failedToStartStoreActivity | params: "+JSON.stringify(e),ie.LogLevels.info);var t={};t.rvnomoreoffersreason=decodeURIComponent(e.url),t.generalMessage=decodeURIComponent(e.errMsg);var n=$.getDisplayedAdType();n&&(t.productType=n),Le.report(pt.failedToStartStoreActivity,t)}})),se.subscribe(fe+".interceptedUrlToStore",(function(e){$.isDisplayed()&&Wt({name:"interceptedUrlToStore",intercept:!0})})),se.subscribe(fe+".pageFinished",(function(){Wt({name:"pageFinished"})})),se.subscribe(fe+".enterBackground",(function(e){if(ie.log("entered BG"),!$.getDisplayedAdType()){if(window.lastBGTimer)return;window.lastBGTimer=window.timerService.startTimer()}Mi(e,$.get()),wi()&&!$.isDisplayed()&&Le.report(pt.bgInfo,{generalMessage:st})})),se.subscribe(fe+".enterForeground",(function(e){var t=H.getContainerState();if(ie.log("entered FG | webview is "+JSON.stringify(t)),t.engaged&&t.opened&&De.mobileSDKSettings.deviceOs===n.deviceOs.android&&!t.standalone){let e=$.isDisplayed();Le.report(pt.foregroundClose,{integrationType:""+e})}Ui(e,$.get());var i=window.timerService.stopTimer(window.lastBGTimer);delete window.lastBGTimer;var r=Math.ceil(i/1e3);if(r>60&&Le.report(pt.appOnForeground,{custom_b:r,custom_c:i}),ie.SupplyConfigurations.getNetworkConfigValueByKey(n.backgroundPatchLogicConfiguration)||De.mobileSDKSettings.ext.backgroundPatchLogicConfiguration){ie.log("background patch logic - went to foreground, stopping timer");const e=window.timerService.stopTimer(window.backgroundPatchTimer);k.applyBackgroundCommunicationSolution(e)}})),se.subscribe(fe+".viewableChange",(function(e){var t={name:"viewableChange"};if(e&&ae.isDefined(e.isViewable)){var i=$.getDisplayedAdType();if("Banner"===i&&(e.changeReason===n.viewableChangeReasons.storeKitClose||e.changeReason===n.viewableChangeReasons.storeKitOpen))return void ie.log("viewableChange from Banner storeKit - ignored",ie.LogLevels.info);if((ie.SupplyConfigurations.getNetworkConfigValueByKey(n.backgroundPatchLogicConfiguration)||De.mobileSDKSettings.ext.backgroundPatchLogicConfiguration)&&(Ee&&!e.isViewable?(ie.log("background patch logic - went to background, starting timer"),window.backgroundPatchTimer=window.timerService.startTimer()):!Ee&&e.isViewable&&(ie.log("background patch logic - went to foreground through viewableChanged, stopping timer"),window.timerService.stopTimer(window.backgroundPatchTimer))),Ee=e.isViewable,ie.StoreKitService.isStoreKitVisible()&&(Wt({name:"viewableChangeInSK",isViewable:Ee}),Ee))return;ie.SKOverlayManager.isSKOverlayVisible()&&Wt({name:"viewableChangeInOV",isViewable:Ee}),ie.log("viewableChange to:"+e.isViewable),ae.isDefined(e.webview)&&"main"!==e.webview||H.setContainerVisibility(e.isViewable),t.isViewable=e.isViewable,$.isDisplayed()&&tn(),ae.isDefined(e.webview)&&(t.webview=e.webview),i&&(t.productType=i),e.changeReason&&(t.changeReason=e.changeReason)}Wt(t),e&&ae.isDefined(e.isViewable)&&H.triggerRedraw()})),se.subscribe(fe+".deviceStatusChanged",(function(e){var t=ae.extend({name:"deviceStatusChanged"},e);Wt(t),ae.isDefined(e.connectionType)&&(ut.updateBaseData({connectionType:e.connectionType}),ue="none"!==e.connectionType&&"notReachable"!==e.connectionType),ae.isDefined(e.rawConnectionType)&&ut.updateBaseData({rawConnectionType:e.rawConnectionType}),ae.isDefined(e.rawConnectionType)&&ut.updateBaseData({rawConnectionType:e.rawConnectionType})})),se.subscribe(fe+".parseBandwidth",(function(e){ie.log(JSON.stringify(e),3)})),se.subscribe(fe+".getBandwidthFailed",(function(e){ie.log(JSON.stringify(e),3),ie.log("getBandwidth Failed",ie.LogLevels.error)})),se.subscribe("SDKController.GetConfig",(function(e){e&&e.productType&&se.publish(e.productType+".GetConfig",[e])})),se.subscribe("SDKController.GetCompletionOffers",(function(e){e&&e.productType&&se.publish(e.productType+".GetCompletionOffers",[e])})),se.subscribe("SDKController.ActionClick",(function(e){e&&e.productType&&se.publish(e.productType+".ActionClick",[e])})),se.subscribe("SDKController.OpenUrl",(function(e){vt(["url","method"],e,"openUrl").didSucceed?(ie.log("Request to open external url",ie.LogLevels.info),Et(e)):ie.log("error calling open url with "+JSON.stringify(e),ie.LogLevels.error)})),se.subscribe("SDKController.nativePixel",(function(e){vt(["url"],e,"nativePixel").didSucceed?(ie.log("Request to send click in native api",ie.LogLevels.info),oi(e.url)):ie.log("error sending safe click "+JSON.stringify(e),ie.LogLevels.error)})),se.subscribe("SDKController.FirePixel",(function(e){vt(["url"],e,"FirePixel").didSucceed?(ie.log("Request to fire pixel from controller",ie.LogLevels.info),"native"===e.type&&oi(e.url)||si(e)):ie.log("error firing pixel "+JSON.stringify(e),ie.LogLevels.error)})),se.subscribe("SDKController.adEventNotification",(function(e){ie.log("ad notified controller with event: "+JSON.stringify(e),ie.LogLevels.info),vt(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&ci(e.eventName,e.productType,e.dsName,e.extData)})),se.subscribe("SDKController.hideClose",(function(e){var t=le.getAdById(ie.AdUtils.getAdId(e),e);if(t){var n=H.getAdViewByAd(t);n.dataset.close="false",H.isViewDisplayed(n,t)&&Ut()}else ie.log("line[1196]: ERROR",ie.LogLevels.error)})),se.subscribe("SDKController.AdClose",(function(e){e.ignoreClick?ln():on(e)})),se.subscribe("SDKController.closeAdunit",(function(e){gt(),Yt(!1)})),se.subscribe("SDKController.setBackButtonState",(function(e){if(e&&e.state&&e.productType){var t="default"===e.state?We.defaultBehavior:We[e.state];e.demandSourceName?Xe[e.productType][e.demandSourceName]=t:Xe[e.productType]=t}})),se.subscribe("SDKController.setCloseButtonState",(function(e){Qn(e)})),se.subscribe("SDKController.ScrollHeight",(function(e){var t,i,r;ae.isDefined(e.value)&&(t=e.value,ie.log("scroll height is: "+t,ie.LogLevels.info),s.when(sn()).then((function(e){r=$.getDisplayedAdType(),i=r&&"application"===He[r]&&W.isAppOrientation("portrait")?Math.max(e.height,e.width):r&&ae.isDefined(r)&&"application"===He[r]&&W.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,t<i&&(t=i),ie.log("min scroll height is: "+i+"scroll height was set to: "+t+" screen height: "+e.height,ie.LogLevels.verbose),ze.scrollHeight=t,De.mobileSDKSettings.deviceOs!==n.deviceOs.android&&(document.body.style.height=ze.scrollHeight)})))})),se.subscribe("SDKController.scrollTop",(function(){ie.log("scrollTop",ie.LogLevels.verbose),setTimeout((function(){ie.JQWrapper.scrollTop(document,0),ie.JQWrapper.scrollTop(document.body,0)}),1e3)})),se.subscribe("SDKController.getScreenSize",(function(){s.when(sn()).then((function(e){Wt({name:"screenSize",width:e.width,height:e.height,orientation:e.orientation,scrollTop:e.scrollTop})}))})),se.subscribe("SDKController.GetDeviceVolume",(function(e){ae.isDefined(e.callback)&&_n(e.callback)})),se.subscribe(T.serviceCallback+"."+T.AndroidEvents.onDestroy,(function(e){ie.log("SDKController | received event | onDestroy",ie.LogLevels.verbose),yt()?ie.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),ie.LogLevels.verbose):At()})),se.subscribe(n.CB+".unauthorizedMessage",(function(e){Le.report(pt.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),ie.log("SDKController | Failed to authorize message",ie.LogLevels.error)})),se.subscribe(n.CB+".unhandledNativeException",(function(e){Le.report(pt.unhandledNativeException,{generalMessage:JSON.stringify(e)}),ie.log("SDKController | unhandledNativeException"+JSON.stringify(e),ie.LogLevels.error)})),se.subscribe(n.CB+".linkActivationOnAd",(function(e){e&&e.url&&Le.report(pt.linkActivationOnAd,{generalMessage:e.url})})),se.subscribe("SDKController.onOmidStartSessionRequired",(function(e){Le.report(pt.omidStartSessionRequired,{generalMessage:e})})),se.subscribe("SDKController.onOmidStartSessionSuccess",(function(e){Le.report(pt.omidStartSessionSuccess,{generalMessage:e})})),se.subscribe("SDKController.onOmidFinishSessionRequired",(function(e){Le.report(pt.omidFinishSessionRequired,{generalMessage:e})})),se.subscribe("SDKController.onOmidFinishSessionSuccess",(function(e){Le.report(pt.omidFinishSessionSuccess,{generalMessage:e})})),se.subscribe("SDKController.onOmidServiceFailure",(function(e){Le.report(pt.omidServiceFailure,{generalMessage:e})})),se.subscribe("SDKController.removeContainerError",(function(e){e&&e.errMsg&&Le.report(pt.removeContainerError,{callFailReason:e.errMsg})})),se.subscribe("Cache.executeRetryFileUrlEmpty",(function(e){ht(e)}))};function ht(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),Le.report(pt.executeRetryFileUrlEmpty,t)}function bt(){ee=e("./videoStateHandler.js")(t.PubSub,ie),te=e("./nativeConfigHandler.js")(t.PubSub,ie)}function St(){var e={protocol:De.mobileSDKSettings.protocol?De.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};Le=ut.createAnalytic(e)}function yt(){var e=Xn($.get());return!e||!ae.isFunction(e.shouldAvoidHandleFrameClose)||e.shouldAvoidHandleFrameClose()}function At(){ie.log("SDKController.js | handleFrameDestroyed",ie.LogLevels.verbose),$.isDisplayed()&&gt(n.adClosedErrorReason.unexpectedCloseActivityDestroy),Yt(!1,!1),un()}var Ct=function(){document.body.insertAdjacentHTML("beforeend",dt+lt+ct),fn()};function It(){se.subscribe(fe+".acknowledgeMessage",(function(e){K.acknowledgeMessage(e)}))}function wt(i){var r=new c(t.PubSub,ie,ae,En);t.Msg.init(ie,r.handler,!0),se.init();var a=e("../SDKInterface.js");xe=new a(De.mobileSDKSettings,n,ie,i),K=new M(ie,t,xe),It()}function Dt(){p.init(De.mobileSDKSettings.deviceOs,xe,De.mobileSDKSettings.debug,ie.TrackingService.firePixel),se.subscribe("SDKController.log",(function(e){ae.isDefined(e.debugLevel)&&ae.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),ie.log(e.msg,e.debugLevel,e.origin))}))}var Pt=function(){v.init(p,ie.Cache),f.init(p,De.mobileSDKSettings,ie.Cache,mn(),h,v,ie.getEnv(),t,pt),Y=new g(n.adPlayerDirectory,De.mobileSDKSettings,ie.getEnv(),b,ie.Cache,mn(),t,s),A.init(p),$=new m(ie,Le,pt,n),ie.ProductRouter=e("../ProductRouter.js")(t,ie,n),ie.ProductRouter.initModule(),E.init(Di()),k=e("../DemandSource/FetchDemand/FetcherPatch.js")(t,ie,void 0,Le,n)};function Ft(){ie.HTTPService.init(),ie.OrientationService.init(Le),ie.GDPRService.init(),xt()&&ie.RingerSwitchService.init(),ie.NativeLifeCycleEventsService.init(),In();var i=e("../../components/containers/WebView"),r=e("../../components/containers/BackgroundController"),a=e("../../components/containers/NavigationModeView"),o=e("../../components/IframeManager"),s=e("../../components/containers/BannerExternalAdViewService");let d=e("../../modules/Bidding/BiddingLimitations");var l=new r(ie,n,u),c=e("../../components/containers/WPADUtils")(ie),p=new i(t,ie,u.style.forceCloseProperties,n,l,_),f=new o(ie,n,C,$),g=new D(t,ie,n,$,Le,pt);H=new P(ie,f,g,p,$),q=new a(ie,H,p),Q=new s(t,ie,n,$),J=new F(t,ie,Q,c.generateBannerAdViewId()),z=new N(t,ie,n,Le,pt),ie.AppUserIdService.init(Le),(B=new L(t,ie)).init(),R=new U(B),ie.AndroidNomediaFileHandler.init(Le),ie.DeviceDataService.init(Le),Z=window.SuperSonicGlobalConfig.controllerConfig.networkConfig;new(e("../../modules/SDKController/MonitorCdn"))(Le,Z).report(),ft=d(ie.getConfig().controllerConfig,z,Le),Ot()}function Ot(){ie.LocalStorageService.get(n.localStorageKeys.idfi).then((function(e){e&&(ot=e,ie.getTokenService().updateToken({idfi:ot}),t.Analytics.updateBaseData({idfi:ot}))}))}function Tt(){return ot}function xt(){return De.mobileSDKSettings.deviceOs===n.deviceOs.ios&&"wk"===De.mobileSDKSettings.webviewType}var Nt=function(e){var t=new s.Deferred;ie.log("Products info received: "+JSON.stringify(e),ie.LogLevels.info);var n,i,r,a=we.length,o=[];for(n=0;n<a;n++)ae.isDefined(e[we[n]])||(De.applicationSettings[we[n]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&o.push(i);return hn(o),(r=G.parseConfiguration(e,Ie,De.applicationSettings)).didSucceed?t.resolve():t.reject(r.errMsg),t.promise()},Lt=function(e){ae.each(e.products,(function(e,n){t.hasOwnProperty(n)&&ae.isFunction(t[n].init)&&t[n].init()}))},Ut=function(){Ne.classList.add("ssaOnAdUnitCloseVisible")},Mt=function(){Ne.classList.remove("ssaOnAdUnitCloseVisible")},Vt=function(e,t,n){if(Xt()&&Wt({name:"dialogBoxAboutToClose",shouldResume:e}),!t||!Xt()){if(document.getElementById("ssaDialogBox").style.visibility="hidden",document.getElementById("ssaDialogBoxOverlay").style.display="none",ae.isFunction(n))return void n.call();C.getDisplayedAdFrame()&&Wt({name:"showFrame"})}ie.JQWrapper.fadeOut(Ue,100,(function(){document.getElementById("ssaDialogBox").style.visibility="hidden",ie.JQWrapper.fadeOut(document.getElementById("ssaDialogBoxOverlay"),100,(function(){ae.isFunction(n)?n.call():C.getDisplayedAdFrame()&&Wt({name:"showFrame"})}))}))},Et=function(e,t){var i,r=[],a=null,o=null;function s(){var e=$.getDisplayedAdType();$.isDisplayed()&&se.publish("SDKController.AdOpened",[{productType:e}]),t&&t.call(null)}if(o=se.subscribe(fe+".openUrlFailure",(function(t){clearTimeout(i),se.clearHandlers(r),se.unsubscribe(o);var n=t&&t.errMsg?t.errMsg:"Unknown reason for error",a=$.getDisplayedAdType(),s=$.getDisplayedAdStoreId();Le.report(pt.openUrlError,{generalMessage:n,productType:a,storeId:s,custom_a:e.method}),ie.log("SDK failed to open url",ie.LogLevels.verbose)})),a=wi()&&"webview"===e.method?se.subscribe(fe+".openUrlSuccess",(function(){if(clearTimeout(i),se.clearHandlers(r),e.controls){var t=$.getDisplayedAdType();q.changeToNavigationMode(Vt,Ne,ze,t,kt)}s()})):se.subscribe(fe+".viewableChange",(function(e){clearTimeout(i),se.clearHandlers(r),!ae.isDefined(e.isViewable)||e.isViewable||De.mobileSDKSettings.deviceOs===n.deviceOs.android&&"main"!==e.webview||s()})),r.push(o),r.push(a),"storeKit"===e.method&&(De.mobileSDKSettings.deviceOs!==n.deviceOs.ios||ie.isLegacy({ios:"5.17",android:"99"})?e.method="external_browser":e.method="store"),"store"===e.method&&wi()){var d=$.getDisplayedAdType(),l=$.getDisplayedAdDemandName(),c={adProductType:d,adDemandSourceName:l},u=ie.StoreKitService.getStoreObject(e.viewUniqueId,c);if(!ie.StoreKitService.canPresentStoreKitObj(u)){var p={message:"SDKController try to load twice storeKit. viewUniqueId = "+e.viewUniqueId,productType:d,demandSourceName:l};return void se.publish("StoreKit.storeKitCoolDown",[p])}ie.StoreKitService.setStoreKitObjectPresentingProgress(u)}"webview"===e.method&&e.controls?De.mobileSDKSettings.deviceOs===n.deviceOs.android?ie.callSDKFunction("openUrl",{url:e.url,method:"webview"},"openUrlSuccess","openUrlFailure"):ie.callSDKFunction("openUrl",{url:e.url,method:e.method,controlFrames:Je},"openUrlSuccess","openUrlFailure"):ie.callSDKFunction("openUrl",{url:e.url,method:e.method,appId:e.appId,viewUniqueId:e.viewUniqueId,package_name:e.package_name,app_context:e.app_context},"openUrlSuccess","openUrlFailure"),i=setTimeout((function(){se.unsubscribe(a),"ios"===ie.getApiData({deviceOs:1}).deviceOs&&parseFloat(ie.getConfigurationHelper().getDeviceOsVersion())<8&&t&&t.call(null)}),500)},kt=function(){ie.JQWrapper.bind(Ne,"touchend",on),Bt(Ge.close),ie.JQWrapper.bind(Ve,"click",(function(e){e.stopPropagation(),e.preventDefault(),se.publish("SDKController.dialogBoxResume",[$.get()]),Vt(!0,!0)}))},Bt=function(e){ie.JQWrapper.bind(Me,"click",(function(t){t.stopPropagation(),t.preventDefault();var n=ue?e:Ge.close;switch(se.publish("SDKController.dialogBoxExit",[$.get()]),n){case Ge.nextFrame:Wt({name:"moveToNextFrame"}),Vt(!1,!0);break;case Ge.close:$.isDisplayed()?(Wt({name:"confirmCloseClicked"}),Vt(!1,!0)):Yt(!0)}}))};function Rt(e){ie.log(d+"broadcastMessageToAllAdViews"),J.checkStatusOfAdView().then((function(t){t&&t.isExternalAdViewInitiated&&J.sendMessageToExternalAdView(e)})),H.sendMessageToAllAdViews(e)}function Kt(){if(ie.log("getRecoveryInfo",ie.LogLevels.verbose),!rt||!rt.recoveryInfo)return"-1";var e=rt.recoveryInfo;return(e.isRecovered?"1":"0")+"-"+(e.trialNumber?e.trialNumber:"0")+"-"+(e.maxAllowedTrials?e.maxAllowedTrials:"0")}function jt(e){return e===n.BN&&!ie.isBannerMultipleInstances(e)}function _t(e,t){if(t)return t.settings.viewType===n.viewTypes.externalView&&jt(t.productType)?void J.sendMessageToExternalAdView(e):(ie.log("sendMessageToAdView | posting message to adView"),void H.sendMessageToAdView(e,t));var i="";try{i=JSON.stringify(e)}catch(e){}ie.log("sendMessageToAdView | the ad is missing. "+i)}var Wt=function(e,t){if("string"==typeof e)throw new Error("postAdUnitEvent message type not supported "+typeof e);if(ie.log(d+"postAdUnitEvent | before posting to ad unit"+JSON.stringify(e)),t)return Rt(e);_t(e,$.get())};function Gt(){var e=$.getDisplayedAdType(),t=$.getDisplayedAdDemandName();ie.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+t,ie.LogLevels.verbose),e&&(t?(Ye[e][t]=Se.close,Xe[e][t]=We.defaultBehavior):(Ye[e]=Se.close,Xe[e]=We.defaultBehavior))}function Ht(e){var t=document.getElementById("ssaDialogBox");t.classList.forEach((function(e){e!==n.styleAccordingToProtocol.secured&&e!==n.styleAccordingToProtocol.unsecured||t.classList.remove(e),e.match(/template.*/)&&t.classList.remove(e)}));var i=De.mobileSDKSettings.protocol===n.protocol.https?n.styleAccordingToProtocol.secured:n.styleAccordingToProtocol.unsecured;t.classList.add(i),e.settings.templateid&&t.classList.add("template"+e.settings.templateid)}function qt(e){e?Mt():Ut()}function Jt(e){var t;t=e&&e.productType===n.BN?e:$.get(),zt(t)}var Qt=function(e,t){var n=s.Deferred();return ie.log("SDKController | onAdUnitOpen"),Bt(Ge.close),H.displayContainer(e),s.when(dn(e)).then((function(){cn(),Ht(e),H.handleScreenVisible(t,e),n.resolve()})).fail((function(e){n.reject(e)})),n.promise()};function $t(e){e&&(ie.ImpressionsCounterService.increaseImpressionsCounterByInstanceParams(e),z.updateToken(ie.ImpressionsCounterService.getTokenCounters()))}var zt=function(e){var t=e?e.productType:null;try{clearTimeout(Ke),e?(e.onAdVisibleFlag=!0,nn()):ie.log("_shouldReceiveMessage"),e&&e.settings&&ie.LastSeenCampaignService.setLastDisplayedAdCampaignId(e.cid,t,e.settings),$t(e),e.showAdCallbacks&&e.showAdCallbacks.onShowSuccess(),ie.log("SDKController | onAdVisible"),ie.SKOverlayManager.init(),se.publish("SDKController.AdVisible",[e]),_t({name:"adVisible",productType:t},e)}catch(t){throw ie.log("SDKController | onAdVisible | Exception"),e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(n.errors.showAdFailedReasons.onAdVisibleFailed+": "+JSON.stringify(t)),t}};function Xt(){return ae.isVisible(Ue)}var Yt=function(e,t){ie.RingerSwitchService.isInitiated()&&ie.RingerSwitchService.stopListener(),ze.scrollHeight="",document.body.style.height=ze.scrollHeight;var n=function(){Zt(t)};Xt()?Vt(!1,e,n):n()};function Zt(e){var t=function(){},n=$.get();if($.reset(),e&&H.displayLoader(n.productType),ie.callSDKFunction("setBackButtonState",{state:qe.controller}),e?Mt():t=en.bind(this,n),n)return n.engaged=!0,void On(n,{preloadNextInBG:!e},t);H.unloadProductFromContainer(),t()}var en=function(e){ie.log("SDKController | ad unit close done",ie.LogLevels.verbose),e&&e.isWPAD?(ie.log("SDKController | ad unit close done wpad",ie.LogLevels.verbose),H.hideContainer(e)):(setTimeout((function(){ie.log("SDKController | closing webview with currentAd "+JSON.stringify(e),ie.LogLevels.verbose),H.hideContainer(e)}),250),e&&e.settings&&e.settings.setContainerBGColorBlack&&H.setContainerBGColorTransparent())},tn=function(){if(!pe){var e,t=$.get(),i=$.getDisplayedAdType(),r=$.getDisplayedAdDemandName(),a=($.getDisplayedAdSettings(),{eventParam:{eName:pt.userClosedBeforeAdVisible},action:"startTiming",productType:i,demandSourceName:r});se.publish("SDKController.Analytics",[a]),t&&t.isScreenVisibleTimedOut||(e=n.closeAndBackDisabledTimer,rn(),pe=!0,Ke=setTimeout((function(){nn()}),e))}},nn=function(){an(),pe=!1},rn=function(){document.getElementById("ssaNavigatorCloseButton").classList.add("invisible")},an=function(){document.getElementById("ssaNavigatorCloseButton").classList.remove("invisible")},on=function(e){H.hideLoader(),ln();var t=$.get(),i=$.getDisplayedAdType(),r=$.getDisplayedAdDemandName();if(!i)return gt(null,e),void Yt(!1);var a=pn(i);switch(!t||t.onAdVisibleFlag||pe||(!function(e,t,i){je&&(clearTimeout(je),se.unsubscribe(_e),e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(n.errors.showAdFailedReasons.userClosedBeforeAdVisible));var r={eventParam:{eName:pt.userClosedBeforeAdVisible},action:"fireEvent",productType:t,demandSourceName:i};se.publish("SDKController.Analytics",[r])}(t,i,r),e&&"touchend"===e.type&&(a=Se.close)),a){case Se.close:ie.ViewsManager.waitForAllViews().then((function(){un(),gt(null,e),Yt(!1)}));break;case Se.confirm:Bt(Ge.close),ie.alert(ie.adUtils.getConfirmCloseMsg(t));break;case Se.confirmNextFrame:Bt(Ge.nextFrame),ie.alert(ie.adUtils.getConfirmCloseMsg(t));break;case Se.nextFrame:Wt({name:"moveToNextFrame"});case Se.ignore:}},sn=function(){var e="deviceScreenSize[width]",t="deviceScreenSize[height]",i=n.appInfo.orientation.portrait,r=n.appInfo.orientation.landscape,a=n.defaultOrientation,o=De.mobileSDKSettings[e],d=De.mobileSDKSettings[e],l=new s.Deferred;return s.when(ie.OrientationService.oldGetOrientation()).then((function(s){var c=$.getDisplayedAdType();!c||a[c]!==r&&a[c]!==i||(s=a[c]),s===r&&(o=Math.max(De.mobileSDKSettings[e],De.mobileSDKSettings[t]),d=Math.min(De.mobileSDKSettings[e],De.mobileSDKSettings[t])),s===i&&(o=Math.min(De.mobileSDKSettings[e],De.mobileSDKSettings[t]),d=Math.max(De.mobileSDKSettings[e],De.mobileSDKSettings[t])),De.mobileSDKSettings.deviceOs===n.deviceOs.android&&(o/=De.mobileSDKSettings.deviceScreenScale,d/=De.mobileSDKSettings.deviceScreenScale),l.resolve({width:o,height:d,orientation:s,scrollTop:ie.JQWrapper.scrollTop(window)})})),l.promise()},dn=function(e){var t=new s.Deferred;if(Ee)return t.resolve();return!e||e.productType!==n.RV&&e.productType!==n.IS||($.set(e),je=setTimeout((function(){Mt(),e.isScreenVisibleTimedOut=!0,se.unsubscribe(_e),t.reject(n.errors.showAdFailedReasons.screenVisibleTimeout)}),e&&e.settings&&e.settings.screenVisibleTimeout||12e3)),_e=se.subscribe(fe+".viewableChange",(function(e){e&&ae.isDefined(e.isViewable)&&e.isViewable&&(ie.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,ie.LogLevels.info),clearTimeout(je),se.unsubscribe(_e),t.resolve())})),t.promise()},ln=function(){ie.callSDKFunction("removeCloseEventHandler",ie.ViewsManager.getDisplayWebViewParams(!1))};function cn(){ie.NativeLifeCycleEventsService.startNotify(T.AndroidEvents.onDestroy)}function un(){ie.NativeLifeCycleEventsService.stopNotify(T.AndroidEvents.onDestroy)}function pn(e){var t=$.getDisplayedAdDemandName();if(e)return(t?Ye[e][t]:Ye[e])||Ze[e]}var fn=function(){Ne=document.getElementById("ssaNavigatorCloseButton"),Ue=document.getElementById("ssaDialogBox"),Me=document.getElementById("ssaDialogConfirmBtn"),Ve=document.getElementById("ssaDialogCancelBtn"),Te=document.getElementById("ssaViewWrap"),kt()},gn=function(e){ie.log(e,ie.LogLevels.error)},vn=function(e){var t,n={};return ae.isString(e)?(t=e.split(/\?(.+)/),n.name=t[0],n.parameters=e.split(/parameters=(.+)/)[1],n):null},mn=function(){return De.mobileSDKSettings.deviceOs===n.deviceOs.android?"supersonicads":"SSAPublisher"},hn=function(e){ae.each(De.applicationSettings,(function(t){t.match(/^custom/)&&-1===e.indexOf(t)&&delete De.applicationSettings[t]}))},bn=function(){var e={};return ae.each(De.applicationSettings,(function(t){t.match(/^custom/)&&(e[t]=De.applicationSettings[t])})),e},Sn=function(e){var t=De.mobileSDKSettings.protocol+"//"+De.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",n=new Image,i={},r={logType:"",count:1,applicationKey:De.applicationSettings.applicationKey,applicationUserId:De.applicationSettings.applicationUserId,SDKVersion:De.mobileSDKSettings.SDKVersion,deviceOs:De.mobileSDKSettings.deviceOs,deviceOSVersion:De.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=ae.extend({"deviceIds[OpenUDID]":De.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":De.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":De.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":De.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":De.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":De.mobileSDKSettings["deviceIds[IMEI]"]},r,e),ae.each(e,(function(e,t){ae.isDefined(r[e])||(i[e]=t)})),ae.isEmptyObject(i)||(e.customQueryString+=ae.serialize(i)),n.src=ae.renderTemplate(t,e)},yn=function(){var e=De.mobileSDKSettings;if(e.deviceScreenScale)try{var t=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==n.deviceOs.ios?e.deviceScreenScale:1),i=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==n.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(i),e.deviceWidthDP=parseInt(t)}catch(e){ie.log("SDKController | Failed to parse screen DP",ie.LogLevels.error)}},An=function(){var e=new s.Deferred,t=!1,n=De.mobileSDKSettings;return Ai()?(e.resolve(),e.promise()):(ie.CampaignsFilter.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then((function(i){ae.each(i,(function(e,n){n.isInstalled&&(t=!0)})),n.gpi=t,e.resolve()}),(function(){n.gpi=t,e.reject("Unable to check if Google play services is installed on the device")})),e.promise())},Cn=function(){var e,t,n,i=[],r=new s.Deferred;return e=se.subscribe(fe+".parseDeviceStatus",(function(e,t){ae.isDefined(e.rawConnectionType)&&ut.updateBaseData({rawConnectionType:e.rawConnectionType}),se.clearHandlers(i),ie.log(d+"parseDeviceStatus received"),ie.log(d+"gpv received before parsing: "+e.gpv);var a=l(e.appOrientation);a.patch&&(Le.report(pt.patchOrientation,{generalMessage:decodeURIComponent(e.appOrientation)}),e.appOrientation=a.appOrientation),n=G.parseConfiguration(e,Ce,De.mobileSDKSettings),ie.log(d+"gpv received after parsing: "+De.mobileSDKSettings.gpv),n.didSucceed?(ie.callSDKFunction(t),W.init(De.controllerConfig.appOrientation,De.mobileSDKSettings),De.mobileSDKSettings.appOrientation=W.getOrientation(),De.mobileSDKSettings.displaySizeWidth=De.mobileSDKSettings["deviceScreenSize[width]"],De.mobileSDKSettings.displaySizeHeight=De.mobileSDKSettings["deviceScreenSize[height]"],yn(),X=x.create(De.mobileSDKSettings),ie.AdvertisingIdService.decideOnAdvertisingId(De.mobileSDKSettings,De.controllerConfig),r.resolve()):r.reject(n.errMsg)})),i.push(e),t=se.subscribe(fe+".getDeviceStatusFailed",(function(e){se.clearHandlers(i),gn(e),r.reject(he.device)})),i.push(t),ie.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),r.promise()},In=function(){De.mobileSDKSettings.deviceOs!==n.deviceOs.ios&&ie.callSDKFunction("setStoreSearchKeys",{searchKeys:$e[De.mobileSDKSettings.deviceOs]})},wn=function(e){return ae.isDefined(De[e])&&null!==De[e]||ae.isDefined(De.applicationSettings[e])&&null!==De.applicationSettings[e]||ae.isDefined(De.mobileSDKSettings[e])&&null!==De.mobileSDKSettings[e]||ae.isDefined(De.controllerConfig[e])&&null!==De.controllerConfig[e]||ae.isDefined(De.configMapping[e])&&null!==De.configMapping[e]()},Dn=function(e){return ae.isDefined(Pe[e])},Pn=function(e){var t;return ae.isDefined(De[e])?t=De[e]:ae.isDefined(De.applicationSettings[e])?t=De.applicationSettings[e]:ae.isDefined(De.mobileSDKSettings[e])?t=De.mobileSDKSettings[e]:ae.isDefined(De.controllerConfig[e])?t=De.controllerConfig[e]:ae.isDefined(De.configMapping[e])?t=De.configMapping[e]():"customParam"===e&&(t=bn()),t},Fn=function(){var e,t,i=[],r=new s.Deferred;return e=se.subscribe(fe+".parseCachedFilesMap",(function(e,t){var i,a,o,s={};(o=vt(["path"],e,"parseCachedFileMap")).didSucceed?(i=decodeURIComponent(e.path).split("/"),""!==e.path?s[a=i[i.length-1]]=ae.isDefined(e[a])?e[a]:e:s=e,ie.log("SDKController | successfully received files map:"+JSON.stringify(e),ie.LogLevels.info),delete e.path,Vn(s).then((function(e){ie.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(re.cachePriorityArray),ie.LogLevels.verbose),ie.log("SDKController | The file map after:"+JSON.stringify(e),ie.LogLevels.verbose);var t=ie.Cache.init(e,re.cachePriorityArray),i=ie.SupplyConfigurations.getNetworkConfigValueByKey(n.cacheConfiguration)||n.defaultCacheConfig;return ie.AdsAssetsManager.init(ie.Cache,i),t})).then((function(){ie.log("SDKController | Cache module initiated",ie.LogLevels.info),ie.callSDKFunction(t),r.resolve()})).fail((function(e){e="SDKController | Cache module failed to initiated",ie.log(e,ie.LogLevels.error),r.reject(e)}))):r.reject(o.errMsg)})),i.push(e),t=se.subscribe(fe+".getCachedFilesMapFailed",(function(e){ie.log("SDKController | failed to receive files map:"+e,ie.LogLevels.error),r.reject(he.filemap)})),i.push(t),ie.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),r.promise()},On=function(e,n,i){n=n||{preloadNextInBG:!0},H.unloadAdView(e),le.removeAdById(ie.AdUtils.getAdId(e),e);var r=Xn(e),a=!1;r&&ae.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(e).then((function(){a=r.getNextAd(!n.preloadNextInBG,e.inventoryId)})),ie.log("engageEnd on controller with :"+e.engaged,ie.LogLevels.verbose),t.PubSub.publish("SDKController.engageEnd",[e,function(){e.engaged&&H.unloadProductFromContainer(e);var t=!n.preloadNextInBG;r&&ae.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(t,e.inventoryId),i&&i(),ee.getState()===be.play&&ee.handleOnEngageEnd(e)}])},Tn=function(){var e=qe.controller;return De.mobileSDKSettings.deviceOs===n.deviceOs.android&&10==G.getDeviceApiLevel()&&(e=qe.device),e},xn=function(e){return Nn(e),Ln(e),e&&e.applicationKey&&(De.applicationSettings.applicationKey=e.applicationKey),G.parseConfiguration(e,Ie,De.applicationSettings)},Nn=function(e){var t,n=we.length;for(t=0;t<n;t++)ae.isDefined(e[we[t]])||(De.applicationSettings[we[t]]=null)},Ln=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&t.match(/^custom/)&&n.push(t);hn(n)},Un;function Mn(){return Z&&Z.isBiddingOnlyApp}function Vn(e){var t,i,r,a=[],o=new s.Deferred,d=[],l=["temp","files","assets","libs","graphicAssets",n.adPlayerDirectory],c=function(){var r=new s.Deferred,o=0;function c(){var t;(t=new s.Deferred,d.length>0&&ae.each(d,(function(t,n){re.cachePriorityArray&&re.cachePriorityArray[n]&&delete re.cachePriorityArray[n],delete e[n]})),"0"!==re.controllerVersion?(re.controllerVersion=De.v,ie.setGlobalAppData(re).then((function(){t.resolve()}),(function(){t.reject("NewController: Save app global data failed")}))):t.resolve(),t.promise()).then((function(){r.resolve(e)}),(function(e){r.reject(e)})),se.clearHandlers(a)}function u(e,t){const n=function(){var e=window.SuperSonicGlobalConfig.controllerConfig.networkConfig||{},t=e.purge||{};return ie.log("purgeConfig: "+JSON.stringify(t),ie.LogLevels.verbose),t}();var i=De.mobileSDKSettings.hasOwnProperty(t)&&!1===De.mobileSDKSettings[t];return!n[e]&&i}function p(e){return e===n.cacheAdsDirectory||function(e){return-1!==e.indexOf("RewardedVideo")||-1!==e.indexOf("Interstitial")}(e)}return t=se.subscribe(fe+".deleteFolderSuccess",(function(){ie.log("NewController: A new controller version detected. Folder deleted successfully",ie.LogLevels.verbose),++o>=d.length&&c()})),i=se.subscribe(fe+".deleteFolderFailed",(function(e){if(se.clearHandlers(a),ae.isDefined(e.errCode)&&1==e.errCode)ie.log("NewController: The folder requested for deletion was not found. Continue...",ie.LogLevels.verbose),++o>=d.length&&c();else{se.clearHandlers(a),r.reject("NewController: Purge cache for new controller version failed.")}})),function(){var t=u("campaigns","purgeCampaignsCache"),n=u("globals","purgeGlobalsCache");if(t)for(var i in e)p(i)&&l.push(i);n&&l.push("globals")}(),a.push(t),a.push(i),ae.each(e,(function(e,t){-1===l.indexOf(e)&&d.push(e)})),ie.log(d+JSON.stringify(d),ie.LogLevels.verbose),d.length>0?ae.each(d,(function(e,t){ie.deleteFolder(t)})):c(),r.promise()};return ie.getGlobalAppData().then((function(t){ie.log("SDKController | getGlobalAppData: "+JSON.stringify(t),ie.LogLevels.verbose),re=t,r=t.controllerVersion,bi()?(ie.log("NewController: Loading controller and player from bundle, skipping cache check",ie.LogLevels.verbose),o.resolve(e)):ae.isDefined(r)&&r!==De.v||!ae.isDefined(r)?(ie.log("NewController: A new controller version detected. Purging cache... old: "+r+"new: "+De.v,ie.LogLevels.verbose),at=!0,c().then((function(e){o.resolve(e)}),(function(){o.reject()}))):(ie.log("NewController: Controller version did not change. Saved version: "+r+" Current version: "+De.v,ie.LogLevels.verbose),o.resolve(e))}),(function(){ie.log("SDKController | getGlobalAppData: failed! ",ie.LogLevels.verbose),o.reject("getGlobalAppData: failed! ")})),o.promise()}function En(e){return function(t){Wt({data:t,id:e},!0)}}function kn(){return De.controllerConfig&&void 0!==De.controllerConfig.abTest?De.controllerConfig.abTest:-4}function Bn(e){nt||ie.getApplicationInfo(e).then((function(){return nt=!0,t.Utils.returnResolvedPromise()})).always((function(){const e=Rn(ie.getConfig());ut.updateBaseData(e),ut.start()}))}function Rn(e){var t=-1;try{t=parseInt(G.getDeviceApiLevel())}catch(e){ie.log("getAnalyticsBaseData | Error converting deviceApiLevel to Integer "+e,ie.LogLevels.verbose)}let i={sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,controllerbn:e.controllerbn,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey||ie.SupplyConfigurations.getValueByKey("applicationKey"),deviceId:Yn(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:G.getDeviceOsVersion(),deviceApiLevel:t,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:W.getOrientation(),env:Bi.getEnv(),lat:e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:kn(),ett:Ei(),sessionId:e.controllerId,usertype:e.userType,platformABGroup:ie.getSDKDataByKey(n.abTests.controllerConfigGroup),mediationType:e.controllerConfig.mediationType,appVersion:e.mobileSDKSettings.appVersion,SDKpluginType:e.applicationSettings.SDKPluginType,mediationABGroup:ie.SupplyConfigurations.getValueByKey("abInternal")};return window.SuperSonicGlobalConfig.controllerConfig.loadControllerFromJSCache&&(i.custom_h=1),i}function Kn(e,t){var n,i=[],r=new s.Deferred,a=t.length;for(n=0;n<a;n++)i.push(jn(e,t[n]));return s.when.apply(null,i).always((function(){ie.deleteFolder(e),r.resolve(0)})),r.promise()}function jn(e,t){var n=new s.Deferred,i=function(i){var r={timingValue:(new Date).getTime()-undefined,success:i},a=r.success?pt.cdnABTestSuccess:pt.cdnABTestFail,o={eNameStart:pt.cdnABTestSuccess,timingValue:r.timingValue,rvnomoreoffersreason:e,generalMessage:t};Le.trackTimingStop(a,o),n.resolve()};return Le.trackTimingStart(pt.cdnABTestSuccess),ie.cacheAsset(e,t).then(i.bind(null,!0),i.bind(null,!1)),n.promise()}function _n(e){var t="deviceVolumeSuccess";se.subscribe(fe+"."+t,(function(t){ie.log("Device volume received: "+(t?JSON.stringify(t):"empty")),e&&t&&e.call(null,{deviceVolume:t.deviceVolume||"0"})})),ie.callSDKFunction("getDeviceVolume",{},t,t)}function Wn(){var e="InitSummerySuccess";se.subscribe(fe+"."+e,(function(e){ie.log("InitSummery received: "+(e?JSON.stringify(e):"empty")),e.recoveryInfo&&(rt.recoveryInfo=e.recoveryInfo)})),ie.callSDKFunction("getInitSummery",{},e,e)}function Gn(){var e,t,i=new s.Deferred;return e=se.subscribe(fe+".getDebugParamsSuccess",(function(r){ie.log(d+"getDebugParamsSuccess "+JSON.stringify(r));try{var a={};De.mobileSDKSettings.deviceOs===n.deviceOs.android?a=ae.parseJSON(decodeURIComponent(r.SDK5DebugParams)):"object"==typeof r.SDK5DebugParams&&(a=r.SDK5DebugParams),i.resolve(a)}catch(e){ie.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,ie.LogLevels.verbose),i.reject("failed to parse received SDK5 params")}se.clearHandlers([e,t])})),t=se.subscribe(fe+".getDebugParamsFailed",(function(n){var r="failed to get debug param";ie.log("getSDKDebugParams | getDebugParamsFailed | "+r,ie.LogLevels.verbose),i.reject(r),se.clearHandlers([e,t])})),ie.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),i.promise()}function Hn(e){var t=new s.Deferred;return Gn().then((function(t){return e=ae.extend(e,t),ae.returnResolvedPromise(e)})).always((function(n){t.resolve(n||e)})),t.promise()}function qn(e){var t="false";!0===e&&(t="true"),ie.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:t})}function Jn(){return De.mobileSDKSettings&&De.mobileSDKSettings.bundleId&&-1!==n.testAppBundleIds.indexOf(De.mobileSDKSettings.bundleId)}function Qn(e){ie.log("setCloseButtonState params "+JSON.stringify(e),ie.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?Ye[e.productType][e.demandSourceName]=Se[e.state]:Ye[e.productType]=Se[e.state])}function $n(){if(!it){var e=ie.getApiData(S.deviceDataRequestObject);e&&Object.keys(e).length>0&&(it={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:G.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:De.mobileSDKSettings.webviewType,gpv:De.mobileSDKSettings.gpv})}return it||{}}function zn(){var e;return De.controllerConfig&&!0===De.controllerConfig.isSecured?e=n.protocol.https:De.mobileSDKSettings.deviceOs===n.deviceOs.android?e=n.protocol.http:De.mobileSDKSettings.deviceOs===n.deviceOs.ios&&(De.mobileSDKSettings.deviceOSVersion&&!t.VersionUtils.isLower(De.mobileSDKSettings.deviceOSVersion,"10")?De.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=n.protocol.http,ne=!0):De.mobileSDKSettings.allowArbitraryLoads?e=n.protocol.http:(e=n.protocol.https,ne=!0):e=De.mobileSDKSettings.allowArbitraryLoads?n.protocol.http:n.protocol.https),e}function Xn(e){if(e&&e.productType){var t=ie[e.productType];return e.demandSourceName&&t&&(t=t[e.demandSourceName]),t}}function Yn(e){return wi()?Zn(e):e["deviceIds[AID]"]}function Zn(e){return t.VersionUtils.isLower(e.deviceOSVersion,"10")||!0!==e.isLimitAdTrackingEnabled&&"true"!==e.isLimitAdTrackingEnabled?e["deviceIds[IFA]"]:e["deviceIds[IDFV]"]}function ei(){var e="assets",t=ie.Cache.getCacheByType({cacheBase:e}),n=De.mobileSDKSettings.jQueryUrls;t&&ie.Cache.getFileIndexInCache(t.cache,n[0])>-1?ie.log(d+"jQuery file already cache"):(ie.log(d+"Start save jQuery to cache"),ie.cacheAsset(e,n).then((function(){ie.log(d+"jQuery file saved successfully")}),(function(){ie.log(d+"jQuery file cache failed")})))}function ti(){var e=De.mobileSDKSettings.controllerPathFolder+De.v,t=ie.Cache.getCacheByType({cacheBase:e});if(t&&ie.Cache.getFileIndexInCache(t.cache,De.mobileSDKSettings.controllerJSUrl)>-1)ie.log(d+"controller js "+e+" already cached");else{ie.log(d+"controller js "+e+" not in cache"),ii(e,De.mobileSDKSettings.controllerJSUrl);try{ie.log(d+"saving "+De.mobileSDKSettings.controllerVersion+" in cache"),localStorage.setItem("controllerVersion",De.mobileSDKSettings.controllerVersion)}catch(e){ie.log("Failed to save controllerVersion to localStorage: "+e.message)}}}function ni(){var e=De.mobileSDKSettings.controllerPathFolder+De.v,t=ie.Cache.getCacheByType({cacheBase:e}),n=De.mobileSDKSettings.rootPath+Oe,i=De.mobileSDKSettings.cacheFolderPath+"/"+Fe;t&&ie.Cache.getFileIndexInCache(t.cache,n)>-1?(ie.log(d+"controller css "+i+" already cached"),ri(i)):(ie.log(d+"controller css "+i+" not in cache"),ii(e,n).then((function(){ie.log("updateControllerCssToCache - cache css file succeeded",ie.LogLevels.verbose),ri(i)}),(function(){ie.log("updateControllerCssToCache - cache css file failed",ie.LogLevels.verbose),ri(n)})))}function ii(e,t){return ie.log(d+"Start saving file to cache, url: "+t),ie.cacheAsset(e,t).then((function(){ie.log(d+"File save success | "+t)}),(function(e){return ie.log(d+"File save fail | "+t+" "+e),e}))}function ri(e){if(!document.getElementById("ssaMobileControllerCss")){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.id="ssaMobileControllerCss",document.head.prepend(t)}document.getElementById("ssaMobileControllerCss").setAttribute("href",e)}function ai(){ei(),ti(),ni(),De.mobileSDKSettings.deviceOs===n.deviceOs.android&&ie.AndroidNomediaFileHandler.updateNomediaFileToCache()}function oi(e){if(!ie.HTTPService.getIsNativeEngineExist())return!1;return ie.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function si(e){if("POST"===e.httpMethod)li(e);else ie.TrackingService.firePixel(e)}function di(e,t){const i=e.toString?e.toString():String(e);Le.report(pt.sendPOSTRequestThrowError,{callfailreason:i,generalmessage:n.controller,rvnomoreoffersreason:JSON.stringify(t.payload).substring(0,999),custom_a:t.url})}function li(e){try{ie.TrackingService.sendPost(e,n.contentTypeTextPlain).then((e=>{Le.report(pt.sendPOSTRequest,{custom_b:e,generalmessage:n.controller})})).catch((t=>{di(t,e)}))}catch(t){di(t,e)}}function ci(e,t,n,i){var r,a,o=new s.Deferred,d=[];if(!ae.isString(e)||!ae.isString(t))return ae.returnRejectedPromise("missing or corrupted params");r=se.subscribe(fe+".postAdEventNotificationSuccess",(function(e){ie.log("postAdEventNotificationSuccess"+JSON.stringify(e)),se.clearHandlers(d),o.resolve()})),d.push(r),a=se.subscribe(fe+".postAdEventNotificationFailed",(function(e){var t=e.errMsg?e.errMsg:"unknown reason";ie.log("error calling postAdEventNotificationFailed: "+t,ie.LogLevels.error),se.clearHandlers(d),o.reject(t)})),d.push(a);var l={eventName:e,dsName:n,productType:t,extData:i||{}};return ie.log("Controller - Notifies SDK on Event: "+l.eventName+" in Product: "+l.productType),ie.callSDKFunction("postAdEventNotification",l,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),o.promise()}function ui(e){var t,n=document.getElementById("ssaDialogBox");if("template4"===e)t={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:pi(e).maxDialogBtnTextWidth,parentContainer:Me}};else t={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:pi(e).maxDialogBtnTextWidth,parentContainer:Me}};return t}function pi(e){return n.templateStyle[e]?n.templateStyle[e]:n.templateStyle.defaultTemplate}function fi(){var e="",t=document.getElementById("ssaDialogBox"),n=t&&t.classList;for(let t of n)if(t.match(/template.*/)){e=t;break}return e}function gi(e,n,i,r){t.PubSub.publish(fe+"."+e,[n,i,r])}function vi(){for(;nativeQueue.length>0;){var e=nativeQueue.shift();gi(e.name,e.parameters,e.successCallback,e.errorCallback)}}function mi(e){return ie.SDKLimitations.getLimitData(e)}function hi(){const e=ie.SupplyConfigurations.getFeaturesConfigByKey(n.shouldCacheMraidCreative);return void 0===e||e}function bi(){return ie.log(`${d}shouldLoadControllerAndPlayerFromBundle: controllerHtmlFromBundle ${De.mobileSDKSettings.chfb}`),"true"===De.mobileSDKSettings.chfb}function Si(){return ie.SupplyConfigurations.getFeaturesConfigByKey("minBannerRefreshTime")||n.minBannerRefreshTime}function yi(e){ie.OMIDService.isSupported(e)&&ie.OMIDService.init(j);let t=ie.getConfig().mobileSDKSettings,n=t.protocol+"//"+t.cdn+"/ad-player/dist/assets",i=new o(ie,mn());const s=ie.SupplyConfigurations.getNetworkConfigValueByKey("uepfc"),d=ie.SupplyConfigurations.getNetworkConfigValueByKey("adprot");var l=new r(ie,{uepfc:s,adprot:d},n),c=new a(ie,i.getRootAbsolutePath(),Le);ie.ExternalAdProtocols.init({controller:ie,config:l,baseFileRepository:c})}function Ai(){return ie.CompatibilityService.isFeatureSupportedInNativeSDK(V.limitAppFiltering)||ie.CompatibilityService.isFeatureSupportedInNativeSDK(V.noPackagesInstallationPolling)}function Ci(){ie.SKOverlayManager.init(),Ii()}function Ii(){wi()&&ie.callSDKFunction("toggleUDIA",{getByFlag:-1},"toggleUDIAStatusSuccess","toggleUDIAStatusFailed")}function wi(){return Pi()===n.deviceOs.ios}function Di(){return Pi()===n.deviceOs.android}function Pi(){return De.mobileSDKSettings.deviceOs}function Fi(){return De.mobileSDKSettings.gpi}function Oi(e){H.unloadAdView(e),Ni(e)}function Ti(e){e?ie.OMIDService.finishSession(e).always((function(){Oi(e),le.removeAdById(ie.AdUtils.getAdId(e),e)})):ie.log("_unloadAdViewByAd | ad is empty")}function xi(e){var t=le.getAdByAdViewId(e);t?Ti(t):ie.log("unloadAdViewByAdViewId | adViewId is not found in loadedCreatives")}function Ni(e){e.productType===n.BN&&ie.callSDKFunction("cleanAdInstance",{demandSourceId:e.demandSourceId,productType:e.productType},"cleanAdInstanceSuccess","cleanAdInstanceFailure")}function Li(e){var t=$.get(),n=le.getAds(e);if(t){var i=H.getDisplayedAdView(t);ie.log("Removing all current "+e.productType+" frames"),i&&i.hasClass&&i.hasClass(C.getAdUnitClassObj(e).class)&&$.isDisplayed()&&(gt(),Yt())}n.forEach(H.unloadAdView),n.forEach((function(t){ie.log("remove from load creative "+ie.AdUtils.getAdId(t)),le.removeAdById(ie.AdUtils.getAdId(t),e)}))}function Ui(e,t){var n={name:"enterForeground"};e&&(n.active=e.active),_t(n,t)}function Mi(e,t){var n={name:"enterBackground"};e&&(n.action=e.action),_t(n,t)}function Vi(e){if(e){ie.getSegmentationAllocator().addControllerSourceSegment(e.controllerSourceStrategy);var t=e.controllerSourceCode;ae.isDefined(t)&&ut.updateBaseData({controllerSource:t})}}function Ei(){var e=(De.controllerConfig&&De.controllerConfig.epConfig||{}).ett;if(e&&Array.isArray(e)&&e.length>0)return e.toString()}function ki(e){ke=e}window.onerror=function(e,t,n,i,r){try{if(!r||!r.message)return;var a={url:t,lineNo:n,colNo:i,error:r&&r.message.substring(0,500)||""};ie.log(d+"onError handler. Exception:"+JSON.stringify(a)),Le&&Le.report(pt.controllerException,{generalMessage:e,rvnomoreoffersreason:JSON.stringify(a)})}catch(e){}};var Bi={getAdPlayerAssets:function(){return Y},adUnitGlobals:f,Utils:ae,JQWrapper:oe,libsManager:v,adUnitUrl:h,adPlayerUrl:b,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:ye,debugMsg:p.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:zn,blacklistService:A,jQuery:function(){return s},api:function(){return zn()+"//"+De.mobileSDKSettings.domain},dsSignals:function(){return Un||(Un=new i(t,ie,s)),Un},apiWithCdn:function(){return De.mobileSDKSettings.protocol+"//"+De.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return De.mobileSDKSettings.protocol+"//"+De.mobileSDKSettings.cdn},getIT:function(){let e=function(e){const t={android:n.androidIT,ios:n.iosIT};return!!t[e]&&t[e].map((e=>String.fromCharCode(e))).join("")}(Pi());return window.hasOwnProperty(e)||!1?1:0},init:function(t,i){return ie=this,s=window.jQuery,ce||(De.mobileSDKSettings=ae.extend(De.mobileSDKSettings,t.mobileSDKSettings),De.controllerConfig=ae.extend(De.controllerConfig,t.controllerConfig),j=new(e("../Environment/EnvironmentManager"))({controllerVersion:De.mobileSDKSettings.controllerVersion,schema:De.mobileSDKSettings.protocol,cdnDomain:De.mobileSDKSettings.cdn,scdnDomain:De.mobileSDKSettings.scdn,environment:De.mobileSDKSettings.env,deviceOs:De.mobileSDKSettings.deviceOs,cdnService:De.mobileSDKSettings.serviceCdn,stagingCdnDomain:De.mobileSDKSettings.domain,domain:De.mobileSDKSettings.domain}),De.mobileSDKSettings.overrideDebug&&(De.mobileSDKSettings.debug=De.mobileSDKSettings.defaultDebug),ie.APIConfigurations.init(),G=new I(De,ae,n),W=ie.AppOrientationManager,_=new w(p,n,W),le=new(e("./LoadedCreatives"))(ie),wt(i),Dt(),St(),Ct(),Pt(),Ft(),mt(),bt(),Vi(De.controllerConfig.controllerSourceData),ie.log(d+"Controller initiated"),te.setNativeConfiguration(O.native[De.mobileSDKSettings.deviceOs]),s.when(Cn(),Fn()).then((function(){yi(De.controllerConfig);var e=zn();f.setProtocol(e),Y.setProtocol(e),window.queueValidMessages={},vi(),Ci(),Bn();try{Y.prepareAdPlayerAssets({retryAttempts:15,retryInterval:1,assetType:n.assetType.adunitAsset})}catch(e){}})).then((function(){s.when(ai(),An()).always((function(){var e={};Ai()||(e.gpi=De.mobileSDKSettings.gpi),e.ici=!0,e.sdkAbName=JSON.stringify(De.controllerConfig.sdkAbName),z.updateToken(e),ie.CompatibilityService.isFeatureSupportedInNativeSDK(V.initRecovery)&&Wn()}))})).fail((function(e){e=e||"failed promise on get app config",ie.log(d+e),Bn(),Le.report(pt.initFailed,{generalMessage:decodeURIComponent(e)}),ie.callSDKFunction("initController",{stage:"failed",errMsg:e})})),ce=!0,Le.report(pt.controllerInitiated)),ce},getConfigurationHelper:function(){return G},getAPIRequiredData:function(){var e=ie.APIConfigurations.getCommonRequiredData(),t=ie.getApiData(e),n=new s.Deferred;return t&&t!={}?ae.isDefined(t.errMsg)?n.reject(t.errMsg):n.resolve(t):n.reject("Failed to get required parameters"),n.promise()},isIOS:wi,isAndroid:Di,getDeviceOs:Pi,isGpi:Fi,getApiData:function(e){var t,n={};for(t in e)if(e.hasOwnProperty(t)){if(1===e[t]&&!wn(t)&&!Dn(t)){n={errMsg:he.missing+t};break}wn(t)?n[t]=Pn(t):"customParams"===t?n=ae.extend(n,bn()):Dn(t)&&(n[t]=Pe[t]())}return n},getSDKDataByKey:function(e){return Pn(e)},isAppsInstalledInfoRestricted:Ai,runFunction:function(e,t,n){var i=vn(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,t,n);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=ae.parseJSON(i.parameters);try{ae.isDefined(i.name)&&gi(i.name,r,t,n)}catch(e){ie.log("error running function:"+i.name+", error:"+e,ie.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,t,n)}},callSDKFunction:function(e,t,n,i){K.callSDKFunction(e,t,n,i)},callSDKFunctionWithCallback:function(e,t,n,i){K.callSDKFunctionWithCallback(e,t,n,i)},callSDKService:function(e,t,n,i,r){K.callSDKService(e,t,n,i,r)},getApplicationInfo:function(e,t){var n,i,r=s.Deferred(),a=function(e,t){se.clearHandlers([n,i]),e?r.resolve(De):r.reject(t||he.appInfo)};return n=se.subscribe(fe+".parseApplicationInfo",(function(t,n,i){var r;ae.isDefined(t.productType)&&t.productType!==e.productType&&t.demandSourceName!==e.demandSourceName?ie.log(d+"parseApplicationInfo | info sent for the wrong product"):(ie.log(d+"parseApplicationInfo: "+JSON.stringify(t)),delete t.productType,delete t.demandSourceName,(r=xn(t)).didSucceed?(ae.isDefined(n)&&ie.callSDKFunction(n),a(!0)):(ae.isDefined(i)&&ie.callSDKFunction(i,{errMsg:r.errMsg}),a(!1,r.errMsg)))})),i=se.subscribe(fe+".getApplicationInfoFailed",(function(e){gn(e),a(!1,"Failed retrieving application info")})),ie.callSDKFunction("getApplicationInfo",e,"parseApplicationInfo","getApplicationInfoFailed"),r.promise()},setCloseButtonState:Qn,getEnv:function(){n.environment.production;return De.mobileSDKSettings.debug&&parseInt(De.mobileSDKSettings.debug)>0&&De.mobileSDKSettings.domain!==n.domainUrls.prod?De.mobileSDKSettings.domain===n.domainUrls.local?n.environment.develop:n.environment.stage:n.environment.production},getProtocol:function(){return De.mobileSDKSettings.protocol},isLegacy:function(e){var n=!0;try{var i="android"===De.mobileSDKSettings.deviceOs?e.android:e.ios;n=t.VersionUtils.isLower(De.mobileSDKSettings.SDKVersion,i)}catch(e){ie.log(e,ie.LogLevels.error)}return n},cacheAdUnitAssets:function(e,t){var n,i=t.assets,r=t.lastUpdateTime,a=i.length,o=new s.Deferred,l=[],c=0;for(0===a&&o.resolve(0),n=0;n<a;n++)l.push(ie.cacheAsset(e,i[n],r));return s.when.apply(null,l).always((function(){var t=arguments;for(n in t)ie.log(d+"path: "+e+" res: "+t[n],3),t[n]&&c++;o.resolve(c)})),o.promise()},cacheAsset:function(e,t,i,r){var a,o,l,c=[],u=new s.Deferred;if(ae.isString(t)&&(t=[t]),"device"===De.applicationSettings.preCache){var p,f={path:ae.isString(e)?e:e.toString(),overrideExistingFile:r},g=-1,v=function(e){u.reject(e),se.clearHandlers(c)},m=function(e){++g>=t.length?v(e||"Index error in array assets url"):(p=t[g],f.file=ne?ae.changeUrlProtocol(p,n.protocol.https):p,ie.log(d+"saveFile | "+f.file+" path: "+decodeURIComponent(f.path)),ie.callSDKFunction("saveFile",f,"preCacheFileSuccess","preCacheFileFailed"))};ae.isDefined(i)&&(f.lastUpdateTime=i.toString()),a=se.subscribe(fe+".assetCached",(function(t){if(!vt(["path","file"],t,"preCacheFileSuccess").didSucceed)return ie.log("error calling assetCached "+JSON.stringify(t),ie.LogLevels.error),void v("error calling assetCached");decodeURIComponent(t.path)===e&&p.match(t.file)&&(se.clearHandlers(c),ie.log(d+"saveFile | success: "+decodeURIComponent(t.path)+"/"+t.file),u.resolve({filePath:decodeURIComponent(t.path)+"/"+t.file,url:p}))})),o=se.subscribe(fe+".assetCachedFailed",(function(t){decodeURIComponent(t.path)===e&&p.match(t.file)&&(ie.log(d+"saveFile | fail "+decodeURIComponent(t.path)+"/"+t.file),m("failed saved file"))})),l=se.subscribe(fe+".preCacheFileFailed",(function(t){decodeURIComponent(t.path)===e&&p.match(t.file)&&(ie.log(t.errMsg+": "+decodeURIComponent(t.path)+"/"+t.file,ie.LogLevels.error),m(t.errMsg))})),c.push(a),c.push(o),c.push(l),m()}else u.resolve(!0);return u.promise()},deleteFolder:function(e){ae.isString(e)||e.toString(),ie.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(e,t){var n,i,r=new s.Deferred,a=[];return ae.isString(e)||e.toString(),ae.isString(t)||t.toString(),n=se.subscribe(fe+".deleteFileSuccess",(function(n){if(!vt(["path","file"],n,"deleteFileSuccess").didSucceed)return ie.log("error calling deleteFileSuccess "+JSON.stringify(n),ie.LogLevels.error),r.reject("failed to delete file: "+n.file),void se.clearHandlers(a);decodeURIComponent(n.path)===e&&t.match(n.file)&&(se.clearHandlers(a),ie.log("successfully deleted file: "+decodeURIComponent(n.path)+"/"+n.file),r.resolve())})),a.push(n),i=se.subscribe(fe+".deleteFileFailed",(function(n){if(!vt(["path","file"],n,"deleteFileFailed").didSucceed)return ie.log("error calling deleteFileFailed "+JSON.stringify(n),ie.LogLevels.error),r.reject("failed to delete file: "+n.file),void se.clearHandlers(a);decodeURIComponent(n.path)===e&&t.match(n.file)&&(se.clearHandlers(a),ie.log("failed to delete file: "+n.file),r.reject("failed to delete file: "+n.file))})),a.push(i),ie.callSDKFunction("deleteFile",{path:e,file:t},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var t=e?Tn():qe.none;ie.callSDKFunction("setBackButtonState",{state:t})},addAdToLoadedCreatives:function(e){return le.addAd(e)},isContainerLoaded:function(e){return H.isContainerLoaded(e)},getContainerCreationHandler:function(e){return H.getContainerCreationHandler(e)},loadAdUnitUrl:function(e,t,n,i){H.createAndLoadView(e,t,n,i),le.addAd(e)},displayAdView:function(e){H.displayAdView(e,qt,Jt.bind(null,e),Qt)},updateAdUnitUrl:function(e,t,n,i){H.updateFrameUrl(e,t,n,i),le.addAd(e)},onAdLoaded:function(e){ie.log(d+"onAdLoaded | "+JSON.stringify(e));var t=function(){ie.log(d+"ad loaded mismatch",ie.LogLevels.error),Be<Re&&(se.publish("SDKController.AdLoadError",[e]),Be++)};if(e&&e.productType)if(le.getAdById(ie.AdUtils.getAdId(e),e))H.onAdUnitLoaded(e,qt,Jt.bind(null,e));else{var n={eventParam:{eName:pt.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(n.demandSourceName=e.demandSourceName),se.publish("SDKController.Analytics",[n]),ie.log(d+"onAdLoaded | mismatch from not being in loadedcreatives"),t()}else t()},removeAdUnit:function(e){if($.isAdDisplayed(e)){var t=Xn(e);Gt();var n=!(!t||!ae.isFunction(t.getNextAd))&&t.getNextAd(!0,e.inventoryId);Yt(!1,n)}else{var i=le.getAdById(ie.AdUtils.getAdId(e),e);i.engaged=!1,On(i,{preloadNextInBG:!0})}},removeAdUnitFromExternal:function(e){le.removeAdById(ie.AdUtils.getAdId(e),e),t.PubSub.publish("SDKController.engageEnd",[e])},unloadAdViewsByProduct:Li,unloadAdViewByAdViewId:xi,unloadAdViewByAd:Ti,isRootFolder:function(e){return wi()?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return $.get()},setCurrentDisplayedAd:function(e){return $.set(e)},getCurrentDisplayedAdType:function(){return $.getDisplayedAdType()},isAdDisplayed:function(e){return $.isAdDisplayed(e)},getGlobalAppData:function(){var e,t,n,i,r=new s.Deferred;return e=se.subscribe(fe+".parseGlobalData",(function(n){if(i="string"==typeof n.ssaGlobalAppData?ae.parseJSON(decodeURIComponent(n.ssaGlobalAppData)):n.ssaGlobalAppData,ie.log("Full global app data is: "+JSON.stringify(i)),!i)return r.reject("Invalid Global Data response"),void se.clearHandlers([e,t]);r.resolve(i),se.clearHandlers([e,t])})),t=se.subscribe(fe+".getGlobalDataFailed",(function(i){n=vt(["errMsg"],i,"getGlobalDataFailed").didSucceed?i.errMsg:vt(["errMsg"],i,"getGlobalDataFailed").errMsg,r.reject(n),se.clearHandlers([e,t])})),ie.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),r.promise()},setCachePriorityArrayKey:function(e,t){return t?ie.getGlobalAppData().then((function(n){return n.cachePriorityArray=n.cachePriorityArray||{},n.cachePriorityArray[e.cacheBase]=t,ie.setGlobalAppData(n)})):ae.returnResolvedPromise()},setGlobalAppData:function(e){var t,n,i,r=new s.Deferred;return t=se.subscribe(fe+".setGlobalDataSuccess",(function(){r.resolve(),se.clearHandlers([t,n])})),n=se.subscribe(fe+".setGlobalDataFailed",(function(e){i=vt(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:vt(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),se.clearHandlers([t,n])})),ie.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(e,t){var n,i,r,a,o=new s.Deferred;return ae.isDefined(t)&&!ae.isDefined(e)?(o.reject("Missing info to retrieve user data."),o.promise()):(n=se.subscribe(fe+".parseUserData",(function(s){return vt(["ssaUserData"],s,"parseUserData").didSucceed?(a="string"==typeof s.ssaUserData?ae.parseJSON(decodeURIComponent(s.ssaUserData)):s.ssaUserData,ie.log("Full user data is: "+JSON.stringify(a)),a?(ae.isDefined(e)&&(a=a[e]||{},ae.isDefined(t)&&(a=a[t]||{})),ie.log("Get user data response: "+JSON.stringify(a)+" for appKey "+e+" and userId "+t),o.resolve(a),void se.clearHandlers([n,i])):(o.reject("Invalid User Data response"),void se.clearHandlers([n,i]))):(r=vt(["errMsg"],s,"parseUserData").errMsg,o.reject(r),void se.clearHandlers([n,i]))})),i=se.subscribe(fe+".getUserDataFailed",(function(e){r=vt(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:vt(["errMsg"],e,"getUserDataFailed").errMsg,o.reject(r),se.clearHandlers([n,i])})),ie.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed"),o.promise())},setUserData:function(e,t,n){var i,r,a,o,d=new s.Deferred;return ae.isDefined(e)&&ae.isDefined(t)?(s.when(ie.getUserData()).then((function(s){o=s,ae.isDefined(o[e])||(o[e]={}),ae.isDefined(o[e][t])||(o[e][t]={}),o[e][t]=n=={}?{}:ae.extend(o[e][t],n),i=se.subscribe(fe+".setUserDataSuccess",(function(){d.resolve(),se.clearHandlers([i,r])})),r=se.subscribe(fe+".setUserDataFailed",(function(e){a=vt(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:vt(["errMsg"],e,"setUserDataFailed").errMsg,d.reject(a),se.clearHandlers([i,r])})),ie.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(o)},"setUserDataSuccess","setUserDataFailed")}),(function(e){d.reject(e)})),d.promise()):(d.reject("Missing info to set user data."),d.promise())},getConfig:function(){return De},getApplicationExternalConfig:function(){return y},isSupportedOsVersion:function(e){return null===G.getDeviceApiLevel().match(Qe[e][De.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!De.controllerConfig||-1===n.applicationsLimitations.indexOf(De.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(De.mobileSDKSettings.deviceModel);return-1!==n.deviceLimitations.indexOf(e)},isBiddingOnlyApp:Mn,checkRequiredCallbackParams:function(e,t,n,i){return vt(e,t,n,i)},alert:function(e){var n,i=document.getElementById("ssaDialogText"),r=document.getElementById("ssaDialogBox"),a=fi(),o=ui(a),s=pi(a),d=!1,l=document.getElementById("ssaDialogConfirmBtnText"),c=document.getElementById("ssaDialogCancelBtnText"),u=document.getElementById("ssaDialogBtns");Wt({name:"dialogBoxAboutToOpen"}),r.removeAttribute("style"),r.style.display="block",(!Ee||e&&e.alwaysClose)&&(H.hideLoader(),Mt(),d=!0),Ee||H.displayContainer(e);var p=C.getDisplayedAdFrame();if(p&&t.Msg.postMessage("hideFrame","*",p.contentWindow),u.classList.remove("singleBtn"),"object"==typeof e&&(Ve.classList.remove("hidden"),Ve.removeAttribute("style"),Me.classList.remove("hidden"),Me.removeAttribute("style"),ae.isDefined(e.close)?(n=e.close,l.textContent=e.yes,c.textContent=e.no,ae.calculateTextElementWidth(Me)>s.minDialogBtnWidth||ae.calculateTextElementWidth(Ve)>s.minDialogBtnWidth?(Ve.style.width=s.maxDialogBtnWidth+"px",Ve.style.left="20px",Me.style.width=s.maxDialogBtnWidth+"px",Me.style.left="20px"):(Ve.style.width=s.baseDialogBtnWidth+"px",Ve.style.left=s.baseDialogBtnWidth+"55px",Me.style.width=s.baseDialogBtnWidth+"px",Me.style.left=s.baseDialogBtnWidth+"55px"),(ae.calculateTextElementWidth(Me)>s.maxDialogBtnTextWidth||ae.calculateTextElementWidth(Ve)>s.maxDialogBtnTextWidth||-1!==e.yes.indexOf(" ")||-1!==e.no.indexOf(" "))&&(ae.textfill2(l,o.buttonText),o.buttonText.parentContainer=Ve,ae.textfill2(c,o.buttonText))):ae.isDefined(e.message)?(n=e.message,ae.isDefined(e.yes)&&(l.textContent=e.yes),ae.isDefined(e.no)&&(c.textContent=e.no)):n=JSON.stringify(e),d&&(u.classList.add("singleBtn"),Ve.classList.add("hidden"),Me))){var f=Me.offsetWidth/2;Me.style.marginLeft=-1*f+"px"}i.textContent=n,ae.textfill2(i,o.dialogText),r.style.visibility="visible";var g=document.getElementById("ssaDialogBoxOverlay");ie.JQWrapper.fadeIn(g,100),ie.JQWrapper.bind(g,"click",(function(e){e.preventDefault()})),ie.JQWrapper.fadeOut(Ue,300)},log:p.log,logEvent:function(e,t){Sn(e)},openUrl:function(e,t){Et(e,t)},postAdUnitEvent:function(e,t){Wt(e,t)},initAnalytics:Bn,initBannerExternalService:function(){J.init(),Q.init()},getFormattedDeviceData:$n,shouldExtendApiDataWithDebugData:Jn,extendApiDataWithDebugParams:Hn,getSDKDebugParams:Gn,getNotchService:function(){return X},getTokenService:function(){return z},setAllowFileAccessFromFileURLs:qn,getDeviceId:function(){return Yn(ie.getConfig().mobileSDKSettings)},getSDKLimitationData:mi,addExternalAdViewIdAndSetStatus:function(e){J.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return J},getBiddingLimitations:function(){return ft||{}},getAdViewContainer:function(e){return H.getAdViewByAd(e)},shouldCacheMraidCreativeNetworkConfig:hi,getMinBannerRefreshTime:Si,onAdVisible:zt,saveFileToCache:ii,getCacheRootFolder:function(){return De.mobileSDKSettings.rootCacheFolder},getSegmentationAllocator:function(){return R},environmentConfiguration:function(){return j},getRecoveryInfo:Kt,isBannerNoneLWS:jt,isBannerMultipleInstances:function(e){return e===n.BN&&ie.CompatibilityService.isFeatureSupportedInNativeSDK(V.bannerMultipleInstances)},getCacheFileEncodingPatch:function(){return E},getAdServicesExtensionLevel:function(){return De.mobileSDKSettings.asel},onEnterForeground:Ui,onEnterBackground:Mi,sendMessageToAdView:_t,getETT:Ei,setEscapingUser:ki,isEscapingUser:function(){return ke},getIDFI:Tt};return ie=Bi,Bi}t.exports=function(t){var n=e("../../components/Constants.js"),r=e("../Cache.js"),a=e("../BannerFactory.js"),o=e("../../components/HTTPService.js"),s=e("../../components/AdUtils"),d=e("../../components/InstanceUtils"),l=e("../../components/DemandUtils.js"),c=e("../../components/SupplyConfigurations.js"),u=e("../../components/storeKit/StoreKitService.js"),p=e("../../components/ViewsManager.js"),f=e("../../components/TrackingService"),g=e("../../components/OpenURLService.js"),v=e("../../components/OMIDService"),{ExternalAdProtocols:m}=e("../../components/adInterfaces"),h=e("../../components/DeviceDataService.js"),b=e("../../components/RingerSwitchService"),S=e("../../components/OrientationService"),y=e("../../components/GDPRservice.js"),A=e("../../components/orientation/AppOrientationManager.js"),C=e("../../components/PermissionService"),I=e("./SDKLimitations"),w=e("../../components/APIConfigurations.js"),D=e("../../components/NativeLifeCycleEventsService.js"),P=e("../../components/LastSeenCampaignService"),F=e("../../components/AndroidNomediaFileHandler.js"),O=e("../../components/ImpressionsCounterService.js"),T=e("../../components/MultipleAdObjectsAdFormatsService"),x=e("../DemandSource/FetchDemand/FetchDirect"),N=e("../../components/ExtraOffers"),L=e("../../components/CampaignsFilter.js"),U=e("../../components/AdvertisingIdService.js"),M=e("../../components/SKAdImpression/SKAdImpressionService"),V=e("../../components/FeatureCompatibilityService"),E=e("../Cache/AdsAssetsNativeCommunicator.js"),k=e("../Cache/AdsAssetsManager.js"),B=e("../../components/SKOverlay/SKOverlayManager.js"),R=e("../../components/SKOverlay/SKOverlayEventDispatcher"),K=e("../../components/AppUserIdService.js"),j=e("./InstancesLoadTimers.js"),_=e("../../modules/DemandSource/EventCategories"),{InstancesEventsHandler:W}=e("../InstancesEventsHandler"),G=e("./ManualLoadInstancesBuilder.js"),H=e("../../components/LocalStorageService"),q=new i(t,n);return q.Cache=new r(t,q),q.SDKLimitations=new I(q),q.BannerFactory=new a(t,q),q.HTTPService=new o(t,q),q.AdUtils=new s(t,q),q.InstanceUtils=new d(t,q),q.DemandUtils=new l(t,q,n),q.SupplyConfigurations=new c(q,n,t.Utils),q.StoreKitService=new u(t,q,n),q.ViewsManager=new p(t),q.TrackingService=new f(q),q.OpenURLService=new g(q,n),q.OMIDService=new v(t,q),q.ExternalAdProtocols=new m,q.DeviceDataService=new h(t,q),q.RingerSwitchService=new b(t,q),q.OrientationService=new S(t,q,n),q.GDPRService=new y(t,q,n),q.AppOrientationManager=new A(t,q,n),q.PermissionService=new C(t,q),q.APIConfigurations=new w(q),q.NativeLifeCycleEventsService=new D(t,q,n),q.LastSeenCampaignService=new P(q,n),q.AndroidNomediaFileHandler=new F(q),q.ImpressionsCounterService=new O(n),q.MultipleAdObjectsAdFormatsService=new T,q.FetchDirectService=new x(window.jQuery.ajax),q.ExtraOffers=new N(n,q.FetchDirectService,q.environmentConfiguration),q.CampaignsFilter=new L(t,q,n),q.AdvertisingIdService=new U(t,q,n),q.SKAdImpressionService=new M(t,q,n),q.CompatibilityService=new V(SuperSonicGlobalConfig.controllerConfig),q.AdsAssetsNativeCommunicator=new E(t,q),q.AdsAssetsManager=new k(t,q,q.AdsAssetsNativeCommunicator),q.SKOverlayManager=new B(t,q,n),q.SKOverlayEventDispatcher=new R(t,q,n),q.AppUserIdService=new K(t,q,n),q.InstancesTimers=new j,q.EventsCategories=new _,q.InstancesEventsHandler=new W({constants:n,controller:q,core:t}),q.ManualLoadInstancesBuilder=new G(q.getConfig().controllerConfig,n),q.LocalStorageService=new H(q,t),q}},{"../../components/APIConfigurations.js":26,"../../components/AdOrientationManager":28,"../../components/AdUtils":29,"../../components/AdvertisingIdService.js":30,"../../components/AndroidNomediaFileHandler.js":33,"../../components/AppUserIdService.js":37,"../../components/BlacklistService":38,"../../components/CampaignsFilter.js":39,"../../components/Constants.js":40,"../../components/DemandUtils.js":41,"../../components/DeviceDataService.js":43,"../../components/DisplayedAdManager.js":44,"../../components/ExternalConfig":45,"../../components/ExtraOffers":46,"../../components/FeatureCompatibilityService":47,"../../components/FrameHelper.js":50,"../../components/GDPRservice.js":52,"../../components/HTTPService.js":53,"../../components/IframeManager":54,"../../components/ImpressionsCounterService.js":55,"../../components/InstanceUtils":57,"../../components/LastSeenCampaignService":60,"../../components/LocalStorageService":61,"../../components/Logger.js":62,"../../components/MultipleAdObjectsAdFormatsService":65,"../../components/NativeAPIAdapter.js":67,"../../components/NativeLifeCycleEventsConstants.js":68,"../../components/NativeLifeCycleEventsService.js":69,"../../components/NotchFactory.js":70,"../../components/OMIDService":73,"../../components/OpenURLService.js":77,"../../components/OrientationService":79,"../../components/PermissionService":81,"../../components/RingerSwitchService":85,"../../components/SKAdImpression/SKAdImpressionService":88,"../../components/SKOverlay/SKOverlayEventDispatcher":91,"../../components/SKOverlay/SKOverlayManager.js":92,"../../components/SupplyConfigurations.js":93,"../../components/TrackingService":94,"../../components/ViewsManager.js":98,"../../components/adInterfaces":104,"../../components/adInterfaces/AdInterfaceConfiguration":100,"../../components/adInterfaces/BaseFileRepository":101,"../../components/adInterfaces/CacheLocation":102,"../../components/containers/AdViewsManager.js":106,"../../components/containers/BackgroundController":107,"../../components/containers/BannerExternalAdViewService":108,"../../components/containers/BannerExternalContainer.js":109,"../../components/containers/NavigationModeView":115,"../../components/containers/WPADUtils":116,"../../components/containers/WebView":117,"../../components/containers/WebViewManager.js":118,"../../components/dssignals/DSSignals":120,"../../components/orientation/AppOrientationManager.js":121,"../../components/storeKit/StoreKitService.js":129,"../../components/token/TokenService.js":132,"../../constants/SDKFeatureNames":133,"../../modules/Bidding/BiddingLimitations":148,"../../modules/DemandSource/EventCategories":162,"../../modules/SDKController/EventCategories":193,"../../modules/SDKController/MonitorCdn":198,"../../patches/PatchAppOrientation":219,"../../patches/PatchCacheFileEncoding":220,"../../presenter/uiConfig.js":225,"../AdPlayer/AdPlayerAssets":136,"../AdPlayer/AdPlayerUrl":137,"../AdUnitManager/AdUnitGlobals.js":140,"../AdUnitManager/LibsManager.js":143,"../AdUnitUrl.js":144,"../BannerFactory.js":147,"../Cache.js":149,"../Cache/AdsAssetsManager.js":152,"../Cache/AdsAssetsNativeCommunicator.js":153,"../DemandSource/FetchDemand/FetchDirect":164,"../DemandSource/FetchDemand/FetcherPatch.js":165,"../Environment/EnvironmentManager":173,"../InstancesEventsHandler":180,"../ProductRouter.js":187,"../SDKInterface.js":206,"../UserSegmentation/SegmentationAllocator.js":209,"../UserSegmentation/SegmentationManager":211,"./ConfigurationHelper.js":192,"./InstancesLoadTimers.js":194,"./LoadedCreatives":195,"./ManualLoadInstancesBuilder.js":196,"./MessageHandler":197,"./SDKLimitations":200,"./mainConfig.js":202,"./nativeConfigHandler.js":203,"./sessionConfig":204,"./videoStateHandler.js":205}],200:[function(e,t,n){t.exports=function(e){var t=" is not supported";return{getLimitData:function(n){var i={errMsg:"",didSucceed:!0};return e.isSupportedOsVersion(n)?e.isLimitedDeviceModel()&&(i.errMsg="Device"+t,i.didSucceed=!1):(i.errMsg="Operating system version "+e.getApiData({deviceOSVersion:1}).deviceOSVersion+t,i.didSucceed=!1),i}}}},{}],201:[function(e,t,n){t.exports=function(e,t,n){var i={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var t=e;return"portrait"===(t=t.toLowerCase())||"landscape"===t||"none"===t},connectionType:function(e){var t=decodeURIComponent(e);return"wifi"===(t=t.toLowerCase())||t.match(/^mobile\[.+\]$/)||"3g"===t||"none"===t},rawConnectionType:function(e){return!!e},iphoneAppOnIpadDevice:function(e){var t=parseInt(e);return 0===t||1===t},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(t){return e.isDefined(t)},"deviceIds[IFA]":function(t){return e.isDefined(t)},"deviceIds[SERIAL]":function(t){return e.isDefined(t)},"deviceIds[AndroidID]":function(t){return e.isDefined(t)},"deviceIds[IMEI]":function(t){return e.isDefined(t)},"deviceIds[AID]":function(t){return e.isDefined(t)},gpv:function(t){return e.isDefined(t)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(n){return e.isDefined(t[n])},disableCache:function(e){var t=parseInt(e);return 0===t||1===t},disableSession:function(e){var t=parseInt(e);return 0===t||1===t},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var t=parseInt(e);return t>=0&&t<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},itemCount:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},minimumOfferCommission:function(e){var t=parseFloat(e);return!isNaN(t)&&t>=0},demoCampaigns:function(e){var t=parseInt(e);return 0===t||1===t},numOfCampaigns:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},campaignId:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},pageSize:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},landingId:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},page:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},admin:function(e){var t=parseInt(e);return 0===t||1===t},useClientSideCallbacks:function(e){var t=e.toString();return"true"===t||"false"===t},unLocked:function(e){var t=e.toString();return"true"===t||"false"===t},isLimitAdTrackingEnabled:function(t){return e.isDefined(t)},placementId:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},allowArbitraryLoads:function(e){var t=e.toString();return"true"===t||"false"===t},allowArbitraryLoadsInWebContent:function(e){var t=e.toString();return"true"===t||"false"===t}};function r(e,t,n){n[e]=t}return function(t,a){var o,s=!0,d=null;for(o in t){if(e.isDefined(i[o])&&!1===i[o](t[o])){d=n.invalid+o,s=!1;break}r(o,t[o],a)}return{didSucceed:s,errMsg:d}}}},{}],202:[function(e,t,n){t.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],203:[function(e,t,n){function i(t,n){var i=e("../../components/Constants.js");return t.subscribe(i.CB+".nativeConfigSuccess",(function(e){n.log("nativeConfig update successfully.",n.LogLevels.error)})),t.subscribe(i.CB+".nativeConfigFailed",(function(e){n.log("nativeConfig failed to update.",n.LogLevels.error)})),{setNativeConfiguration:function(e){e&&n.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;t.exports=function(e,t){return r||(r=new i(e,t)),r}},{"../../components/Constants.js":40}],204:[function(e,t,n){t.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],205:[function(e,t,n){function i(t,n){var i=e("../../components/Constants.js"),r=i.videoStates,a=i.RV,o=r.none;return t.subscribe("SDKController.AdStarted",(function(){n.log("VideoStateHandler | AdStarted",n.LogLevels.verbose),o=r.play,n.callSDKFunction("onVideoStatusChanged",{status:"started",productType:a})})),t.subscribe("SDKController.AdPlaying",(function(){n.log("VideoStateHandler | AdPlaying",n.LogLevels.verbose),o=r.play,n.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:a})})),t.subscribe("SDKController.AdPaused",(function(){n.log("VideoStateHandler | AdPaused",n.LogLevels.verbose),o=r.stop,n.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:a})})),t.subscribe("SDKController.AdVideoEnded",(function(){n.log("VideoStateHandler | AdVideoEnded",n.LogLevels.verbose),o=r.stop,n.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:a})})),{handleOnEngageEnd:function(){n.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",n.LogLevels.verbose),o=r.none,n.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:a})},getState:function(){return o}}}var r;t.exports=function(e,t){return r||(r=new i(e,t)),r}},{"../../components/Constants.js":40}],206:[function(e,t,n){var i=e("./iOSSDKInterface.js"),r=e("./iOSSDKInterface_WK.js"),a=e("./androidSDKInterface.js");t.exports=function(e,t,n,o){"use strict";var s,d="undefined";switch(e.deviceOs){case t.deviceOs.android:s=new a(o,n,d);break;case t.deviceOs.ios:s="wk"===e.webviewType?new r(d):new i(d);break;default:s=new i(d)}return s}},{"./androidSDKInterface.js":215,"./iOSSDKInterface.js":216,"./iOSSDKInterface_WK.js":217}],207:[function(e,t,n){function i(e){var t,n,i={},r={},a=!1,o=function(a,o){var s=null;i=t.Utils,(r=t.PubSub).init(),i.isDefined(a.mobileSDKSettings)&&(s=(n=t.SDKController).init(a,o)),e.when(s).then((function(){a.products&&i.each(a.products,(function(e){i.isDefined(e.init)&&e.init(a[e])}))}),(function(){console.log("Failed to initiate controller")}))},s={init:function(e,n){return t=this,o(e,n),a=!0},log:function(e,t){n&&n.log&&n.log(e,t||n.LogLevels.error)}};return s}t.exports=function(t,n,r,a){var o=e("../components/Utils.js"),s=e("../components/JQWrapper.js"),d=e("../components/PubSub.js"),l=e("../components/Msg.js"),c=e("../components/VersionUtils");const u=e("analytics");var p=e("./AdAssets.js"),f=e("./VastUtils.js");const g=u.analyticFactory;var v=new i(t);v.PubSub=new d(v),v.Msg=new l,v.AdAssets=new p,v.VastUtils=new f(v.AdAssets);const m={kudu:{}};(n.productionDebug||n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==n.SuperSonicGlobalConfig.mobileSDKSettings.domain)&&(m.qa={});let h={};return n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.controllerConfig&&n.SuperSonicGlobalConfig.controllerConfig.networkConfig&&n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events&&(n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.disabledEventsObj&&(h=n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.disabledEventsObj),n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.endpoint&&(m.kudu.endpoint=n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.endpoint)),n.isWebWrapper&&(m.webAut={logFn:e=>v.SDKController.log(e)}),v.Analytics=g.createBaseAnalytics({disabledEvents:h,transmitters:m}),v.PubSub.subscribe("updateEventsBaseData",(e=>{e&&"object"!=typeof e||v.Analytics.updateBaseData(e)})),v.Utils=new o(v,n,r,a),v.JQWrapper=new s(v,n,r,a),v.VersionUtils=new c,v}},{"../components/JQWrapper.js":59,"../components/Msg.js":64,"../components/PubSub.js":83,"../components/Utils.js":95,"../components/VersionUtils":97,"./AdAssets.js":135,"./VastUtils.js":213,analytics:4}],208:[function(e,t,n){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.StoreType=n.StoreConfig=void 0,n.StoreType=i,function(e){e[e.Unknown=0]="Unknown",e[e.iOSStore=1]="iOSStore",e[e.GooglePlay=2]="GooglePlay",e[e.Aura=3]="Aura",e[e.GoogleMarket=4]="GoogleMarket",e[e.Samsung=5]="Samsung",e[e.Amazon=6]="Amazon",e[e.Huawei=7]="Huawei"}(i||(n.StoreType=i={})),function(e){e.AuraAppLink="*apps.hoolapp.com*"}(r||(r={}));class a{static getSettingsToOverrideById(e,t){if(e===i.Aura)return a.getAuraOverrideSettings(t)}static getAuraOverrideSettings(e){var t,n,i;const{aft:r}=null!==(n=null===(t=e.sp)||void 0===t?void 0:t.t)&&void 0!==n?n:{},{sctop:a}=null!==(i=e.sp)&&void 0!==i?i:{};return{sp:{enable:!0,h:3,t:{mft:[0,1,2],aft:r},sctop:a}}}getSettingsToOverride(e,t){var n;return null!==(n=a.getSettingsToOverrideById(e,t))&&void 0!==n?n:{}}isAlternativeAndroidStoreUrl(e){return new RegExp("(?<!http:|https:)//|"+r.AuraAppLink).test(e)}isGoogleStoreUrl(e){return-1!==e.indexOf("play.google.com/store/apps/details")||0===e.lastIndexOf("market://",0)}}n.StoreConfig=a,t.exports=a},{}],209:[function(e,t,n){t.exports=function(t){var n=e("./SegmentsRepository");function i(e,n){t.addSegment(e,n)}return{addCellularNetworkTypeSegment:function(e){var t,r=n.cellularNetworkType;-1===e?t=r.cellularNetworkTypeUnknown:"notReachable"===e?t=r.cellularNetworkTypeNotReachable:"wifi"===e?t=r.cellularNetworkTypeWifi:-1!==["CTRadioAccessTechnologyGPRS","CTRadioAccessTechnologyEdge","CTRadioAccessTechnologyCDMA1x"].indexOf(e)?t=r.cellularNetworkType2G:-1!==["CTRadioAccessTechnologyWCDMA","CTRadioAccessTechnologyHSDPA","CTRadioAccessTechnologyHSUPA","CTRadioAccessTechnologyCDMAEVDORev0","CTRadioAccessTechnologyCDMAEVDORevA","CTRadioAccessTechnologyCDMAEVDORevB","CTRadioAccessTechnologyeHRPD"].indexOf(e)?t=r.cellularNetworkType3G:"CTRadioAccessTechnologyLTE"===e&&(t=r.cellularNetworkType4G),i(t,r)},addIsSDCardAvailableSegment:function(e){var t,r=n.isSDCardAvailable;-1===e?t=r.isSDCardAvailableUnknown:"true"===e?t=r.isSDCardAvailableTrue:"false"===e&&(t=r.isSDCardAvailableFalse),i(t,r)},addTotalDeviceRAMSegment:function(e){var t=n.totalDeviceRAM,r=-1===e?e:parseInt(e)/1073741824;i(-1===e?t.totalDeviceRAMUnknown:r<1?t.totalDeviceRAMUnder1GB:r<2?t.totalDeviceRAMUnder2GB:r<3?t.totalDeviceRAMUnder3GB:r<4?t.totalDeviceRAMUnder4GB:r<6?t.totalDeviceRAMUnder6GB:r<8?t.totalDeviceRAMUnder8GB:r<12?t.totalDeviceRAMUnder12GB:t.totalDeviceRAM12GBAndAbove,t)},addIsChargingSegment:function(e){var t,r=n.isCharging;-1===e?t=r.isChargingUnknown:"true"===e?t=r.isChargingTrue:"false"===e&&(t=r.isChargingFalse),i(t,r)},addAirplaneModeSegment:function(e){var t,r=n.airplaneMode;-1===e?t=r.airplaneModeUnknown:"true"===e?t=r.airplaneModeTrue:"false"===e&&(t=r.airplaneModeFalse),i(t,r)},addChargingTypeSegment:function(e){var t=n.chargingType;i(-1===e?t.chargingTypeUnknown:"1"===e?t.chargingTypeAC:"2"===e?t.chargingTypeUSB:"4"===e?t.chargingTypeWireless:t.chargingTypeNone,t)},addStayOnWhenPluggedInSegment:function(e){var t,r=n.stayOnWhenPluggedIn;-1===e?t=r.stayOnWhenPluggedInUnknown:"true"===e?t=r.stayOnWhenPluggedInTrue:"false"===e&&(t=r.stayOnWhenPluggedInFalse),i(t,r)},addBatteryLevelSegment:function(e){var t,r=n.batteryLevel;void 0===e||e<0||(e<=20?t=r.batteryLowestFifth:e<=40?t=r.batterySecondFifth:e<=60?t=r.batteryThirdFifth:e<=80?t=r.batteryFourthFifth:e<=100&&(t=r.batteryHighestFifth)),i(t,r)},addAdLevelCacheSegment:function(e){i(e,n.adLevelCache)},addControllerSourceSegment:function(e){var t=n.controllerSourceStrategy;switch(e){case 0:i(t.fetchFromServerNoFallback,t);break;case 1:i(t.fetchFromServerWithLocalFallback,t);break;case 2:i(t.fetchForNextSessionLoadFromLocal,t)}}}}},{"./SegmentsRepository":212}],210:[function(e,t,n){t.exports={events:{receivedFromAdunit:{addSegment:"SDKController.addSegment",getSegments:"SDKController.getSegments",clearSegmentFromGroup:"SDKController.clearSegmentFromGroup"},sendToAdunit:{updateUserSegments:"updateUserSegments"}}}},{}],211:[function(e,t,n){t.exports=function(t,n){var i="SegmentationManager | ",r=e("./SegmentationConstants"),a=e("./SegmentsRepository"),o=[];function s(e,t){var n=function(e,t){if(!function(e){return!isNaN(e)}(e)||function(e){return-1!==o.indexOf(e)}(e)||!function(e,t){return d(t)&&function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){if(e===t[n[i]])return!0}return!1}(e,t)}(e,t))return!1;for(var n=Object.keys(t),i=0;i<n.length;i++)for(var r=t[n[i]],a=0;a<o.length;a++)if(o[a]===r)return o[a]=e,!0;return o.push(e),!0}(e,t);n&&c()}function d(e){return e&&"object"==typeof e}function l(e){if(d(e))for(var t=Object.keys(e),n=0;n<o.length;n++)for(var i=0;i<t.length;i++){var r=e[t[i]];if(o[n]===r)return o.splice(n,1),void c()}}function c(){t.PubSub.publish("updateEventsBaseData",[{segments:o.toString()}]),n.postAdUnitEvent({name:r.events.sendToAdunit.updateUserSegments,segments:o},!0)}return{init:function(){t.PubSub.subscribe(r.events.receivedFromAdunit.addSegment,(function(e){s(e.segment,e.segmentGroup)})),t.PubSub.subscribe(r.events.receivedFromAdunit.getSegments,(function(e){if(n.log(i+" controller - getSegments received"),e.getSegmentsCallback){var t=e.getSegmentsCallback;n.log(i+"send back to adunit "+t+" with data: "+JSON.stringify(o)),n.postAdUnitEvent({name:t,segments:o},!0)}e.callback&&(n.log(i+"send callback to ad-player with data: "+JSON.stringify(o)),e.callback.call(null,o))})),t.PubSub.subscribe(r.events.receivedFromAdunit.clearSegmentFromGroup,(function(e){l(e.segmentGroup)}))},addSegment:s,getUserSegmentsObjectsAsArray:function(){return o},clearSegmentFromGroup:l,segmentsRepository:a}}},{"./SegmentationConstants":210,"./SegmentsRepository":212}],212:[function(e,t,n){t.exports={batteryLevel:{batteryLowestFifth:101,batterySecondFifth:102,batteryThirdFifth:103,batteryFourthFifth:104,batteryHighestFifth:105},cellularNetworkType:{cellularNetworkTypeWifi:117,cellularNetworkType2G:118,cellularNetworkType3G:119,cellularNetworkType4G:120,cellularNetworkTypeNotReachable:121,cellularNetworkTypeUnknown:122},isCharging:{isChargingTrue:123,isChargingFalse:124,isChargingUnknown:125},airplaneMode:{airplaneModeTrue:126,airplaneModeFalse:127,airplaneModeUnknown:128},stayOnWhenPluggedIn:{stayOnWhenPluggedInTrue:129,stayOnWhenPluggedInFalse:130,stayOnWhenPluggedInUnknown:131},chargingType:{chargingTypeAC:132,chargingTypeUSB:133,chargingTypeWireless:134,chargingTypeNone:135,chargingTypeUnknown:136},totalDeviceRAM:{totalDeviceRAMUnder1GB:137,totalDeviceRAMUnder2GB:138,totalDeviceRAMUnder3GB:139,totalDeviceRAMUnder4GB:140,totalDeviceRAMUnder6GB:141,totalDeviceRAMUnder8GB:142,totalDeviceRAMUnder12GB:143,totalDeviceRAM12GBAndAbove:144,totalDeviceRAMUnknown:145},isSDCardAvailable:{isSDCardAvailableTrue:146,isSDCardAvailableFalse:147,isSDCardAvailableUnknown:148},adLevelCache:{adLevelCacheTimeoutControl:154,adLevelCacheTimeoutFiveMinutes:155,adLevelCacheTimeoutThirtySeconds:156},controllerSourceStrategy:{fetchFromServerNoFallback:151,fetchFromServerWithLocalFallback:152,fetchForNextSessionLoadFromLocal:153}}},{}],213:[function(e,t,n){t.exports=function(e){function t(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function n(e,t){return e?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=t,e):e}function i(t){return!!t&&(e.extractVastSource(t).length>0||t.ext&&t.ext.videoData&&!0===t.ext.videoData.isVast)}return{getVastViewCount:t,setVastViewCount:n,setMaxVastCount:function(e){e&&i(e)&&"number"==typeof e.ext.vastExhaustIndex&&e.ext.vastExhaustIndex>0&&n(e,e.ext.vastExhaustIndex)},isVastCampaign:i,isThereVastCampaign:function(e){if(!e||!Array.isArray(e))return!1;for(var t=!1,n=0;n<e.length;n++)if(i(e[n])){t=!0;break}return t},areAllCampaignTypesAreVast:function(e){if(!e||!Array.isArray(e)||0===e.length)return!1;for(var t=!0,n=0;n<e.length;n++)if(!i(e[n])){t=!1;break}return t},incrementVastViewCount:function(e){return e&&i(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&(i(e)&&e.ext.vastExhaustIndex&&t(e)<e.ext.vastExhaustIndex)},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],214:[function(e,t,n){(function(t){"use strict";var n=e("./SonicCore.js"),i=e("./SDKController/SDKController.js"),r="undefined";var a=t.SonicCore=t.SSA_CORE=new n(t.jQuery,t,document,r);a.SDKController=new i(a,r),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":199,"./SonicCore.js":207}],215:[function(e,t,n){function i(e,t,n){function i(t,n){var i=e.hashMessage(t,n);Android.messageHandler(t,JSON.stringify(n),i)}function r(e,t){Android[e](JSON.stringify(t))}function a(e,t){return void 0!==e&&e[t]}var o={postMessage:function(n,o){if(a(window.Android,e?"messageHandler":n))try{e?i(n,o):r(n,o)}catch(e){t.log("Error running function "+n+" error:"+JSON.stringify(e),t.LogLevels.error)}else t.log("Error calling SDK function "+n,t.LogLevels.error)}},s={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof o[e.eventName]?o[e.eventName](e.parameters):o.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return s}t.exports=i},{}],216:[function(e,t,n){function i(e){var t=function(e,t,n){var r=e+"://"+t+"?",a=Object.keys(n).map((function(e){return n[e]="object"==typeof n[e]?JSON.stringify(n[e]):n[e],encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&").replace(/%20/g,"+");i(r+a)},n=function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},i=function(e){0===a.length?(a.push("1"),n(e)):a.push(e)},r={postMessage:function(e,n,i){t(e,n,i)}},a=[],o={postMessage:function(t){typeof t.eventName!==e&&typeof t.prefix!==e&&typeof t.parameters!==e&&("function"==typeof r[t.eventName]?r[t.eventName](t.parameters):r.postMessage(t.prefix,t.eventName,t.parameters))},acknowledgeMessage:function(){if(0!==a.length){var e=a.shift();"1"===e&&0!==a.length&&(e=a.shift()),void 0!==e&&"1"!==e&&n(e)}}};return o}t.exports=i},{}],217:[function(e,t,n){function i(e){var t=function(e,t,n){var r=e+"://"+t+"?",a=Object.keys(n).map((function(e){return n[e]="object"==typeof n[e]?JSON.stringify(n[e]):n[e],encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&").replace(/%20/g,"+");i(r+a)},n=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},i=function(e){0===a.length?(a.push("1"),n(e)):a.push(e)},r={postMessage:function(e,n,i){t(e,n,i)}},a=[],o={postMessage:function(t){typeof t.eventName!==e&&typeof t.prefix!==e&&typeof t.parameters!==e&&("function"==typeof r[t.eventName]?r[t.eventName](t.parameters):r.postMessage(t.prefix,t.eventName,t.parameters))},acknowledgeMessage:function(){if(0!==a.length){var e=a.shift();"1"===e&&0!==a.length&&(e=a.shift()),void 0!==e&&"1"!==e&&n(e)}}};return o}t.exports=i},{}],218:[function(e,t,n){t.exports=function(e,t,n,i){var r=!1,a=!1,o=!1,s=!0,d=i.CB+".enterBackground",l=i.CB+".enterForeground",c=i.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){r||(e.PubSub.subscribe(i.taskManager+".Engaged",(function(i){e.Utils.isDefined(i.duringEngage)&&i.productType===n&&(a=i.duringEngage,t.log(u+"duringEngage "+a))})),e.PubSub.subscribe(d,(function(){t.log(u+d),o=!0})),e.PubSub.subscribe(l,(function(){t.log(u+l),o=!1})),e.PubSub.subscribe(c,(function(t){e.Utils.isDefined(t.connectionType)&&(s="none"!==t.connectionType&&"notReachable"!==t.connectionType)})),r=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var t=new jQuery.Deferred;return o?e.PubSub.subscribeOnce(l,(function(){t.resolve()})):t.resolve(),t.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(t,n){e.PubSub.publish(i.taskManager+"."+t,n)}}}},{}],219:[function(e,t,n){t.exports=function(e){return e&&"unknown"!==e?{appOrientation:e}:{appOrientation:"none",patch:!0}}},{}],220:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{init(e){this.isAndroid=e}isFileNameMatches(e,t){if(e===t)return!0;const n=this.isAndroid?this._decodeFileNameForAndroid(e):this._decodeFileNameForIOS(e);return n===t||n===decodeURIComponent(t)}getCachedFileName(e,t){return t?this._encodeFileNameForAndroid(e):this._encodeFileNameForIOS(e)}_decodeFileNameForAndroid(e){return decodeURIComponent(decodeURIComponent(e))}_decodeFileNameForIOS(e){return decodeURIComponent(e).replace(/ /,"+")}_encodeFileNameForAndroid(e){return this._javaURLEncode(this._javaURLEncode(e))}_encodeFileNameForIOS(e){const t={"'":"%27","(":"%28",")":"%29","~":"%7E","?":"%3F"};return encodeURI(e).replace(/([?'()~])/g,(function(e){return t[e]}))}_javaURLEncode(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%3F":"?"};return encodeURIComponent(e).replace(/([!'()~]|%3F)/g,(function(e){return t[e]}))}}},{}],221:[function(e,t,n){t.exports=function(e,t,n){var i="ios"===t.getConfig().mobileSDKSettings.deviceOs&&n;return i&&(t.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(n)),e.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",(function(e){(function(e){return t.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(n)+" , with params:"+JSON.stringify(e)),e&&n&&n.demandGroupName===e.demandGroupName&&n.productType===e.productType&&n.demandSourceName!==e.demandSourceName})(e)&&(t.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),t.callSDKFunction("loadInterstitialFail",{demandSourceName:n.demandSourceName}))}))),{onShowSuccess:function(t){i&&e.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:t.productType,demandGroupName:t.demandGroupName,demandSourceName:t.demandSourceName}])}}}},{}],222:[function(e,t,n){t.exports=function(t,n){var i=e("../constants/SDKFeatureNames"),r=new(e("../components/VersionUtils"));return{shouldBlock:function(e){return(!n||!n.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&!r.isLower(e,"13.2")}}}},{"../components/VersionUtils":97,"../constants/SDKFeatureNames":133}],223:[function(e,t,n){t.exports=function(e,t){function n(){var n=decodeURIComponent(e.deviceModel);return-1!==t.iphoneXDeviceModels.indexOf(n)}function i(){var i=e.deviceWidthDP,r=e.deviceHeightDP;return n()&&function(e,n){var i=t.iphoneXDeviceResolution;for(var r in i)if(i.hasOwnProperty(r)&&i[r].width&&i[r].height&&(e===i[r].width&&n===i[r].height||e===i[r].height&&n===i[r].width))return!0;return!1}(i,r)}return{hasNotch:n,onEngageEnd:function(){i()&&0},onSetConfig:function(e){return n()&&function(e){return e.settings&&e.settings.standaloneView}(e)},className:"PatchesIphoneX"}}},{}],224:[function(e,t,n){t.exports=function(e){var t=["6f1e481d","8b4f1525","eb9e7b59","e3d3fd81","6e5f428d","afb2a685","cf01b28d","992991cd","11ade170d","d026bf4d","c3ecb00d"];return["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]),{shouldFail:function(e){return!1},shouldSetAppOrientationPortrait:function(n){if(!function(e,t){return!!t.controllerConfig&&e.indexOf(t.controllerConfig.applicationKey)>-1}(t,n))return!1;var i=parseInt(e.getDeviceApiLevel());return/iPhone/.test(n.mobileSDKSettings.deviceModel)&&i>15}}}},{}],225:[function(e,t,n){t.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn1"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>'},style:{forceCloseProperties:{disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}],226:[function(e,t,n){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.AdsInternalInfoAdStatus=n.AdType=void 0,n.AdType=i,function(e){e.CPVI="CPVI",e.CustomEndCard="customEndCard",e.MRAID="MRAID",e.PlayableAd="playableAd",e.ImageInterstitial="imageInterstitial",e.StaticBanner="staticBanner",e.AppTrailerMarketplace="AT_MP",e.IECMarketplace="IEC_MP",e.HtmlMp="HTML_MP",e.VpaidWrapper="vpaidWrapper"}(i||(n.AdType=i={})),n.AdsInternalInfoAdStatus=r,function(e){e[e.LoadRequest=0]="LoadRequest",e[e.LoadSuccess=1]="LoadSuccess",e[e.ShowSuccess=2]="ShowSuccess",e[e.ShowFailed=3]="ShowFailed",e[e.Destroyed=4]="Destroyed"}(r||(n.AdsInternalInfoAdStatus=r={}))},{}],227:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},{}],228:[function(e,t,n){"use strict";var i,r,a;Object.defineProperty(n,"__esModule",{value:!0}),n.Protocol=n.Environment=n.DeviceOs=void 0,n.DeviceOs=i,function(e){e.Android="android",e.IOS="ios"}(i||(n.DeviceOs=i={})),n.Environment=r,function(e){e.Develop="dev",e.Production="prod",e.Stage="stage"}(r||(n.Environment=r={})),n.Protocol=a,function(e){e.Http="http:",e.Https="https:",e.File="file:"}(a||(n.Protocol=a={}))},{}],229:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ad");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=e("./common");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}));var a=e("./interfaces/externalContainer");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))}));var o=e("./cache");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===o[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}}))}))},{"./ad":226,"./cache":227,"./common":228,"./interfaces/externalContainer":230}],230:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},{}],231:[function(e,t,n){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.HTTPMethod=n.HTTPContent=void 0,n.HTTPMethod=i,function(e){e.GET="GET",e.POST="POST"}(i||(n.HTTPMethod=i={})),n.HTTPContent=r,function(e){e.text="text/plain"}(r||(n.HTTPContent=r={}))},{}]},{},[214]);